OBJECT Page 1292 Payment Application
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Application;
               ESM=Liquidaci¢n de pago;
               FRC=Affectation paiement;
               ENC=Payment Application];
    DeleteAllowed=No;
    SourceTable=Table1293;
    DelayedInsert=Yes;
    SourceTableView=SORTING(Sorting Order)
                    ORDER(Ascending);
    PageType=Worksheet;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 CODEUNIT.RUN(CODEUNIT::"Get Bank Stmt. Line Candidates",Rec);
                 SETCURRENTKEY("Sorting Order","Stmt To Rem. Amount Difference");
                 ASCENDING(TRUE);

                 IF FINDFIRST THEN;
               END;

    OnNewRecord=BEGIN
                  TransferFromBankAccReconLine(BankAccReconLine);
                END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateTotals;
                           LineEditable := "Applies-to Entry No." = 0;
                         END;

    ActionList=ACTIONS
    {
      { 43      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 38      ;1   ;ActionGroup;
                      CaptionML=[ENU=Details;
                                 ESM=Detalles;
                                 FRC=DÇtails;
                                 ENC=Details] }
      { 42      ;2   ;Action    ;
                      Name=ShowBankTransactionDetails;
                      CaptionML=[ENU=Bank Transaction Details;
                                 ESM=Detalles de transacci¢n bancaria;
                                 FRC=DÇtails de transactions bancaires;
                                 ENC=Bank Transaction Details];
                      ToolTipML=[ENU=View the bank statement details for the selected line. The details include the values that exist in an imported bank statement file.;
                                 ESM=Permite ver los detalles del estado de cuenta bancario para la l°nea seleccionada. Los detalles incluyen los valores existentes en un archivo de estado de cuenta bancario importado.;
                                 FRC=Affichez les dÇtails du relevÇ bancaire pour la ligne sÇlectionnÇe. Les dÇtails incluent les valeurs qui existent dans un fichier de relevÇ bancaire importÇ pour la ligne sÇlectionnÇe.;
                                 ENC=View the bank statement details for the selected line. The details include the values that exist in an imported bank statement file.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ExternalDocument;
                      OnAction=VAR
                                 DataExchField@1001 : Record 1221;
                               BEGIN
                                 DataExchField.SETRANGE("Data Exch. No.",BankAccReconLine."Data Exch. Entry No.");
                                 DataExchField.SETRANGE("Line No.",BankAccReconLine."Data Exch. Line No.");
                                 PAGE.RUN(PAGE::"Bank Statement Line Details",DataExchField);
                               END;
                                }
      { 7       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=Review;
                                 ESM=Revisar;
                                 FRC=RÇvision;
                                 ENC=Review] }
      { 9       ;2   ;Action    ;
                      Name=Accept;
                      CaptionML=[ENU=Accept Applications;
                                 ESM=Aceptar liquidaciones;
                                 FRC=Accepter les affectations;
                                 ENC=Accept Applications];
                      ToolTipML=[ENU=Accept a payment application after reviewing it or manually applying it to entries. This closes the payment application and sets the Match Confidence to Accepted.;
                                 ESM=Permite aceptar una liquidaci¢n de pago despuÇs de revisarla o liquidarla manualmente en los movimientos. Esta acci¢n cierra la liquidaci¢n de pago y establece el valor de la opci¢n Confianza de la correspondencia en Aceptado.;
                                 FRC=Acceptez une affectation paiement apräs l'avoir passÇe en revue ou affectÇe manuellement Ö des Çcritures. Cela ferme l'affectation paiement et dÇfinit la FiabilitÇ correspondance sur AcceptÇe.;
                                 ENC=Accept a payment application after reviewing it or manually applying it to entries. This closes the payment application and sets the Match Confidence to Accepted.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Approve;
                      OnAction=BEGIN
                                 IF BankAccReconLine.Difference * BankAccReconLine."Applied Amount" > 0 THEN
                                   IF BankAccReconLine."Account Type" = BankAccReconLine."Account Type"::"Bank Account" THEN
                                     ERROR(ExcessiveAmountErr,BankAccReconLine.Difference);

                                 BankAccReconLine.AcceptApplication;
                                 CurrPage.CLOSE;
                               END;
                                }
      { 8       ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Remove Applications;
                                 ESM=Eliminar liquidaciones;
                                 FRC=Supprimer les affectations;
                                 ENC=Remove Applications];
                      ToolTipML=[ENU=Remove a payment application from an entry. This unapplies the payment.;
                                 ESM=Permite quitar una liquidaci¢n de pago de un movimiento. Esto desliquidar† el pago.;
                                 FRC=Supprimez une affectation de paiement depuis une Çcriture. Cela annule l'affectation du paiement.;
                                 ENC=Remove a payment application from an entry. This unapplies the payment.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Reject;
                      OnAction=BEGIN
                                 IF CONFIRM(RemoveApplicationsQst) THEN
                                   RemoveApplications;
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Show;
                                 ESM=Mostrar;
                                 FRC=Afficher;
                                 ENC=Show] }
      { 35      ;2   ;Action    ;
                      Name=AllOpenEntries;
                      CaptionML=[ENU=All Open Entries;
                                 ESM=Todos los movimientos pendientes;
                                 FRC=Toutes les Çcritures ouvertes;
                                 ENC=All Open Entries];
                      ToolTipML=[ENU=Show all open entries that the payment can be applied to.;
                                 ESM=Muestra todos los movimientos pendientes en los que se puede liquidar el pago.;
                                 FRC=Affichez toutes les Çcritures ouvertes auxquelles le paiement peut àtre affectÇ.;
                                 ENC=Show all open entries that the payment can be applied to.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 SETRANGE(Applied);
                                 SETRANGE("Account Type");
                                 SETRANGE("Account No.");
                                 SETRANGE(Type,Type::"Bank Account Ledger Entry",Type::"Check Ledger Entry");

                                 IF FINDFIRST THEN;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=RelatedPartyOpenEntries;
                      CaptionML=[ENU=Related-Party Open Entries;
                                 ESM=Movimientos pendientes de la parte vinculada;
                                 FRC=êcritures ouvertes associÇes;
                                 ENC=Related-Party Open Entries];
                      ToolTipML=[ENU=Show only open entries that are specifically for the related party in the Account No. field. This limits the list to those open entries that are most likely to relate to the payment.;
                                 ESM=Muestra solo los movimientos pendientes que son espec°ficamente para la parte relacionada en el campo N.ß de cuenta. Esto limita la lista a aquellos movimientos pendientes a los que sea m†s probable relacionar con el pago.;
                                 FRC=Affichez uniquement les Çcritures ouvertes destinÇes Ö la partie associÇe dans le champ N¯ compte. Cela limite la liste Ö ces Çcritures ouvertes qui sont probablement associÇes au paiement.;
                                 ENC=Show only open entries that are specifically for the related party in the Account No. field. This limits the list to those open entries that are most likely to relate to the payment.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewDocumentLine;
                      OnAction=BEGIN
                                 SETRANGE(Applied);

                                 BankAccReconLine.GET(
                                   BankAccReconLine."Statement Type",BankAccReconLine."Bank Account No.",
                                   BankAccReconLine."Statement No.",BankAccReconLine."Statement Line No.");

                                 IF BankAccReconLine."Account No." <> '' THEN BEGIN
                                   SETRANGE("Account No.",BankAccReconLine."Account No.");
                                   SETRANGE("Account Type",BankAccReconLine."Account Type");
                                 END;
                                 SETRANGE(Type,Type::"Bank Account Ledger Entry",Type::"Check Ledger Entry");

                                 IF FINDFIRST THEN;
                               END;
                                }
      { 36      ;2   ;Action    ;
                      Name=AppliedEntries;
                      CaptionML=[ENU=Applied Entries;
                                 ESM=Movs. liquidados;
                                 FRC=êcritures affectÇes;
                                 ENC=Applied Entries];
                      ToolTipML=[ENU=View the ledger entries that have been applied to this record.;
                                 ESM=Permite ver los movimientos liquidados en este registro.;
                                 FRC=Affichez les Çcritures qui ont ÇtÇ affectÇes avec cet enregistrement.;
                                 ENC=View the ledger entries that have been applied to this record.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewRegisteredOrder;
                      OnAction=BEGIN
                                 SETRANGE(Applied,TRUE);
                                 SETRANGE("Account Type");
                                 SETRANGE("Account No.");
                                 SETRANGE(Type,Type::"Bank Account Ledger Entry",Type::"Check Ledger Entry");

                                 IF FINDFIRST THEN;
                               END;
                                }
      { 46      ;2   ;Action    ;
                      Name=AllOpenBankTransactions;
                      CaptionML=[ENU=All Open Bank Transactions;
                                 ESM=Todas las transacciones bancarias pendientes;
                                 FRC=Toutes transactions bancaires ouvertes;
                                 ENC=All Open Bank Transactions];
                      ToolTipML=[ENU=View all open bank entries that the payment can be applied to.;
                                 ESM=Permite ver todos los movimientos de bancos pendientes en los que se puede liquidar el pago.;
                                 FRC=Affichez toutes les Çcritures bancaires auxquelles le paiement peut àtre affectÇ.;
                                 ENC=View all open bank entries that the payment can be applied to.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 SETRANGE(Applied);
                                 SETRANGE("Account Type","Account Type"::"Bank Account");
                                 SETRANGE("Account No.");
                                 SETRANGE(Type,Type::"Bank Account Ledger Entry");

                                 IF FINDFIRST THEN;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Name=AllOpenPayments;
                      CaptionML=[ENU=All Open Payments;
                                 ESM=Todos los pagos pendientes;
                                 FRC=Tous paiements ouverts;
                                 ENC=All Open Payments];
                      ToolTipML=[ENU=Show all open checks that the payment can be applied to.;
                                 ESM=Muestra todos los cheques pendientes en los que se puede liquidar el pago.;
                                 FRC=Affichez tous les chäques ouverts auxquels le paiement peut àtre affectÇ.;
                                 ENC=Show all open cheques that the payment can be applied to.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewCheck;
                      OnAction=BEGIN
                                 SETRANGE(Applied);
                                 SETRANGE("Account Type","Account Type"::"Bank Account");
                                 SETRANGE("Account No.");
                                 SETRANGE(Type,Type::"Check Ledger Entry");
                                 IF FINDFIRST THEN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 29  ;0   ;Container ;
                ContainerType=ContentArea }

    { 30  ;1   ;Group     ;
                Name=PaymentInformation;
                CaptionML=[ENU=Payment Information;
                           ESM=Informaci¢n de pago;
                           FRC=Informations paiement;
                           ENC=Payment Information];
                GroupType=Group }

    { 39  ;2   ;Field     ;
                Name=PaymentStatus;
                CaptionML=[ENU=Payment Status;
                           ESM=Estado pago;
                           FRC=êtat räglement;
                           ENC=Payment Status];
                ToolTipML=[ENU=Specifies the application status of the payment, including information about the match confidence of payments that are applied automatically.;
                           ESM=Especifica el estado de la liquidaci¢n del pago, que incluye informaci¢n sobre la confianza de la correspondencia de los pagos que se liquidan autom†ticamente.;
                           FRC=SpÇcifie l'Çtat d'affectation du paiement, notamment des informations sur la fiabilitÇ de la correspondance des paiements affectÇs automatiquement.;
                           ENC=Specifies the application status of the payment, including information about the match confidence of payments that are applied automatically.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status;
                Editable=FALSE;
                Style=Strong;
                StyleExpr=TRUE }

    { 31  ;2   ;Field     ;
                Name=TransactionDate;
                CaptionML=[ENU=Transaction Date;
                           ESM=Fecha movimiento;
                           FRC=Date transaction;
                           ENC=Transaction Date];
                ToolTipML=[ENU=Specifies the date when the payment was recorded in the bank account.;
                           ESM=Especifica la fecha en la que se registr¢ el pago en la cuenta bancaria.;
                           FRC=SpÇcifie la date Ö laquelle le paiement a ÇtÇ enregistrÇ dans le compte bancaire.;
                           ENC=Specifies the date when the payment was recorded in the bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconLine."Transaction Date";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                Name=TransactionAmount;
                CaptionML=[ENU=Transaction Amount;
                           ESM=Importe transacci¢n;
                           FRC=Montant de la transaction;
                           ENC=Transaction Amount];
                ToolTipML=[ENU=Specifies the payment amount that was recorded on the electronic bank account.;
                           ESM=Especifica el importe del pago que se registr¢ en la cuenta bancaria electr¢nica.;
                           FRC=SpÇcifie le montant du paiement enregistrÇ sur le compte bancaire Çlectronique.;
                           ENC=Specifies the payment amount that was recorded on the electronic bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconLine."Statement Amount";
                Editable=FALSE }

    { 33  ;2   ;Field     ;
                Name=BankAccReconLineDescription;
                CaptionML=[ENU=Transaction Text;
                           ESM=Texto transacci¢n;
                           FRC=Texte transaction;
                           ENC=Transaction Text];
                ToolTipML=[ENU=Specifies the text that was entered on the payment when the payment was made to the electronic bank account.;
                           ESM=Especifica el texto que se introdujo en el pago cuando se realiz¢ el pago en la cuenta bancaria electr¢nica.;
                           FRC=SpÇcifie le texte saisi dans le paiement lorsque le paiement a ÇtÇ effectuÇ vers le compte bancaire Çlectronique.;
                           ENC=Specifies the text that was entered on the payment when the payment was made to the electronic bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconLine."Transaction Text";
                Editable=FALSE }

    { 34  ;1   ;Group     ;
                CaptionML=[ENU=Open Entries;
                           ESM=Movimientos pendientes;
                           FRC=êcritures ouvertes;
                           ENC=Open Entries];
                GroupType=Group }

    { 28  ;2   ;Group     ;
                CaptionML=[ENU=Open Entries;
                           ESM=Movimientos pendientes;
                           FRC=êcritures ouvertes;
                           ENC=Open Entries];
                GroupType=Repeater }

    { 19  ;3   ;Field     ;
                Name=AppliedAmount;
                CaptionML=[ENU=Applied Amount;
                           ESM=Importe liquidado;
                           FRC=Montant affectÇ;
                           ENC=Applied Amount];
                ToolTipML=[ENU=Specifies the payment amount, excluding the value in the Applied Pmt. Discount field, that is applied to the open entry.;
                           ESM=Especifica el importe del pago, sin incluir el valor del campo Descuento pago aplicado, que se liquid¢ en el movimiento pendiente.;
                           FRC=SpÇcifie le montant du paiement, hormis la valeur du champ Escompte de paiement affectÇ, qui est affectÇ Ö l'Çcriture ouverte.;
                           ENC=Specifies the payment amount, excluding the value in the Applied Pmt. Discount field, that is applied to the open entry.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Applied Amt. Incl. Discount";
                Style=Strong;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             UpdateAfterChangingApplication;
                           END;
                            }

    { 20  ;3   ;Field     ;
                Name=Applied;
                ToolTipML=[ENU=Specifies that the payment specified on the header of the Payment Application window is applied to the open entry.;
                           ESM=Especifica que el pago especificado en la cabecera de la ventana Liquidaci¢n de pago se liquida en el movimiento pendiente.;
                           FRC=SpÇcifie que le paiement prÇcisÇ sur l'en-tàte de la fenàtre Affectation paiement est affectÇ Ö l'Çcriture ouverte.;
                           ENC=Specifies that the payment specified on the header of the Payment Application window is applied to the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Applied;
                OnValidate=BEGIN
                             UpdateAfterChangingApplication;
                           END;
                            }

    { 17  ;3   ;Field     ;
                Name=RemainingAmountAfterPosting;
                CaptionML=[ENU=Remaining Amount After Posting;
                           ESM=Importe pendiente despuÇs del registro;
                           FRC=Montant ouvert apräs report;
                           ENC=Remaining Amount After Posting];
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the open entry after you have posted the payment in the Payment Reconciliation Journal window.;
                           ESM=Especifica el importe que queda pendiente de pago del movimiento pendiente despuÇs de haber registrado el pago en la ventana Diario de conciliaci¢n de pagos.;
                           FRC=SpÇcifie le montant restant Ö payer pour l'Çcriture ouverte apräs avoir reportÇ le paiement dans la fenàtre Journal rapprochement paiement.;
                           ENC=Specifies the amount that remains to be paid for the open entry after you have posted the payment in the Payment Reconciliation Journal window.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetRemainingAmountAfterPostingValue }

    { 14  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer or vendor ledger entry that the payment will be applied to when you post the payment reconciliation journal line.;
                           ESM=Especifica el n£mero del movimiento de cliente o proveedor en el que se liquidar† el pago cuando se registre la l°nea del diario de conciliaci¢n de pagos.;
                           FRC=SpÇcifie le numÇro de l'Çcriture client ou fournisseur Ö laquelle le paiement est affectÇ lorsque vous reportez la ligne journal rapprochement paiement.;
                           ENC=Specifies the number of the customer or vendor ledger entry that the payment will be applied to when you post the payment reconciliation journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Entry No.";
                Editable=FALSE;
                OnDrillDown=BEGIN
                              AppliesToEntryNoDrillDown;
                            END;
                             }

    { 12  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the due date of the open entry.;
                           ESM=Especifica la fecha de vencimiento del movimiento pendiente.;
                           FRC=SpÇcifie la date d'ÇchÇance de l'Çcriture ouverte.;
                           ENC=Specifies the due date of the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Editable=FALSE }

    { 24  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document that is related to the open entry.;
                           ESM=Especifica el tipo de documento relacionado con el movimiento pendiente.;
                           FRC=SpÇcifie le type de document associÇ Ö l'Çcriture ouverte.;
                           ENC=Specifies the type of document that is related to the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 23  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the document that is related to the open entry.;
                           ESM=Especifica el n£mero de documento relacionado con el movimiento pendiente.;
                           FRC=SpÇcifie le numÇro de document associÇ Ö l'Çcriture ouverte.;
                           ENC=Specifies the number of the document that is related to the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 22  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a document number that refers to the customer's or vendor's numbering system.;
                           ESM=Especifica un n£mero de documento que hace referencia al sistema de numeraci¢n del cliente o el proveedor.;
                           FRC=SpÇcifie un numÇro de document qui fait rÇfÇrence au programme de numÇrotation du client ou du fournisseur.;
                           ENC=Specifies a document number that refers to the customer's or vendor's numbering system.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Editable=FALSE }

    { 21  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the open entry.;
                           ESM=Especifica la descripci¢n del movimiento pendiente.;
                           FRC=SpÇcifie la description de l'Çcriture ouverte.;
                           ENC=Specifies the description of the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Editable=FALSE }

    { 44  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the open entry.;
                           ESM=Especifica el importe que falta pagar del movimiento pendiente.;
                           FRC=SpÇcifie le montant qui reste Ö payer pour l'Çcriture ouverte.;
                           ENC=Specifies the amount that remains to be paid for the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount";
                Visible=FALSE;
                Enabled=FALSE;
                Editable=FALSE }

    { 41  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the open entry, minus any granted payment discount.;
                           ESM=Especifica el importe que falta pagar del movimiento pendiente, menos cualquier descuento por pronto pago concedido.;
                           FRC=SpÇcifie le montant qui reste Ö payer pour l'Çcriture ouverte, moins tout escompte de paiement accordÇ.;
                           ENC=Specifies the amount that remains to be paid for the open entry, minus any granted payment discount.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amt. Incl. Discount";
                Enabled=FALSE;
                Editable=FALSE }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Pmt. Discount Date;
                           ESM=Fecha dto. P.P.;
                           FRC=Date d'escompte de paiement;
                           ENC=Pmt. Discount Date];
                ToolTipML=[ENU=Specifies the date on which the remaining amount on the open entry must be paid to grant a discount.;
                           ESM=Especifica cu†ndo hay que pagar el importe pendiente del movimiento pendiente para conceder un descuento.;
                           FRC=SpÇcifie la date Ö laquelle le montant restant de l'Çcriture ouverte doit àtre payÇ pour obtenir un escompte.;
                           ENC=Specifies the date on which the remaining amount on the open entry must be paid to grant a discount.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Disc. Due Date";
                OnValidate=BEGIN
                             UpdateAfterChangingApplication;
                           END;
                            }

    { 45  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the latest date the amount in the entry must be paid in order for payment discount tolerance to be granted.;
                           ESM=Especifica la fecha l°mite en la que hay que pagar el importe del movimiento para obtener tolerancia de descuento por pronto pago.;
                           FRC=SpÇcifie la derniäre date Ö laquelle le montant de l'Çcriture doit àtre payÇ pour qu'une tolÇrance d'escompte de paiement soit accordÇe.;
                           ENC=Specifies the latest date the amount in the entry must be paid in order for payment discount tolerance to be granted.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Disc. Tolerance Date";
                Visible=FALSE }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Remaining Pmt. Discount Possible;
                           ESM=Dto. P.P realizable pendiente;
                           FRC=Escompte de paiement ouvert possible;
                           ENC=Remaining Pmt. Discount Possible];
                ToolTipML=[ENU=Specifies how much discount you can grant for the payment if you apply it to the open entry.;
                           ESM=Especifica quÇ cantidad de descuento se puede conceder en el pago si lo liquida en el movimiento pendiente.;
                           FRC=SpÇcifie le montant de l'escompte que vous pouvez octroyer pour le paiement si vous l'affectez Ö l'Çcriture ouverte.;
                           ENC=Specifies how much discount you can grant for the payment if you apply it to the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Pmt. Disc. Possible";
                OnValidate=BEGIN
                             UpdateAfterChangingApplication;
                           END;
                            }

    { 40  ;3   ;Field     ;
                Name=AccountName;
                CaptionML=[ENU=Account Name;
                           ESM=Nombre cuenta;
                           FRC=Nom du compte;
                           ENC=Account Name];
                ToolTipML=[ENU=Specifies the name of the account that the payment is applied to in the Payment Reconciliation Journal window.;
                           ESM=Especifica el nombre de la cuenta en la que se liquida el pago en la ventana Diario de conciliaci¢n de pagos.;
                           FRC=SpÇcifie le nom du compte auquel le paiement est affectÇ dans la fenàtre Journal rapprochement paiement.;
                           ENC=Specifies the name of the account that the payment is applied to in the Payment Reconciliation Journal window.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAccountName;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              AccountNameDrillDown;
                            END;
                             }

    { 27  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the type of account that the payment application will be posted to when you post the payment reconciliation journal.;
                           ESM=Especifica el tipo de cuenta en la que se registrar† la liquidaci¢n del pago cuando se registre el diario de conciliaci¢n de pagos.;
                           FRC=SpÇcifie le type de compte sur lequel l'affectation paiement est reportÇe lorsque vous reportez le journal rapprochement paiement.;
                           ENC=Specifies the type of account that the payment application will be posted to when you post the payment reconciliation journal.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Type";
                Editable=LineEditable }

    { 26  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the account number the payment application will be posted to when you post the payment reconciliation journal.;
                           ESM=Especifica el n£mero de cuenta en el que se registrar† la liquidaci¢n del pago cuando se registre el diario de conciliaci¢n de pagos.;
                           FRC=SpÇcifie le numÇro de compte sur lequel l'affectation paiement est reportÇe lorsque vous reportez le journal rapprochement paiement.;
                           ENC=Specifies the account number the payment application will be posted to when you post the payment reconciliation journal.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account No.";
                Editable=LineEditable;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 25  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date of the open entry.;
                           ESM=Especifica la fecha de registro del movimiento pendiente.;
                           FRC=SpÇcifie la date de report de l'Çcriture ouverte.;
                           ENC=Specifies the posting date of the open entry.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE;
                Editable=FALSE }

    { 13  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the quality of the match between the payment and the open entry for payment application purposes.;
                           ESM=Especifica la calidad de la correspondencia entre el pago y el movimiento pendiente para fines de liquidaci¢n de pagos.;
                           FRC=SpÇcifie la qualitÇ de la correspondance entre le paiement et l'Çcriture ouverte Ö des fins d'affectation paiement.;
                           ENC=Specifies the quality of the match between the payment and the open entry for payment application purposes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Match Confidence" }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Entry Currency Code;
                           ESM=C¢d. divisa movimiento;
                           FRC=Code devise Çcriture;
                           ENC=Entry Currency Code];
                ToolTipML=[ENU=Specifies the currency code of the open entry.;
                           ESM=Especifica el c¢digo de divisa del movimiento pendiente.;
                           FRC=SpÇcifie le code devise de l'Çcriture ouverte.;
                           ENC=Specifies the currency code of the open entry.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 5   ;1   ;Group     ;
                GroupType=Group }

    { 6   ;2   ;Field     ;
                Name=TotalAppliedAmount;
                CaptionML=[ENU=Applied Amount;
                           ESM=Importe liquidado;
                           FRC=Montant affectÇ;
                           ENC=Applied Amount];
                ToolTipML=[ENU=Specifies the sum of the values in the Applied Amount field on lines in the Payment Application window.;
                           ESM=Especifica la suma de los valores del campo Importe liquidado en todas las l°neas de la ventana Liquidaci¢n de pago.;
                           FRC=SpÇcifie la somme des valeurs du champ Montant affectÇ sur les lignes de la fenàtre Affectation paiement.;
                           ENC=Specifies the sum of the values in the Applied Amount field on lines in the Payment Application window.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=BankAccReconLine."Applied Amount";
                AutoFormatType=1;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                Name=TotalRemainingAmount;
                CaptionML=[ENU=Difference;
                           ESM=Diferencia;
                           FRC=DiffÇrence;
                           ENC=Difference];
                ToolTipML=[ENU=Specifies how much of the payment amount remains to be applied to open entries in the Payment Application window.;
                           ESM=Especifica la cantidad del importe de pago que queda pendiente de aplicar en los movimientos pendientes de la ventana Liquidaci¢n de pago.;
                           FRC=SpÇcifie quelle partie du montant de paiement il reste Ö affecter aux Çcritures ouvertes dans la fenàtre Affectation paiement.;
                           ENC=Specifies how much of the payment amount remains to be applied to open entries in the Payment Application window.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=BankAccReconLine."Statement Amount" - BankAccReconLine."Applied Amount";
                AutoFormatType=1;
                Editable=FALSE;
                StyleExpr=RemAmtToApplyStyleExpr }

    { 3   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 2   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Bank Account No.=FIELD(Bank Account No.),
                            Statement No.=FIELD(Statement No.),
                            Statement Line No.=FIELD(Statement Line No.),
                            Statement Type=FIELD(Statement Type),
                            Account Type=FIELD(Account Type),
                            Account No.=FIELD(Account No.),
                            Applies-to Entry No.=FIELD(Applies-to Entry No.),
                            Match Confidence=FIELD(Match Confidence),
                            Quality=FIELD(Quality);
                PagePartID=Page1288;
                PartType=Page }

    { 1   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Bank Account No.=FIELD(Bank Account No.),
                            Statement No.=FIELD(Statement No.),
                            Statement Line No.=FIELD(Statement Line No.),
                            Statement Type=FIELD(Statement Type);
                PagePartID=Page1289;
                PartType=Page }

  }
  CODE
  {
    VAR
      BankAccReconLine@1000 : Record 274;
      RemAmtToApplyStyleExpr@1001 : Text;
      RemoveApplicationsQst@1002 : TextConst 'ENU=Are you sure you want to remove all applications?;ESM=®Est† seguro de que desea quitar todas las liquidaciones?;FRC=“tes-vous sñr de vouloir supprimer l''ensemble des affectations?;ENC=Are you sure you want to remove all applications?';
      Status@1003 : Text;
      AppliedManuallyStatusTxt@1004 : TextConst 'ENU=Applied Manually;ESM=Aplicado manualmente;FRC=AffectÇ manuellement;ENC=Applied Manually';
      NoApplicationStatusTxt@1005 : TextConst 'ENU=Not Applied;ESM=No aplicado;FRC=Non affectÇ;ENC=Not Applied';
      AppliedAutomaticallyStatusTxt@1006 : TextConst 'ENU=Applied Automatically - Match Confidence: %1;ESM=Aplicado autom†ticamente. Confianza de la coincidencia: %1;FRC=AffectÇ automatiquement - FiabilitÇ correspondanceˇ: %1;ENC=Applied Automatically - Match Confidence: %1';
      AcceptedStatusTxt@1007 : TextConst 'ENU=Accepted;ESM=Aceptado;FRC=AcceptÇ;ENC=Accepted';
      LineEditable@1008 : Boolean;
      ExcessiveAmountErr@1010 : TextConst '@@@=%1 is the amount that is not applied (there is filed on the page named Remaining Amount To Apply);ENU=The remaining amount to apply is %1.;ESM=El importe pendiente de liquidaci¢n es %1.;FRC=Le montant ouvert Ö lettrer est %1.;ENC=The remaining amount to apply is %1.';

    [External]
    PROCEDURE SetBankAccReconcLine@3(NewBankAccReconLine@1000 : Record 274);
    BEGIN
      BankAccReconLine := NewBankAccReconLine;
      TransferFromBankAccReconLine(NewBankAccReconLine);

      OnSetBankAccReconcLine(BankAccReconLine);
    END;

    LOCAL PROCEDURE UpdateTotals@7();
    BEGIN
      BankAccReconLine.GET(
        BankAccReconLine."Statement Type",BankAccReconLine."Bank Account No.",
        BankAccReconLine."Statement No.",BankAccReconLine."Statement Line No.");

      BankAccReconLine.CALCFIELDS("Match Confidence");
      CASE BankAccReconLine."Match Confidence" OF
        BankAccReconLine."Match Confidence"::None:
          Status := NoApplicationStatusTxt;
        BankAccReconLine."Match Confidence"::Accepted:
          Status := AcceptedStatusTxt;
        BankAccReconLine."Match Confidence"::Manual:
          Status := AppliedManuallyStatusTxt;
        ELSE
          Status := STRSUBSTNO(AppliedAutomaticallyStatusTxt,BankAccReconLine."Match Confidence");
      END;

      UpdateRemAmtToApplyStyle;
    END;

    LOCAL PROCEDURE UpdateRemAmtToApplyStyle@6();
    BEGIN
      IF BankAccReconLine."Statement Amount" = BankAccReconLine."Applied Amount" THEN
        RemAmtToApplyStyleExpr := 'Favorable'
      ELSE
        RemAmtToApplyStyleExpr := 'Unfavorable';
    END;

    LOCAL PROCEDURE UpdateAfterChangingApplication@13();
    VAR
      MatchBankPayments@1000 : Codeunit 1255;
    BEGIN
      BankAccReconLine.SetManualApplication;
      UpdateToSystemMatchConfidence;
      UpdateTotals;
      MatchBankPayments.UpdateType(BankAccReconLine);
    END;

    LOCAL PROCEDURE UpdateToSystemMatchConfidence@1();
    VAR
      BankPmtApplRule@1001 : Record 1252;
    BEGIN
      IF ("Match Confidence" = "Match Confidence"::Accepted) OR ("Match Confidence" = "Match Confidence"::Manual) THEN
        "Match Confidence" := BankPmtApplRule.GetMatchConfidence(Quality);
    END;

    [Integration(TRUE)]
    PROCEDURE OnSetBankAccReconcLine@2(BankAccReconciliationLine@1000 : Record 274);
    BEGIN
    END;

    BEGIN
    END.
  }
}

