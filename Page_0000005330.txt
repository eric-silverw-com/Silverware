OBJECT Page 5330 CRM Connection Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    AccessByPermission=TableData 5330=IM;
    CaptionML=[ENU=Microsoft Dynamics 365 Connection Setup;
               ESM=Configuraci¢n de conexi¢n de Microsoft Dynamics 365;
               FRC=Configuration de la connexion Ö Microsoft Dynamicsˇ365;
               ENC=Microsoft Dynamics 365 Connection Setup];
    ApplicationArea=#Suite;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5330;
    UsageCategory=Administration;
    PromotedActionCategoriesML=[ENU=New,Connection,Mapping,Synchronization,Encryption;
                                ESM=Nuevo,Conexi¢n,Asignaci¢n,Sincronizaci¢n,Cifrado;
                                FRC=Nouveau,connexion,Correspondance,Synchronisation,Chiffrement;
                                ENC=New,Connection,Mapping,Synchronization,Encryption];
    ShowFilter=No;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
             ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
           BEGIN
             ApplicationAreaMgmtFacade.CheckAppAreaOnlyBasic;
             AssistedSetupAvailable :=
               AssistedSetup.GET(PAGE::"CRM Connection Setup Wizard") AND
               AssistedSetup.Visible;
             SoftwareAsAService := PermissionManager.SoftwareAsAService;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1002 : Codeunit 5330;
               BEGIN
                 IF NOT GET THEN BEGIN
                   INIT;
                   InitializeDefaultProxyVersion;
                   INSERT;
                 END ELSE BEGIN
                   ConnectionString := GetConnectionString;
                   UnregisterConnection;
                   IF "Proxy Version" = 0 THEN BEGIN
                     InitializeDefaultProxyVersion;
                     MODIFY;
                   END;
                   IF "Is Enabled" THEN
                     RegisterUserConnection
                   ELSE
                     IF "Disable Reason" <> '' THEN
                       CRMIntegrationManagement.SendConnectionDisabledNotification("Disable Reason");
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       IF HasPassword THEN
                         CRMPassword := '*';
                       RefreshData;
                     END;

    OnQueryClosePage=BEGIN
                       IF NOT "Is Enabled" THEN
                         IF NOT CONFIRM(STRSUBSTNO(EnableServiceQst,CurrPage.CAPTION),TRUE) THEN
                           EXIT(FALSE);
                     END;

    ActionList=ACTIONS
    {
      { 4       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 35      ;1   ;Action    ;
                      Name=Assisted Setup;
                      CaptionML=[ENU=Assisted Setup;
                                 ESM=Configuraci¢n asistida;
                                 FRC=Configuration assistÇe;
                                 ENC=Assisted Setup];
                      ToolTipML=[ENU=Runs Dynamics 365 Connection Setup Wizard.;
                                 ESM=Ejecuta el Asistente para configuraci¢n de conexi¢n de Dynamics 365.;
                                 FRC=ExÇcute l'Assistant Configuration de la connexion Ö Dynamicsˇ365.;
                                 ENC=Runs Dynamics 365 Connection Setup Wizard.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=AssistedSetupAvailable;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF AssistedSetupAvailable THEN BEGIN
                                   AssistedSetup.Run;
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Test Connection;
                      CaptionML=[@@@=Test is a verb.;
                                 ENU=Test Connection;
                                 ESM=Probar conexi¢n;
                                 FRC=Tester la connexion;
                                 ENC=Test Connection];
                      ToolTipML=[ENU=Tests the connection to Dynamics 365 for Sales using the specified settings.;
                                 ESM=Prueba la conexi¢n a Dynamics 365 for Sales mediante la configuraci¢n especificada.;
                                 FRC=Teste la connexion Ö Dynamicsˇ365 for Sales Ö l'aide des paramätres spÇcifiÇs.;
                                 ENC=Tests the connection to Dynamics 365 for Sales using the specified settings.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=ValidateEmailLoggingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PerformTestConnection;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ResetConfiguration;
                      CaptionML=[ENU=Use Default Synchronization Setup;
                                 ESM=Usar configuraci¢n de sincronizaci¢n predeterminada;
                                 FRC=Utiliser la configuration de synchronisation par dÇfaut;
                                 ENC=Use Default Synchronization Setup];
                      ToolTipML=[ENU=Resets the integration table mappings and synchronization jobs to the default values for a connection with Dynamics 365 for Sales. All current mappings are deleted.;
                                 ESM=Restablece las asignaciones de tabla de integraci¢n y los trabajos de sincronizaci¢n a sus valores predeterminados para establecer una conexi¢n con Dynamics 365 for Sales. Se eliminan todas las asignaciones actuales.;
                                 FRC=RÇinitialise les correspondances de table d'intÇgration et les projets de synchronisation et applique les valeurs par dÇfaut pour une connexion Ö Dynamicsˇ365 for Sales. Toutes les correspondances actuelles sont supprimÇes.;
                                 ENC=Resets the integration table mappings and synchronization jobs to the default values for a connection with Dynamics 365 for Sales. All current mappings are deleted.];
                      ApplicationArea=#Suite;
                      Enabled="Is Enabled";
                      Image=ResetStatus;
                      OnAction=VAR
                                 CRMSetupDefaults@1000 : Codeunit 5334;
                               BEGIN
                                 IF CONFIRM(ResetIntegrationTableMappingConfirmQst,FALSE,CRMProductName.SHORT) THEN BEGIN
                                   CRMSetupDefaults.ResetConfiguration(Rec);
                                   MESSAGE(SetupSuccessfulMsg,CRMProductName.SHORT);
                                 END;
                                 RefreshDataFromCRM;
                               END;
                                }
      { 41      ;1   ;Action    ;
                      Name=CoupleUsers;
                      CaptionML=[ENU=Couple Salespersons;
                                 ESM=Emparejar vendedores;
                                 FRC=Coupler les reprÇsentants;
                                 ENC=Couple Salespersons];
                      ToolTipML=[ENU=Open the list of users in Dynamics 365 for Sales for manual coupling to salespersons in Business Central.;
                                 ESM=Abre la lista de usuarios de Dynamics 365 for Sales para un emparejamiento manual de los vendedores en Business Central.;
                                 FRC=Ouvrez la liste des utilisateurs dans Dynamicsˇ365 for Sales pour un couplage manuel avec des reprÇsentants dans Business Central.;
                                 ENC=Open the list of users in Dynamics 365 for Sales for manual coupling to salespersons in Business Central.];
                      ApplicationArea=#Suite;
                      Image=CoupledUsers;
                      OnAction=VAR
                                 CRMSystemuserList@1000 : Page 5340;
                               BEGIN
                                 CRMSystemuserList.Initialize(TRUE);
                                 CRMSystemuserList.RUN;
                               END;
                                }
      { 10      ;1   ;Action    ;
                      Name=StartInitialSynchAction;
                      CaptionML=[ENU=Run Full Synchronization;
                                 ESM=Ejecutar sincronizaci¢n completa;
                                 FRC=ExÇcuter une synchronisation compläte;
                                 ENC=Run Full Synchronization];
                      ToolTipML=[ENU=Start all the default integration jobs for synchronizing Business Central record types and Dynamics 365 for Sales entities, as defined on the Integration Table Mappings page.;
                                 ESM=Permite iniciar todos los proyectos de integraci¢n predeterminados para sincronizar los tipos de registro de Business Central y las entidades de Dynamics 365 for Sales, tal como se define en la p†gina Lista de asignaciones de tablas de integraci¢n.;
                                 FRC=Commencez toutes les tÉches d'intÇgration par dÇfaut pour la synchronisation des types d'enregistrement Business Central et des entitÇs Dynamicsˇ365 for Sales, tel que dÇfini sur la page Correspondances table intÇgration.;
                                 ENC=Start all the default integration jobs for synchronizing Business Central record types and Dynamics 365 for Sales entities, as defined on the Integration Table Mappings page.];
                      ApplicationArea=#Suite;
                      Enabled="Is Enabled For User";
                      Image=RefreshLines;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"CRM Full Synch. Review");
                               END;
                                }
      { 17      ;1   ;Action    ;
                      Name=Reset Web Client URL;
                      CaptionML=[ENU=Reset Web Client URL;
                                 ESM=Restablecer URL de cliente web;
                                 FRC=RÇinitialiser l'URL du client web;
                                 ENC=Reset Web Client URL];
                      ToolTipML=[ENU=Undo your change and enter the default URL in the Business Central web Client URL field.;
                                 ESM=Permite deshacer el cambio y especificar la direcci¢n URL predeterminada en el campo URL de cliente web de Business Central.;
                                 FRC=Annulez votre modification et saisissez l'URL par dÇfaut dans le champ URL du client web Business Central.;
                                 ENC=Undo your change and enter the default URL in the Business Central web Client URL field.];
                      ApplicationArea=#Suite;
                      Enabled=IsWebCliResetEnabled;
                      Image=ResetStatus;
                      OnAction=BEGIN
                                 PerformWebClientUrlReset;
                                 MESSAGE(WebClientUrlResetMsg,PRODUCTNAME.SHORT);
                               END;
                                }
      { 23      ;1   ;Action    ;
                      Name=SynchronizeNow;
                      CaptionML=[ENU=Synchronize Modified Records;
                                 ESM=Sincronizar registros modificados;
                                 FRC=Synchroniser les enregistrements modifiÇs;
                                 ENC=Synchronize Modified Records];
                      ToolTipML=[ENU=Synchronize records that have been modified since the last time they were synchronized.;
                                 ESM=Sincroniza los registros que se modificaron desde la £ltima sincronizaci¢n.;
                                 FRC=Synchroniser les enregistrements qui ont ÇtÇ modifiÇs depuis la derniäre synchronisation.;
                                 ENC=Synchronize records that have been modified since the last time they were synchronized.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="Is Enabled For User";
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 IntegrationSynchJobList@1000 : Page 5338;
                               BEGIN
                                 IF NOT CONFIRM(SynchronizeModifiedQst) THEN
                                   EXIT;

                                 SynchronizeNow(FALSE);
                                 MESSAGE(SyncNowSuccessMsg,IntegrationSynchJobList.CAPTION);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Generate Integration IDs;
                      CaptionML=[ENU=Generate Integration IDs;
                                 ESM=Generar id. de integraci¢n;
                                 FRC=GÇnÇrer ID intÇgration;
                                 ENC=Generate Integration IDs];
                      ToolTipML=[ENU=Create integration IDs for new records that were added while the connection was disabled, for example, after you re-enable a Dynamics 365 for Sales connection.;
                                 ESM=Permite crear los identificadores de integraci¢n para los registros nuevos que se agregaron mientras la conexi¢n estaba deshabilitada, por ejemplo, despuÇs de volver a habilitar una conexi¢n de Dynamicsˇ365 for Sales.;
                                 FRC=CrÇez des codes d'intÇgration de nouveaux enregistrements qui ont ÇtÇ ajoutÇs pendant que la connexion a ÇtÇ dÇsactivÇe, par exemple, apräs avoir activÇ Ö nouveau une connexion Ö Dynamics 365 for Sales.;
                                 ENC=Create integration IDs for new records that were added while the connection was disabled, for example, after you re-enable a Dynamics 365 for Sales connection.];
                      ApplicationArea=#Suite;
                      Image=Reconcile;
                      OnAction=VAR
                                 IntegrationManagement@1000 : Codeunit 5150;
                               BEGIN
                                 IF CONFIRM(ConfirmGenerateIntegrationIdsQst,TRUE) THEN BEGIN
                                   IntegrationManagement.SetupIntegrationTables;
                                   MESSAGE(GenerateIntegrationIdsSuccessMsg);
                                 END;
                               END;
                                }
      { 14      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;Action    ;
                      Name=Integration Table Mappings;
                      CaptionML=[ENU=Integration Table Mappings;
                                 ESM=Lista de asignaciones de tablas de integraci¢n;
                                 FRC=Correspondances table intÇgration;
                                 ENC=Integration Table Mappings];
                      ToolTipML=[ENU=View entries that map integration tables to business data tables in Business Central. Integration tables are set up to act as interfaces for synchronizing data between an external database table, such as Dynamics 365 for Sales, and a corresponding business data table in Business Central.;
                                 ESM=Permite ver los movimientos que asignan tablas de integraci¢n a tablas de datos empresariales en Business Central. Las tablas de integraci¢n est†n configuradas para actuar como interfaces para sincronizar datos entre una tabla de base de datos externa (como Dynamics 365 for Sales) y una tabla de datos empresariales correspondiente de Business Central.;
                                 FRC=Affichez les Çcritures qui associent les tables d'intÇgration aux tables de donnÇes mÇtiers dans Business Central. Les tables d'intÇgration sont configurÇes pour agir comme des interfaces pour la synchronisation des donnÇes entre la table de la base de donnÇes externe, telle que Dynamicsˇ365 for Sales, et une table de donnÇes mÇtiers correspondante dans Business Central.;
                                 ENC=View entries that map integration tables to business data tables in Business Central. Integration tables are set up to act as interfaces for synchronizing data between an external database table, such as Dynamics 365 for Sales, and a corresponding business data table in Business Central.];
                      ApplicationArea=#Suite;
                      RunObject=Page 5335;
                      Promoted=Yes;
                      Image=Relationship;
                      PromotedCategory=Report;
                      RunPageMode=Edit }
      { 12      ;1   ;Action    ;
                      Name=Synch. Job Queue Entries;
                      CaptionML=[ENU=Synch. Job Queue Entries;
                                 ESM=Sinc. entradas cola trabajo;
                                 FRC=êcritures de la file d'attente des projets synch.;
                                 ENC=Synch. Job Queue Entries];
                      ToolTipML=[ENU=View the job queue entries that manage the scheduled synchronization between Dynamics 365 for Sales and Business Central.;
                                 ESM=Permite ver los movimientos de cola de trabajos que administran la sincronizaci¢n programada entre Dynamics 365 for Sales y Business Central.;
                                 FRC=Affichez les Çcritures de la file d'attente des travaux qui gärent la synchronisation programmÇe entre Dynamicsˇ365 for Sales et Business Central.;
                                 ENC=View the job queue entries that manage the scheduled synchronization between Dynamics 365 for Sales and Business Central.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=JobListSetup;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 JobQueueEntry@1000 : Record 472;
                               BEGIN
                                 JobQueueEntry.FILTERGROUP := 2;
                                 JobQueueEntry.SETRANGE("Object Type to Run",JobQueueEntry."Object Type to Run"::Codeunit);
                                 JobQueueEntry.SETFILTER("Object ID to Run",GetJobQueueEntriesObjectIDToRunFilter);
                                 JobQueueEntry.FILTERGROUP := 0;

                                 PAGE.RUN(PAGE::"Job Queue Entries",JobQueueEntry);
                               END;
                                }
      { 29      ;1   ;Action    ;
                      Name=SkippedSynchRecords;
                      CaptionML=[ENU=Skipped Synch. Records;
                                 ESM=Registros sinc. omitidos;
                                 FRC=Enregistrements de synchronisation ignorÇs;
                                 ENC=Skipped Synch. Records];
                      ToolTipML=[ENU=View the list of records that will be skipped for synchronization.;
                                 ESM=Permite ver la lista de registros que se omitir†n para la sincronizaci¢n.;
                                 FRC=Affichez la liste des enregistrements qui seront ignorÇs pour la synchronisation.;
                                 ENC=View the list of records that will be skipped for synchronization.];
                      ApplicationArea=#Suite;
                      RunObject=Page 5333;
                      Promoted=Yes;
                      Enabled="Is Enabled";
                      Image=NegativeLines;
                      PromotedCategory=Category4;
                      RunPageMode=View }
      { 6       ;1   ;Action    ;
                      Name=EncryptionManagement;
                      CaptionML=[ENU=Encryption Management;
                                 ESM=Administraci¢n del cifrado;
                                 FRC=Gestion du chiffrement;
                                 ENC=Encryption Management];
                      ToolTipML=[ENU=Enable or disable data encryption. Data encryption helps make sure that unauthorized users cannot read business data.;
                                 ESM=Permite habilitar o deshabilitar el cifrado de datos. Esto le permitir† asegurarse de que los usuarios no autorizados no puedan leer los datos de la empresa.;
                                 FRC=Activez ou dÇsactivez le chiffrement des donnÇes. Le chiffrement des donnÇes garantit que les utilisateurs non autorisÇs ne peuvent pas avoir accäs aux donnÇes professionnelles.;
                                 ENC=Enable or disable data encryption. Data encryption helps make sure that unauthorized users cannot read business data.];
                      ApplicationArea=#Advanced;
                      RunObject=Page 9905;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5;
                      RunPageMode=View }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=NAVToCRM;
                CaptionML=[ENU=Connection from Dynamics 365 Business Central to Dynamics 365 for Sales;
                           ESM=Conexi¢n de Dynamics 365 Business Central a Dynamics 365 for Sales;
                           FRC=Connexion de Dynamicsˇ365 Business Central Ö Dynamicsˇ365 for Sales;
                           ENC=Connection from Dynamics 365 Business Central to Dynamics 365 for Sales];
                GroupType=Group }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the URL of the Dynamics 365 for Sales server that hosts the Dynamics 365 for Sales solution that you want to connect to.;
                           ESM=Especifica la direcci¢n URL del servidor de Dynamics 365 for Sales que hospeda la soluci¢n de Dynamics 365 for Sales a la que quiere conectarse.;
                           FRC=SpÇcifie l'URL du serveur Dynamics 365 for Sales qui hÇberge la solution Dynamics 365 for Sales Ö laquelle vous souhaitez vous connecter.;
                           ENC=Specifies the URL of the Dynamics 365 for Sales server that hosts the Dynamics 365 for Sales solution that you want to connect to.];
                ApplicationArea=#Suite;
                SourceExpr="Server Address";
                Editable=IsEditable;
                OnValidate=BEGIN
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the user name of a Dynamics 365 for Sales account.;
                           ESM=Especifica el nombre de usuario de una cuenta de Dynamics 365 for Sales.;
                           FRC=SpÇcifie le nom d'utilisateur d'un compte Dynamics 365 for Sales.;
                           ENC=Specifies the user name of a Dynamics 365 for Sales account.];
                ApplicationArea=#Suite;
                SourceExpr="User Name";
                Editable=IsEditable;
                OnValidate=BEGIN
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 7   ;2   ;Field     ;
                Name=Password;
                ExtendedDatatype=Masked;
                ToolTipML=[ENU=Specifies the password of a Dynamics 365 for Sales user account.;
                           ESM=Especifica la contrase§a de una cuenta de usuario de Dynamics 365 for Sales.;
                           FRC=SpÇcifie le mot de passe d'un compte utilisateur Dynamics 365 for Sales.;
                           ENC=Specifies the password of a Dynamics 365 for Sales user account.];
                ApplicationArea=#Suite;
                SourceExpr=CRMPassword;
                Enabled=IsEditable;
                OnValidate=BEGIN
                             IF (CRMPassword <> '') AND (NOT ENCRYPTIONENABLED) THEN
                               IF CONFIRM(EncryptionIsNotActivatedQst) THEN
                                 PAGE.RUNMODAL(PAGE::"Data Encryption Management");
                             SetPassword(CRMPassword);
                           END;
                            }

    { 11  ;2   ;Field     ;
                CaptionML=[@@@=Name of tickbox which shows whether the connection is enabled or disabled;
                           ENU=Enabled;
                           ESM=Activado;
                           FRC=ActivÇ;
                           ENC=Enabled];
                ToolTipML=[ENU=Specifies if the connection to Dynamics 365 for Sales is enabled.;
                           ESM=Especifica si la conexi¢n a Dynamics 365 for Sales est† habilitada.;
                           FRC=SpÇcifie si la connexion Ö Dynamics 365 for Sales est activÇe.;
                           ENC=Specifies if the connection to Dynamics 365 for Sales is enabled.];
                ApplicationArea=#Suite;
                SourceExpr="Is Enabled";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 22  ;2   ;Field     ;
                Name=ScheduledSynchJobsActive;
                CaptionML=[ENU=Active scheduled synchronization jobs;
                           ESM=Trabajos de sincronizaci¢n programados activos;
                           FRC=Projets de synchronisation planifiÇs actifs;
                           ENC=Active scheduled synchronization jobs];
                ToolTipML=[ENU=Specifies how many of the default integration synchronization job queue entries ready to automatically synchronize data between Dynamics 365 and Dynamics 365 for Sales.;
                           ESM=Especifica cu†ntos movimientos de la cola de trabajos de sincronizaci¢n de integraci¢n predeterminada est†n listos para sincronizar datos autom†ticamente entre Dynamicsˇ365 y Dynamicsˇ365ˇforˇSales.;
                           FRC=SpÇcifie le nombre d'Çcritures de file d'attente des travaux de synchronisation d'intÇgration par dÇfaut pràtes Ö synchroniser automatiquement les donnÇes entre Dynamicsˇ365 et Dynamicsˇ365 for Sales.;
                           ENC=Specifies how many of the default integration synchronization job queue entries ready to automatically synchronize data between Dynamics 365 and Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr=ScheduledSynchJobsRunning;
                Editable=false;
                StyleExpr=ScheduledSynchJobsRunningStyleExpr;
                OnDrillDown=VAR
                              ScheduledSynchJobsRunningMsg@1000 : Text;
                            BEGIN
                              IF TotalJobs = 0 THEN
                                ScheduledSynchJobsRunningMsg := JobQueueIsNotRunningMsg
                              ELSE
                                IF ActiveJobs = TotalJobs THEN
                                  ScheduledSynchJobsRunningMsg := AllScheduledJobsAreRunningMsg
                                ELSE
                                  ScheduledSynchJobsRunningMsg := STRSUBSTNO(PartialScheduledJobsAreRunningMsg,ActiveJobs,TotalJobs);
                              MESSAGE(ScheduledSynchJobsRunningMsg);
                            END;
                             }

    { 33  ;2   ;Field     ;
                Name=SDKVersion;
                AssistEdit=Yes;
                CaptionML=[ENU=Dynamics 365 SDK Version;
                           ESM=Versi¢n de Dynamics 365 SDK;
                           FRC=Version du SDK Dynamics 365;
                           ENC=Dynamics 365 SDK Version];
                ToolTipML=[ENU=Specifies the Microsoft Dynamics 365 (CRM) software development kit version that is used to connect to Dynamics 365 for Sales.;
                           ESM=Especifica la versi¢n del kit de desarrollo del software Microsoft Dynamics 365 (CRM) que se utiliza para conectarse a Dynamics 365 for Sales.;
                           FRC=SpÇcifie la version du kit de dÇveloppement logiciel Microsoft Dynamics 365 (CRM) qui est utilisÇe pour se connecter Ö Dynamics 365 for Sales.;
                           ENC=Specifies the Microsoft Dynamics 365 (CRM) software development kit version that is used to connect to Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Proxy Version";
                Enabled=IsEditable;
                Editable=FALSE;
                OnAssistEdit=VAR
                               TempStack@1000 : TEMPORARY Record 9160;
                             BEGIN
                               IF PAGE.RUNMODAL(PAGE::"SDK Version List",TempStack) = ACTION::LookupOK THEN BEGIN
                                 VALIDATE("Proxy Version",TempStack.StackOrder);
                                 ConnectionString := GetConnectionString;
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 8   ;1   ;Group     ;
                Name=CRMToNAV;
                CaptionML=[ENU=Connection from Dynamics 365 for Sales to Dynamics 365 Business Central;
                           ESM=Conexi¢n de Dynamics 365 for Sales a Dynamics 365 Business Central;
                           FRC=Connexion de Dynamicsˇ365 for Sales Ö Dynamicsˇ365 Business Central;
                           ENC=Connection from Dynamics 365 for Sales to Dynamics 365 Business Central];
                Visible="Is Enabled";
                GroupType=Group }

    { 16  ;2   ;Field     ;
                Name=NAVURL;
                CaptionML=[ENU=Dynamics 365 Business Central Web Client URL;
                           ESM=URL de cliente web de Dynamics 365 Business Central;
                           FRC=URL du client Web Dynamicsˇ365 Business Central;
                           ENC=Dynamics 365 Business Central Web Client URL];
                ToolTipML=[ENU=Specifies the URL to the Business Central web client. From records in Dynamics 365 for Sales, such as an account or product, users can open a corresponding (coupled) record in Business Central. Set this field to the URL of the Business Central web client instance to use.;
                           ESM=Especifica la direcci¢n URL del cliente web de Business Central. Con los registros de Dynamics 365 for Sales (como los de una cuenta o un producto), los usuarios pueden abrir el registro correspondiente (emparejado) en Business Central. Es necesario establecer este campo en la direcci¢n URL de la instancia del cliente web de Business Central que se va a usar.;
                           FRC=SpÇcifie l'URL du client Web Business Central. ∑ partir des enregistrements dans Dynamicsˇ365 for Sales, par exemple un compte ou un produit, les utilisateurs peuvent ouvrir un enregistrement correspondant (couplÇ) dans Business Central, qui s'ouvre dans le client Web Business Central. DÇfinissez ce champ sur l'URL de l'instance du client Web Business Central Ö utiliser.;
                           ENC=Specifies the URL to the Business Central web client. From records in Dynamics 365 for Sales, such as an account or product, users can open a corresponding (coupled) record in Business Central. Set this field to the URL of the Business Central web client instance to use.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV URL";
                Enabled="Is CRM Solution Installed" }

    { 28  ;2   ;Field     ;
                Name=ItemAvailabilityWebServEnabled;
                CaptionML=[ENU=Item Availability Web Service Enabled;
                           ESM=Servicio web de disponibilidad de art°culo activado;
                           FRC=Service Web DisponibilitÇ article activÇ;
                           ENC=Item Availability Web Service Enabled];
                ToolTipML=[ENU=Specifies that the Item Availability web service for Business Central is enabled.;
                           ESM=Especifica que el servicio web de disponibilidad de art°culo para Business Central est† habilitado.;
                           FRC=Indique que le service Web DisponibilitÇ article est activÇ pour Business Central.;
                           ENC=Specifies that the Item Availability web service for Business Central is enabled.];
                ApplicationArea=#Suite;
                SourceExpr=WebServiceEnabled;
                Editable=FALSE;
                StyleExpr=WebServiceEnabledStyleExpr;
                OnDrillDown=VAR
                              CRMIntegrationManagement@1000 : Codeunit 5330;
                            BEGIN
                              IF WebServiceEnabled THEN
                                CRMIntegrationManagement.UnPublishOnWebService(Rec)
                              ELSE
                                CRMIntegrationManagement.PublishWebService(Rec);
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 34  ;2   ;Field     ;
                ApplicationArea=#Suite }

    { 24  ;2   ;Field     ;
                Name=NAVODataURL;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service URL;
                           ESM=URL de servicios web OData de Dynamics 365 Business Central;
                           FRC=URL du service Web OData Dynamicsˇ365 Business Central;
                           ENC=Dynamics 365 Business Central OData Web Service URL];
                ToolTipML=[ENU=Specifies the URL of Business Central OData web services. From sales order records in Dynamics 365 for Sales, users can retrieve item availability information for items in Business Central that are coupled to sales order detail records in Dynamics 365 for Sales. Set this field to the URL of the Business Central OData web services to use.;
                           ESM=Especifica la direcci¢n URL de los servicios web OData de Business Central. Con los registros de pedidos de venta de Dynamics 365 for Sales, los usuarios pueden recuperar la informaci¢n de disponibilidad de productos de Business Central emparejados con el registro de detalles de pedidos de venta de Dynamicsˇ365ˇforˇSales. Defina este campo en la direcci¢n URL de los servicios web OData de Business Central que se van a usar.;
                           FRC=SpÇcifie l'URL des services Web OData Business Central. ∑ partir des enregistrements de document de vente dans Dynamicsˇ365 for Sales, les utilisateurs peuvent extraire les informations de disponibilitÇ pour les articles Business Central couplÇs Ö des enregistrements de dÇtails de document de vente de Dynamicsˇ365 for Sales. DÇfinissez ce champ sur l'URL des services Web OData Business Central Ö utiliser.;
                           ENC=Specifies the URL of Business Central OData web services. From sales order records in Dynamics 365 for Sales, users can retrieve item availability information for items in Business Central that are coupled to sales order detail records in Dynamics 365 for Sales. Set this field to the URL of the Business Central OData web services to use.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData URL";
                Enabled="Is CRM Solution Installed" }

    { 31  ;2   ;Field     ;
                Name=NAVODataUsername;
                Lookup=Yes;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service Username;
                           ESM=Nombre de usuario de servicios web OData de Dynamics 365 Business Central;
                           FRC=Nom d'utilisateur du service Web OData Dynamicsˇ365 Business Central;
                           ENC=Dynamics 365 Business Central OData Web Service Username];
                ToolTipML=[ENU=Specifies the user name to access Dynamics 365 OData web services.;
                           ESM=Especifica el nombre de usuario para obtener acceso a los servicios web OData de Dynamicsˇ365.;
                           FRC=SpÇcifie le nom d'utilisateur pour accÇder aux services Web OData Dynamicsˇ365.;
                           ENC=Specifies the user name to access Dynamics 365 OData web services.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData Username";
                Enabled="Is CRM Solution Installed";
                LookupPageID=Users }

    { 32  ;2   ;Field     ;
                Name=NAVODataAccesskey;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service Accesskey;
                           ESM=Clave de acceso de servicios web OData de Dynamics 365 Business Central;
                           FRC=ClÇ d'accäs du service Web OData Dynamicsˇ365 Business Central;
                           ENC=Dynamics 365 Business Central OData Web Service Accesskey];
                ToolTipML=[ENU=Specifies the access key to access Dynamics 365 OData web services.;
                           ESM=Especifica la clave de acceso para obtener acceso a los servicios web OData de Dynamicsˇ365.;
                           FRC=SpÇcifie la clÇ d'accäs pour accÇder aux services Web OData Dynamicsˇ365.;
                           ENC=Specifies the access key to access Dynamics 365 OData web services.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData Accesskey";
                Enabled="Is CRM Solution Installed";
                Editable=FALSE }

    { 20  ;1   ;Group     ;
                Name=CRMSettings;
                CaptionML=[ENU=Dynamics 365 for Sales Settings;
                           ESM=Configuraci¢n de Dynamics 365 for Sales;
                           FRC=Paramätres de Dynamicsˇ365 for Sales;
                           ENC=Dynamics 365 for Sales Settings];
                Visible="Is Enabled";
                GroupType=Group }

    { 25  ;2   ;Field     ;
                CaptionML=[ENU=Version;
                           ESM=Versi¢n;
                           FRC=Version;
                           ENC=Version];
                ToolTipML=[ENU=Specifies the version of Dynamics 365 for Sales.;
                           ESM=Especifica la versi¢n de Dynamics 365 for Sales.;
                           FRC=SpÇcifie la version de Dynamics 365 for Sales.;
                           ENC=Specifies the version of Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="CRM Version";
                Editable=FALSE;
                StyleExpr=CRMVersionStyleExpr;
                OnDrillDown=BEGIN
                              IF IsVersionValid THEN
                                MESSAGE(FavorableCRMVersionMsg,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(UnfavorableCRMVersionMsg,PRODUCTNAME.SHORT,CRMProductName.SHORT);
                            END;
                             }

    { 15  ;2   ;Field     ;
                CaptionML=[ENU=Dynamics 365 Business Central Integration Solution Imported;
                           ESM=Soluci¢n de integraci¢n de Dynamics 365 Business Central importada;
                           FRC=Solution d'intÇgration Dynamicsˇ365 Business Central importÇe;
                           ENC=Dynamics 365 Business Central Integration Solution Imported];
                ToolTipML=[ENU=Specifies if the Integration Solution is installed and configured in Dynamics 365 for Sales. You cannot change this setting.;
                           ESM=Especifica si la soluci¢n de integraci¢n est† instalada y configurada en Dynamics 365 for Sales. No se puede cambiar esta opci¢n.;
                           FRC=SpÇcifie si la solution d'intÇgration est installÇe et configurÇe dans Dynamicsˇ365 for Sales. Vous ne pouvez pas modifier ce paramätre.;
                           ENC=Specifies if the Integration Solution is installed and configured in Dynamics 365 for Sales. You cannot change this setting.];
                ApplicationArea=#Suite;
                SourceExpr="Is CRM Solution Installed";
                Editable=FALSE;
                StyleExpr=CRMSolutionInstalledStyleExpr;
                OnDrillDown=BEGIN
                              IF "Is CRM Solution Installed" THEN
                                MESSAGE(FavorableCRMSolutionInstalledMsg,PRODUCTNAME.SHORT,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(UnfavorableCRMSolutionInstalledMsg,PRODUCTNAME.SHORT);
                            END;
                             }

    { 21  ;2   ;Field     ;
                CaptionML=[ENU=Sales Order Integration Enabled;
                           ESM=Integraci¢n del pedido de venta habilitado;
                           FRC=IntÇgration du document de vente activÇ;
                           ENC=Sales Order Integration Enabled];
                ToolTipML=[ENU=Specifies that it is possible for Dynamics 365 for Sales users to submit sales orders that can then be viewed and imported in Dynamics 365.;
                           ESM=Especifica que los usuarios de Dynamics 365 for Sales pueden enviar pedidos de venta que posteriormente se pueden ver e importar en Dynamicsˇ365.;
                           FRC=SpÇcifie que les utilisateurs de Dynamicsˇ365 for Sales peuvent soumettre des documents de vente qui peuvent ensuite àtre affichÇs et importÇs dans Dynamicsˇ365.;
                           ENC=Specifies that it is possible for Dynamics 365 for Sales users to submit sales orders that can then be viewed and imported in Dynamics 365.];
                ApplicationArea=#Suite;
                SourceExpr="Is S.Order Integration Enabled";
                OnValidate=BEGIN
                             SetAutoCreateSalesOrdersEditable;
                           END;
                            }

    { 40  ;2   ;Field     ;
                CaptionML=[ENU=Automatically Create Sales Orders;
                           ESM=Crear autom†ticamente pedidos de ventas;
                           FRC=CrÇer automatiquement des documents de vente;
                           ENC=Automatically Create Sales Orders];
                ToolTipML=[ENU=Specifies that sales orders will be created automatically from sales orders that are submitted in Dynamics 365 for Sales.;
                           ESM=Especifica que los pedidos de venta se crear†n autom†ticamente a partir de pedidos de ventas que se env°an en Dynamics 365 for Sales.;
                           FRC=SpÇcifie que les documents de vente seront crÇÇs automatiquement Ö partir des documents de vente envoyÇs dans Dynamicsˇ365 for Sales.;
                           ENC=Specifies that sales orders will be created automatically from sales orders that are submitted in Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Auto Create Sales Orders";
                Editable=IsAutoCreateSalesOrdersEditable }

    { 26  ;1   ;Group     ;
                Name=AdvancedSettings;
                CaptionML=[ENU=Advanced Settings;
                           ESM=Configuraci¢n avanzada;
                           FRC=Paramätres avancÇs;
                           ENC=Advanced Settings];
                Visible="Is Enabled";
                GroupType=Group }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that Dynamics 365 users must have a matching user account in Dynamics 365 for Sales to have Dynamics 365 for Sales integration capabilities in the user interface.;
                           ESM=Especifica que los usuarios de Dynamics 365 deben tener una cuenta de usuario que coincida en Dynamics 365 for Sales para poder usar las funciones de integraci¢n de Dynamics 365 for Sales en la interfaz de usuario.;
                           FRC=SpÇcifie que les utilisateurs Dynamicsˇ365 doivent avoir un compte utilisateur correspondant dans Dynamicsˇ365 for Sales pour disposer de capacitÇs d'intÇgration de Dynamicsˇ365 for Sales dans l'interface utilisateur.;
                           ENC=Specifies that Dynamics 365 users must have a matching user account in Dynamics 365 for Sales to have Dynamics 365 for Sales integration capabilities in the user interface.];
                ApplicationArea=#Suite;
                SourceExpr="Is User Mapping Required";
                OnValidate=BEGIN
                             UpdateIsEnabledState;
                             SetStyleExpr;
                           END;
                            }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Current Business Central User is Mapped to a Dynamics 365 for Sales User;
                           ESM=El usuario de Business Central actual est† asignado a un usuario de Dynamics 365 for Sales;
                           FRC=L'utilisateur Business Central actuel est associÇ Ö un utilisateur Dynamicsˇ365 for Sales;
                           ENC=Current Business Central User is Mapped to a Dynamics 365 for Sales User];
                ToolTipML=[ENU=Specifies that the user account that you used to sign in with has a matching user account in Dynamics 365 for Sales.;
                           ESM=Especifica que la cuenta de usuario que us¢ para iniciar sesi¢n coincide con una cuenta de usuario de Dynamics 365 for Sales.;
                           FRC=SpÇcifie que le compte utilisateur utilisÇ pour vous connecter dispose d'un compte utilisateur correspondant dans Dynamics 365 for Sales.;
                           ENC=Specifies that the user account that you used to sign in with has a matching user account in Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Is User Mapped To CRM User";
                Visible="Is User Mapping Required";
                Editable=FALSE;
                StyleExpr=UserMappedToCRMUserStyleExpr;
                OnDrillDown=BEGIN
                              IF "Is User Mapped To CRM User" THEN
                                MESSAGE(CurrentuserIsMappedToCRMUserMsg,USERID,PRODUCTNAME.SHORT,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(CurrentuserIsNotMappedToCRMUserMsg,USERID,PRODUCTNAME.SHORT,CRMProductName.SHORT);
                            END;
                             }

    { 30  ;2   ;Field     ;
                ApplicationArea=#Suite }

    { 36  ;1   ;Group     ;
                Name=AuthTypeDetails;
                CaptionML=[ENU=Authentication Type Details;
                           ESM=Detalles del tipo de autenticaci¢n;
                           FRC=DÇtails du type d'authentification;
                           ENC=Authentication Type Details];
                Visible=NOT SoftwareAsAService;
                GroupType=Group }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the authentication type that will be used to authenticate with Dynamics 365 for Sales;
                           ESM=Especifica el tipo de autenticaci¢n que se va a utilizar para la autenticaci¢n con Dynamics 365 for Sales.;
                           FRC=SpÇcifie le type d'authentification qui sera utilisÇ pour authentifier avec Dynamics 365 for Sales.;
                           ENC=Specifies the authentication type that will be used to authenticate with Dynamics 365 for Sales];
                ApplicationArea=#Advanced;
                SourceExpr="Authentication Type";
                Editable=NOT "Is Enabled";
                OnValidate=BEGIN
                             SetIsConnectionStringEditable;
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the domain name of your Dynamics 365 for Sales deployment.;
                           ESM=Especifica el nombre de dominio de su implementaci¢n de Dynamics 365 for Sales.;
                           FRC=SpÇcifie le nom de domaine de votre dÇploiement Dynamics 365 for Sales.;
                           ENC=Specifies the domain name of your Dynamics 365 for Sales deployment.];
                ApplicationArea=#Advanced;
                SourceExpr=Domain }

    { 38  ;2   ;Field     ;
                Name=Connection String;
                CaptionML=[ENU=Connection String;
                           ESM=Cadena de conexi¢n;
                           FRC=Chaåne de connexion;
                           ENC=Connection String];
                ToolTipML=[ENU=Specifies the connection string that will be used to connect to Dynamics 365 for Sales;
                           ESM=Especifica la cadena de conexi¢n que se va a utilizar para conectarse a Dynamics 365 for Sales;
                           FRC=SpÇcifie la chaåne de connexion qui sera utilisÇe pour se connecter Ö Dynamics 365 for Sales.;
                           ENC=Specifies the connection string that will be used to connect to Dynamics 365 for Sales];
                ApplicationArea=#Advanced;
                SourceExpr=ConnectionString;
                Editable=IsConnectionStringEditable;
                OnValidate=BEGIN
                             SetConnectionString(ConnectionString);
                           END;
                            }

  }
  CODE
  {
    VAR
      AssistedSetup@1010 : Record 1803;
      CRMProductName@1017 : Codeunit 5344;
      CRMPassword@1000 : Text;
      ResetIntegrationTableMappingConfirmQst@1003 : TextConst '@@@="%1 = CRM product name";ENU=This will delete all existing integration table mappings and %1 synchronization jobs and install the default integration table mappings and jobs for %1 synchronization.\\Are you sure that you want to continue?;ESM=Esto eliminar† todas las asignaciones de tabla de integraci¢n y trabajos de sincronizaci¢n existentes de %1 e instalar† las asignaciones de tabla de integraci¢n y trabajos predeterminados para la sincronizaci¢n de %1.\\®Seguro que desea continuar?;FRC=Cette action va supprimer l''ensemble des correspondances de table d''intÇgration et des projets de synchronisation %1 existants et installer les correspondances de table d''intÇgration et les projets de synchronisation %1 par dÇfaut.\\Voulez-vous vraiment continuerˇ?;ENC=This will delete all existing integration table mappings and %1 synchronization jobs and install the default integration table mappings and jobs for %1 synchronization.\\Are you sure that you want to continue?';
      ConfirmGenerateIntegrationIdsQst@1006 : TextConst 'ENU=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?;ESM=Va a agregar datos de integraci¢n a las tablas. Este proceso puede tardar varios minutos. ®Desea continuar?;FRC=Vous àtes sur le point d''ajouter des donnÇes d''intÇgration Ö des tables. Ce processus peut prendre plusieurs minutes. Souhaitez-vous continuer?;ENC=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?';
      GenerateIntegrationIdsSuccessMsg@1005 : TextConst 'ENU=The integration data has been added to the tables.;ESM=Los datos de integraci¢n se agregaron a las tablas.;FRC=Les donnÇes d''intÇgration ont ÇtÇ ajoutÇes aux tables.;ENC=The integration data has been added to the tables.';
      EncryptionIsNotActivatedQst@1016 : TextConst 'ENU=Data encryption is currently not enabled. We recommend that you encrypt data. \Do you want to open the Data Encryption Management window?;ESM=El cifrado de datos no est† habilitado actualmente. Se recomienda cifrar los datos. \®Desea abrir la ventana Administraci¢n del cifrado de datos?;FRC=Le chiffrement des donnÇes n''est actuellement pas activÇ. Nous vous recommandons de chiffrer les donnÇes. \Voulez-vous ouvrir la fenàtre Gestion du chiffrement des donnÇesˇ?;ENC=Data encryption is currently not enabled. We recommend that you encrypt data. \Do you want to open the Data Encryption Management window?';
      WebClientUrlResetMsg@1014 : TextConst '@@@=%1 - product name;ENU=The %1 Web Client URL has been reset to the default value.;ESM=La URL de cliente web de %1 se ha restablecido en el valor predeterminado.;FRC=L''URL du client Web %1 a ÇtÇ rÇinitialisÇe Ö la valeur par dÇfaut.;ENC=The %1 Web Client URL has been reset to the default value.';
      SyncNowSuccessMsg@1018 : TextConst '@@@="%1 = Page 5338 Caption";ENU=Synchronize Modified Records completed.\See the %1 window for details.;ESM=Se complet¢ la sincronizaci¢n de registros modificados.\Consulte la ventana %1 para obtener informaci¢n detallada.;FRC=La synchronisation des enregistrements modifiÇs est terminÇe.\Consultez la fenàtre %1 pour plus d''informations.;ENC=Synchronize Modified Records completed.\See the %1 window for details.';
      UnfavorableCRMVersionMsg@1033 : TextConst '@@@="%1 - product name, %2 = CRM product name";ENU=This version of %2 might not work correctly with %1. We recommend you upgrade to a supported version.;ESM=Es posible que esta versi¢n de %2 no funcione correctamente con %1. Recomendamos que actualice a una versi¢n compatible.;FRC=Cette version de %2 risque de ne pas fonctionner correctement avec %1. Nous vous recommandons d''effectuer une mise Ö niveau vers une version prise en charge.;ENC=This version of %2 might not work correctly with %1. We recommend you upgrade to a supported version.';
      FavorableCRMVersionMsg@1034 : TextConst '@@@="%1 = CRM product name";ENU=The version of %1 is valid.;ESM=La versi¢n de %1 es v†lida.;FRC=La version de %1 est valide.;ENC=The version of %1 is valid.';
      UnfavorableCRMSolutionInstalledMsg@1036 : TextConst '@@@=%1 - product name;ENU=The %1 Integration Solution was not detected.;ESM=No se detect¢ la soluci¢n de integraci¢n de %1.;FRC=La solution d''intÇgration %1 n''a pas ÇtÇ dÇtectÇe.;ENC=The %1 Integration Solution was not detected.';
      FavorableCRMSolutionInstalledMsg@1037 : TextConst '@@@="%1 - product name, %2 = CRM product name";ENU=The %1 Integration Solution is installed in %2.;ESM=La soluci¢n de integraci¢n de %1 est† instalada en %2.;FRC=La solution d''intÇgration %1 est installÇe dans %2.;ENC=The %1 Integration Solution is installed in %2.';
      SynchronizeModifiedQst@1038 : TextConst 'ENU=This will synchronize all modified records in all Integration Table Mappings.\\Do you want to continue?;ESM=De este modo, se sincronizar†n todos los registros modificados en todas las asignaciones de tablas de integraci¢n.\\®Desea continuar?;FRC=Cette opÇration va synchroniser tous les enregistrements modifiÇs dans toutes les correspondances de table d''intÇgration.\\Voulez-vous continuerˇ?;ENC=This will synchronize all modified records in all Integration Table Mappings.\\Do you want to continue?';
      ReadyScheduledSynchJobsTok@1049 : TextConst '@@@="%1 = Count of scheduled job queue entries in ready or in process state, %2 count of all scheduled jobs";ENU=%1 of %2;ESM=%1 de %2;FRC=%1 sur %2;ENC=%1 of %2';
      ScheduledSynchJobsRunning@1002 : Text;
      CurrentuserIsMappedToCRMUserMsg@1053 : TextConst '@@@="%1 = Current User ID, %2 - product name, %3 = CRM product name";ENU=%2 user (%1) is mapped to a %3 user.;ESM=El usuario de %2 (%1) est† asignado a un usuario de %3.;FRC=L''utilisateur %2 (%1) est mappÇ Ö un utilisateur %3.;ENC=%2 user (%1) is mapped to a %3 user.';

      CurrentuserIsNotMappedToCRMUserMsg@1054 : TextConst
        '@@@="%1 = Current User ID, %2 - product name, %3 = CRM product name"',
        'ENU=Because the %2 Users Must Map to %3 Users field is set, %3 integration is not enabled for %1.\\To enable %3 integration for %2 user %1, the authentication email must match the primary email of a %3 user.',
        'ESM=Dado que el campo "Los usuarios de %2 deben asignar a los usuarios de %3" est† seleccionado, la integraci¢n de %3 no est† habilitada para %1.\\Para habilitar la integraci¢n de %3 para el usuario de %2 %1, el correo electr¢nico de autenticaci¢n debe coincidir con el correo electr¢nico principal de un usuario de %3.',
        'FRC=êtant donnÇ que le champ Correspondance obligatoire entre utilisateurs %2 et %3 est cochÇ, l''intÇgration de %3 n''est pas activÇe pour %1.\\Pour activer l''intÇgration de %3 pour l''utilisateur %2 %1, l''adresse de courriel pour l''authentification doit correspondre Ö l''adresse de courriel principale d''un utilisateur %3.',
        'ENC=Because the %2 Users Must Map to %3 Users field is set, %3 integration is not enabled for %1.\\To enable %3 integration for %2 user %1, the authentication email must match the primary email of a %3 user.';
      EnableServiceQst@1057 : TextConst '@@@="%1 = This Page Caption (Microsoft Dynamics 365 Connection Setup)";ENU=The %1 is not enabled. Are you sure you want to exit?;ESM=%1 no est† habilitado. ®Est† seguro de que desea salir?;FRC=Le %1 n''est pas activÇ. Voulez-vous vraiment quitterˇ?;ENC=The %1 is not enabled. Are you sure you want to exit?';
      PartialScheduledJobsAreRunningMsg@1046 : TextConst '@@@="%1 = Count of scheduled job queue entries in ready or in process state, %2 count of all scheduled jobs";ENU=An active job queue is available but only %1 of the %2 scheduled synchronization jobs are ready or in process.;ESM=Hay una cola de trabajos activa disponible, pero solo %1 de los %2 trabajos de sincronizaci¢n programados est†n listos o en curso.;FRC=Une file d''attente des travaux active est disponible mais seuls %1 des %2 projets de synchronisation programmÇs sont pràts ou en cours de traitement.;ENC=An active job queue is available but only %1 of the %2 scheduled synchronization jobs are ready or in process.';
      JobQueueIsNotRunningMsg@1048 : TextConst 'ENU=There is no job queue started. Scheduled synchronization jobs require an active job queue to process jobs.\\Contact your administrator to get a job queue configured and started.;ESM=No hay ninguna cola de trabajos iniciada. Los trabajos de sincronizaci¢n programados necesitan una cola de trabajos activa para procesar trabajos.\\P¢ngase en contacto con su administrador para configurar e iniciar una cola de trabajos.;FRC=Aucune file d''attente des travaux n''est lancÇe. Les projets de synchronisation programmÇs exigent une file d''attente des travaux active pour àtre traitÇs.\\Contactez votre administrateur pour configurer et lancer une file d''attente des travaux.;ENC=There is no job queue started. Scheduled synchronization jobs require an active job queue to process jobs.\\Contact your administrator to get a job queue configured and started.';
      AllScheduledJobsAreRunningMsg@1045 : TextConst 'ENU=An job queue is started and all scheduled synchronization jobs are ready or already processing.;ESM=Se inici¢ una cola de trabajos y todos los trabajos de sincronizaci¢n programados est†n listos o ya se est†n procesando.;FRC=Une file d''attente des travaux est lancÇe et les projets de synchronisation programmÇs sont tous pràts ou dÇjÖ en cours de traitement.;ENC=An job queue is started and all scheduled synchronization jobs are ready or already processing.';
      SetupSuccessfulMsg@1001 : TextConst '@@@="%1 = CRM product name";ENU=The default setup for %1 synchronization has completed successfully.;ESM=La configuraci¢n predeterminada de la sincronizaci¢n de %1 se ha completado correctamente.;FRC=La configuration par dÇfaut de la synchronisation de %1 s''est terminÇe avec succäs.;ENC=The default setup for %1 synchronization has completed successfully.';
      ScheduledSynchJobsRunningStyleExpr@1011 : Text;
      CRMSolutionInstalledStyleExpr@1012 : Text;
      CRMVersionStyleExpr@1013 : Text;
      UserMappedToCRMUserStyleExpr@1019 : Text;
      ConnectionString@1020 : Text;
      WebServiceEnabledStyleExpr@1024 : Text;
      ActiveJobs@1007 : Integer;
      TotalJobs@1004 : Integer;
      IsEditable@1008 : Boolean;
      IsWebCliResetEnabled@1009 : Boolean;
      AssistedSetupAvailable@1058 : Boolean;
      SoftwareAsAService@1015 : Boolean;
      IsConnectionStringEditable@1022 : Boolean;
      IsAutoCreateSalesOrdersEditable@1021 : Boolean;
      WebServiceEnabled@1023 : Boolean;

    LOCAL PROCEDURE RefreshData@19();
    BEGIN
      UpdateIsEnabledState;
      SetIsConnectionStringEditable;
      RefreshDataFromCRM;
      SetAutoCreateSalesOrdersEditable;
      RefreshSynchJobsData;
      UpdateEnableFlags;
      IF NOT WebServiceEnabled THEN
        CLEAR("Dynamics NAV OData URL");
      SetStyleExpr;
    END;

    LOCAL PROCEDURE RefreshSynchJobsData@20();
    BEGIN
      CountCRMJobQueueEntries(ActiveJobs,TotalJobs);
      ScheduledSynchJobsRunning := STRSUBSTNO(ReadyScheduledSynchJobsTok,ActiveJobs,TotalJobs);
      ScheduledSynchJobsRunningStyleExpr := GetRunningJobsStyleExpr;
    END;

    LOCAL PROCEDURE SetStyleExpr@9();
    BEGIN
      CRMSolutionInstalledStyleExpr := GetStyleExpr("Is CRM Solution Installed");
      CRMVersionStyleExpr := GetStyleExpr(IsVersionValid);
      UserMappedToCRMUserStyleExpr := GetStyleExpr("Is User Mapped To CRM User");
      WebServiceEnabledStyleExpr := GetStyleExpr(WebServiceEnabled);
    END;

    LOCAL PROCEDURE SetIsConnectionStringEditable@4();
    BEGIN
      IsConnectionStringEditable :=
        NOT "Is Enabled";
    END;

    LOCAL PROCEDURE SetAutoCreateSalesOrdersEditable@2();
    BEGIN
      IsAutoCreateSalesOrdersEditable := "Is S.Order Integration Enabled";
    END;

    LOCAL PROCEDURE GetRunningJobsStyleExpr@1() StyleExpr : Text;
    BEGIN
      IF ActiveJobs < TotalJobs THEN
        StyleExpr := 'Ambiguous'
      ELSE
        StyleExpr := GetStyleExpr((ActiveJobs = TotalJobs) AND (TotalJobs <> 0))
    END;

    LOCAL PROCEDURE GetStyleExpr@6(Favorable@1000 : Boolean) StyleExpr : Text;
    BEGIN
      IF Favorable THEN
        StyleExpr := 'Favorable'
      ELSE
        StyleExpr := 'Unfavorable'
    END;

    LOCAL PROCEDURE UpdateEnableFlags@3();
    VAR
      CRMIntegrationManagement@1000 : Codeunit 5330;
    BEGIN
      IsEditable := NOT "Is Enabled";
      IsWebCliResetEnabled := "Is CRM Solution Installed" AND "Is Enabled For User";
      WebServiceEnabled := CRMIntegrationManagement.IsItemAvailabilityWebServiceEnabled;
    END;

    LOCAL PROCEDURE InitializeDefaultProxyVersion@5();
    VAR
      CRMIntegrationManagement@1000 : Codeunit 5330;
    BEGIN
      VALIDATE("Proxy Version",CRMIntegrationManagement.GetLastProxyVersionItem);
    END;

    BEGIN
    END.
  }
}

