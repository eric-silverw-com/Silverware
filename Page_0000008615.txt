OBJECT Page 8615 Config. Packages
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Configuration Packages;
               ESM=Paquetes de configuraci¢n;
               FRC=Packages configuration;
               ENC=Configuration Packages];
    ApplicationArea=#Suite;
    SourceTable=Table8623;
    PageType=List;
    UsageCategory=Lists;
    CardPageID=Config. Package Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Manage,Package;
                                ESM=Nuevo,Procesar,Informe,Administrar, Paquete;
                                FRC=Nouveau,Traiter,Rapport,GÇrer,Package;
                                ENC=New,Process,Report,Manage,Package];
    OnOpenPage=VAR
                 ConfigurationPackageFile@1000 : Record 2000000170;
                 ConfigPackage@1001 : Record 8623;
               BEGIN
                 ImportPredefinedPackageVisible := NOT ConfigurationPackageFile.ISEMPTY;
                 AditionalOptionsEnabled := ConfigPackage.WRITEPERMISSION;
               END;

    ActionList=ACTIONS
    {
      { 9       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Package;
                                 ESM=Paquete;
                                 FRC=Package;
                                 ENC=Package] }
      { 22      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Package;
                                 ESM=Exportar paquete;
                                 FRC=Exporter package;
                                 ENC=Export Package];
                      ToolTipML=[ENU=Create a .rapidstart file that which delivers the package contents in a compressed format. Configuration questionnaires, configuration templates, and the configuration worksheet are added to the package automatically unless you specifically decide to exclude them.;
                                 ESM=Permite crear un archivo .rapidstart que entrega el contenido del paquete en un formato comprimido. Los cuestionarios de configuraci¢n, las plantillas de configuraci¢n y la hoja de trabajo de configuraci¢n se agregan al paquete de forma autom†tica, a menos que decida excluirlos espec°ficamente.;
                                 FRC=CrÇez un fichier .rapidstart qui fournit le contenu du package dans un format compressÇ. Les questionnaires de configuration, les modäles de configuration ainsi que la feuille de configuration sont ajoutÇs automatiquement au package, sauf si vous dÇcidez de les exclure.;
                                 ENC=Create a .rapidstart file that which delivers the package contents in a compressed format. Configuration questionnaires, configuration templates, and the configuration worksheet are added to the package automatically unless you specifically decide to exclude them.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AditionalOptionsEnabled;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD(Code);
                                 ConfigXMLExchange.ExportPackage(Rec);
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Package;
                                 ESM=Importar paquete;
                                 FRC=Importer package;
                                 ENC=Import Package];
                      ToolTipML=[ENU=Import a .rapidstart package file.;
                                 ESM=Importa un archivo de paquete .rapidstart.;
                                 FRC=Importez un fichier de package .rapidstart.;
                                 ENC=Import a .rapidstart package file.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AditionalOptionsEnabled;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ConfigXMLExchange.ImportPackageXMLFromClient;
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Predefined Package;
                                 ESM=Importar paquete predefinido;
                                 FRC=Importer le package prÇdÇfini;
                                 ENC=Import Predefined Package];
                      ToolTipML=[ENU=Import one of the preloaded files with packages, such as Evaluation or Standard.;
                                 ESM=Importa uno de los archivos precargados con paquetes, como evaluaci¢n o est†ndar.;
                                 FRC=Importez l'un des fichiers prÇchargÇs avec les packages, par exemple êvaluation ou Standard.;
                                 ENC=Import one of the preloaded files with packages, such as Evaluation or Standard.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=ImportPredefinedPackageVisible;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TempBlob@1005 : TEMPORARY Record 99008535;
                                 TempBlobUncompressed@1002 : TEMPORARY Record 99008535;
                                 ConfigurationPackageFile@1001 : Record 2000000170;
                                 ConfigurationPackageFiles@1000 : Page 1800;
                                 InStream@1003 : InStream;
                               BEGIN
                                 ConfigurationPackageFiles.LOOKUPMODE(TRUE);
                                 IF ConfigurationPackageFiles.RUNMODAL <> ACTION::LookupOK THEN
                                   EXIT;

                                 ConfigurationPackageFiles.GETRECORD(ConfigurationPackageFile);
                                 ConfigurationPackageFile.CALCFIELDS(Package);
                                 TempBlob.Blob := ConfigurationPackageFile.Package;
                                 ConfigXMLExchange.DecompressPackageToBlob(TempBlob,TempBlobUncompressed);
                                 TempBlobUncompressed.Blob.CREATEINSTREAM(InStream);
                                 ConfigXMLExchange.ImportPackageXMLFromStream(InStream);
                               END;
                                }
      { 11      ;2   ;Action    ;
                      CaptionML=[ENU=Export to Excel;
                                 ESM=Exportar a Excel;
                                 FRC=Exporter dans Excel;
                                 ENC=Export to Excel];
                      ToolTipML=[ENU=Export the data in the package to Excel.;
                                 ESM=Exporta los datos del paquete a Excel.;
                                 FRC=Exportez les donnÇes du package vers Excel.;
                                 ENC=Export the data in the package to Excel.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AditionalOptionsEnabled;
                      Image=ExportToExcel;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ConfigPackageTable@1000 : Record 8613;
                                 ConfigExcelExchange@1001 : Codeunit 8618;
                               BEGIN
                                 TESTFIELD(Code);

                                 ConfigPackageTable.SETRANGE("Package Code",Code);
                                 IF CONFIRM(Text004,TRUE,Code) THEN
                                   ConfigExcelExchange.ExportExcelFromTables(ConfigPackageTable);
                               END;
                                }
      { 15      ;2   ;Action    ;
                      CaptionML=[ENU=Import from Excel;
                                 ESM=Importar desde Excel;
                                 FRC=Importer d'Excel;
                                 ENC=Import from Excel];
                      ToolTipML=[ENU=Begin the migration of legacy data.;
                                 ESM=Inicia la migraci¢n de los datos heredados.;
                                 FRC=Commencez la migration des anciennes donnÇes.;
                                 ENC=Begin the migration of legacy data.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AditionalOptionsEnabled;
                      Image=ImportExcel;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ConfigExcelExchange@1000 : Codeunit 8618;
                               BEGIN
                                 ConfigExcelExchange.ImportExcelFromPackage;
                               END;
                                }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=Fonction&s;
                                 ENC=F&unctions] }
      { 19      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Tables;
                                 ESM=Obtener tablas;
                                 FRC=Extraire tables;
                                 ENC=Get Tables];
                      ToolTipML=[ENU=Select tables that you want to add to the configuration package.;
                                 ESM=Permite seleccionar las tablas que desea agregar al paquete de configuraci¢n.;
                                 FRC=SÇlectionnez les tables que vous souhaitez ajouter au package de configuration.;
                                 ENC=Select tables that you want to add to the configuration package.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=GetLines;
                      PromotedCategory=New;
                      OnAction=VAR
                                 GetPackageTables@1000 : Report 8616;
                               BEGIN
                                 CurrPage.SAVERECORD;
                                 GetPackageTables.Set(Code);
                                 GetPackageTables.RUNMODAL;
                                 CLEAR(GetPackageTables);
                               END;
                                }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Apply Package;
                                 ESM=Aplicar paquete;
                                 FRC=Appliquer package;
                                 ENC=Apply Package];
                      ToolTipML=[ENU=Import the configuration package and apply the package database data at the same time.;
                                 ESM=Importa el paquete de configuraci¢n y aplica los datos de base de datos del paquete al mismo tiempo.;
                                 FRC=Importez le package de configuration et appliquez simultanÇment toutes les donnÇes de base de donnÇes du package.;
                                 ENC=Import the configuration package and apply the package database data at the same time.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Apply;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ConfigPackageTable@1002 : Record 8613;
                                 ConfigPackageMgt@1000 : Codeunit 8611;
                               BEGIN
                                 TESTFIELD(Code);
                                 IF CONFIRM(Text003,TRUE,Code) THEN BEGIN
                                   ConfigPackageTable.SETRANGE("Package Code",Code);
                                   ConfigPackageMgt.ApplyPackage(Rec,ConfigPackageTable,TRUE);
                                 END;
                               END;
                                }
      { 14      ;2   ;Action    ;
                      CaptionML=[ENU=Copy Package;
                                 ESM=Copiar paquete;
                                 FRC=Copier package;
                                 ENC=Copy Package];
                      ToolTipML=[ENU=Copy an existing configuration package to create a new package based on the same content.;
                                 ESM=Copia un paquete de configuraci¢n existente para crear uno nuevo basado en el mismo contenido.;
                                 FRC=Copiez un package de configuration existant afin de crÇer un nouveau package selon le màme contenu.;
                                 ENC=Copy an existing configuration package to create a new package based on the same content.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CopyWorksheet;
                      OnAction=VAR
                                 CopyPackage@1000 : Report 8615;
                               BEGIN
                                 TESTFIELD(Code);
                                 CopyPackage.Set(Rec);
                                 CopyPackage.RUNMODAL;
                                 CLEAR(CopyPackage);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=ValidatePackage;
                      CaptionML=[ENU=Validate Package;
                                 ESM=Validar paquete;
                                 FRC=Valider package;
                                 ENC=Validate Package];
                      ToolTipML=[ENU=Determine if you have introduced errors, such as not including tables that the configuration relies on.;
                                 ESM=Permite determinar si ha cometido errores, como no incluir las tablas de las que depende la configuraci¢n.;
                                 FRC=DÇterminez si vous avez introduit des erreurs, telles que le fait de ne pas inclure les tables sur lesquelles la configuration compte.;
                                 ENC=Determine if you have introduced errors, such as not including tables that the configuration relies on.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CheckRulesSyntax;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ConfigPackageTable@1000 : Record 8613;
                                 ActiveSession@1004 : Record 2000000110;
                                 SessionEvent@1005 : Record 2000000111;
                                 ConfigProgressBar@1001 : Codeunit 8615;
                                 Canceled@1002 : Boolean;
                               BEGIN
                                 IF CONFIRM(Text002,TRUE,"Package Name") THEN BEGIN
                                   ConfigPackageTable.SETRANGE("Package Code",Code);
                                   ConfigProgressBar.Init(ConfigPackageTable.COUNT,1,ValidatingTableRelationsMsg);

                                   BackgroundSessionId := 0;
                                   STARTSESSION(BackgroundSessionId,CODEUNIT::"Config. Validate Package",COMPANYNAME,ConfigPackageTable);

                                   ConfigPackageTable.SETRANGE(Validated,FALSE);
                                   ConfigPackageTable.SETCURRENTKEY("Package Processing Order","Processing Order");

                                   SLEEP(1000);
                                   WHILE NOT Canceled AND ActiveSession.GET(SERVICEINSTANCEID,BackgroundSessionId) AND ConfigPackageTable.FINDFIRST DO BEGIN
                                     ConfigPackageTable.CALCFIELDS("Table Name");
                                     Canceled := NOT ConfigProgressBar.UpdateCount(ConfigPackageTable."Table Name",ConfigPackageTable.COUNT);
                                     SLEEP(1000);
                                   END;

                                   IF ActiveSession.GET(SERVICEINSTANCEID,BackgroundSessionId) THEN
                                     STOPSESSION(BackgroundSessionId,ValidationCanceledMsg);

                                   IF NOT Canceled AND ConfigPackageTable.FINDFIRST THEN BEGIN
                                     SessionEvent.SETASCENDING("Event Datetime",TRUE);
                                     SessionEvent.SETRANGE("User ID",USERID);
                                     SessionEvent.SETRANGE("Server Instance ID",SERVICEINSTANCEID);
                                     SessionEvent.SETRANGE("Session ID",BackgroundSessionId);
                                     SessionEvent.FINDLAST;
                                     MESSAGE(SessionEvent.Comment);
                                   END;

                                   ConfigProgressBar.Close;
                                 END;
                               END;
                                }
      { 12      ;2   ;Separator  }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Export to Translation;
                                 ESM=Exportar a traducci¢n;
                                 FRC=Exporter vers la traduction;
                                 ENC=Export to Translation];
                      ToolTipML=[ENU=Export the data to a file that is suited translation.;
                                 ESM=Exporta los datos a un archivo de traducci¢n apropiado.;
                                 FRC=Exporter les donnÇes vers un fichier adaptÇ Ö la traduction.;
                                 ENC=Export the data to a file that is suited translation.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=Export;
                      OnAction=VAR
                                 ConfigPackageTable@1001 : Record 8613;
                               BEGIN
                                 TESTFIELD(Code);
                                 ConfigXMLExchange.SetAdvanced(TRUE);
                                 ConfigPackageTable.SETRANGE("Package Code",Code);
                                 IF CONFIRM(Text004,TRUE,Code) THEN
                                   ConfigXMLExchange.ExportPackageXML(ConfigPackageTable,'');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                GroupType=Repeater }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the configuration package.;
                           ESM=Especifica un c¢digo para el paquete de configuraci¢n.;
                           FRC=SpÇcifie un code pour le package configuration.;
                           ENC=Specifies a code for the configuration package.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the package.;
                           ESM=Especifica el nombre del paquete.;
                           FRC=SpÇcifie le nom du package.;
                           ENC=Specifies the name of the package.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Package Name" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the Windows language to use for the configuration package. Choose the field and select a language ID from the list.;
                           ESM=Especifica el id. de idioma de Windows que se debe usar para el paquete de configuraci¢n. Elija el campo y seleccione un id. de idioma de la lista.;
                           FRC=SpÇcifie le code de la langue Windows Ö utiliser pour le package de configuration. Choisissez le champ et sÇlectionnez un Code de langue dans la liste.;
                           ENC=Specifies the ID of the Windows language to use for the configuration package. Choose the field and select a language ID from the list.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language ID" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version of the product that you are configuring. You can use this field to help differentiate among various versions of a solution.;
                           ESM=Especifica la versi¢n del producto que est† configurando. Puede usar este campo para ayudar a distinguir entre las distintas versiones de una soluci¢n.;
                           FRC=SpÇcifie la version du produit que vous configurez. Vous pouvez utiliser ce champ pour aider Ö diffÇrencier diffÇrentes versions d'une solution.;
                           ENC=Specifies the version of the product that you are configuring. You can use this field to help differentiate among various versions of a solution.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Product Version" }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order in which the package is to be processed.;
                           ESM=Especifica el orden en el que se procesar† el paquete.;
                           FRC=SpÇcifie l'ordre dans lequel le package doit àtre traitÇ.;
                           ENC=Specifies the order in which the package is to be processed.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Processing Order" }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether to exclude configuration tables from the package. Select the check box to exclude these types of tables.;
                           ESM=Especifica si se deben excluir tablas de configuraci¢n del paquete. Active la casilla para excluir estos tipos de tablas.;
                           FRC=SpÇcifie si les tables de configuration doivent àtre exclues ou non du package. Activez la case Ö cocher pour exclure ces types de tables.;
                           ENC=Specifies whether to exclude configuration tables from the package. Select the check box to exclude these types of tables.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Exclude Config. Tables" }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of tables that the package contains.;
                           ESM=Especifica el n£mero de tablas que contiene el paquete.;
                           FRC=Indique le nombre de tables contenues dans le package.;
                           ENC=Specifies the number of tables that the package contains.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. of Tables" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of records in the package.;
                           ESM=Especifica el n£mero de registros que contiene el paquete.;
                           FRC=SpÇcifie le nombre d'enregistrements dans le package.;
                           ENC=Specifies the number of records in the package.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. of Records" }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of errors that the package contains.;
                           ESM=Especifica el n£mero de errores que contiene el paquete.;
                           FRC=Indique le nombre d'erreurs contenues dans le package.;
                           ENC=Specifies the number of errors that the package contains.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. of Errors" }

  }
  CODE
  {
    VAR
      ConfigXMLExchange@1000 : Codeunit 8614;
      Text002@1002 : TextConst 'ENU=Validate package %1?;ESM=®Validar paquete %1?;FRC=Valider package %1ˇ?;ENC=Validate package %1?';
      Text003@1003 : TextConst 'ENU=Apply data from package %1?;ESM=®Aplicar datos del paquete %1?;FRC=Appliquer donnÇes du package %1ˇ?;ENC=Apply data from package %1?';
      Text004@1005 : TextConst 'ENU=Export package %1?;ESM=®Exportar paquete %1?;FRC=Exporter package %1ˇ?;ENC=Export package %1?';
      ValidatingTableRelationsMsg@1004 : TextConst 'ENU=Validating table relations;ESM=Validando relaciones de tabla;FRC=Validation des relations de table;ENC=Validating table relations';
      ValidationCanceledMsg@1001 : TextConst 'ENU=Validation canceled.;ESM=Validaci¢n cancelada.;FRC=Validation annulÇe.;ENC=Validation cancelled.';
      BackgroundSessionId@1007 : Integer;
      ImportPredefinedPackageVisible@1006 : Boolean;
      AditionalOptionsEnabled@1008 : Boolean;

    BEGIN
    END.
  }
}

