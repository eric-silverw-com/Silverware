OBJECT Page 6086317 Expenses
{
  OBJECT-PROPERTIES
  {
    Date=11/06/17;
    Time=[ 1:00:00 AM];
    Version List=EMW16.00.10.2.60.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Expenses;
    SourceTable=Table6086320;
    SourceTableView=SORTING(Posted)
                    WHERE(Posted=CONST(No),
                          Settlement No.=FILTER(''));
    PageType=List;
    CardPageID=Expense Card;
    PromotedActionCategoriesML=ENU=New,Process,Report,Expense,Administration;
    ShowFilter=Yes;
    OnInit=BEGIN
             EnableActions := COUNT > 0;
           END;

    OnOpenPage=VAR
                 UserResp@1160040001 : Record 6086379;
                 UpgradeMgt@1160040000 : Codeunit 6086334;
                 EMOnlineMgt@1160040002 : Codeunit 6086305;
               BEGIN
                 EMOnlineMgt.IsCompanyActive(FALSE);
                 UpgradeMgt.CheckDataVersion;
                 EnableFields;
                 CheckUnProcessedInbox;
                 ShowBankIntegration := BankIntegrationExists;

                 IF UserResp.GetResponsibilityFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Continia User ID",UserResp.GetResponsibilityFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       EnableActions := TRUE;
                       HasComments := HasApprovalComment OR HasExpenseComment;
                       ShortcutFieldFunctions.ShowShortcutFieldValues(ShortcutFieldValues,DATABASE::Expense,0,'',"Entry No.");

                       //DO NOT FORMAT DIFFERENTLY. SEARCH/REPLACE FOR COMPATIBILITY
                       CASE Status OF
                         Status::Open: StyleFormat := 'Attention';
                         Status::Released: StyleFormat := 'Favorable';
                         ELSE StyleFormat := 'None';
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1160040028;1 ;ActionGroup;
                      CaptionML=ENU=E&xpense }
      { 1160040033;2 ;Action    ;
                      Name=<Action1160040033>;
                      CaptionML=ENU=Expense Inbox;
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Expense Inbox");
                               END;
                                }
      { 1160040056;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+T;
                      CaptionML=ENU=Attachments;
                      RunObject=Page 6086333;
                      RunPageLink=Table ID=CONST(6086320),
                                  Document Type=CONST(Budget),
                                  Document No.=CONST(),
                                  Doc. Ref. No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Attachments;
                      PromotedCategory=Category4 }
      { 1160040032;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 LookupDimensions(TRUE);
                               END;
                                }
      { 1160040046;2 ;Action    ;
                      CaptionML=ENU=Extra Fields;
                      Enabled=EnableActions;
                      Image=SelectField;
                      OnAction=BEGIN
                                 LookupExtraFields(TRUE);
                               END;
                                }
      { 1160040073;2 ;Action    ;
                      Name=<Action1160040073>;
                      CaptionML=ENU=Attendees;
                      Enabled=EnableActions;
                      Image=Users;
                      OnAction=BEGIN
                                 DrillDownAttendees;
                               END;
                                }
      { 1160040070;2 ;Separator  }
      { 1160040022;2 ;Action    ;
                      CaptionML=ENU=Approvals;
                      Enabled=EnableActions;
                      Image=Approvals;
                      OnAction=BEGIN
                                 EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                               END;
                                }
      { 1160040025;0 ;ActionContainer;
                      Name=<Action1160040025>;
                      CaptionML=ENU=&Bank;
                      ActionContainerType=ActionItems }
      { 1160040036;1 ;ActionGroup;
                      CaptionML=ENU=&Bank }
      { 1160040027;2 ;Action    ;
                      CaptionML=ENU=Bank Transaction Inbox;
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      PromotedIsBig=No;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Bank Transaction Inbox");
                               END;
                                }
      { 1160040029;2 ;Action    ;
                      Name=<Action1160040029>;
                      CaptionML=ENU=Bank Transaction;
                      RunObject=Page 6086345;
                      Visible=ShowBankIntegration;
                      Image=BankAccount;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankTransaction@1160040001 : Record 6086330;
                               BEGIN
                                 BankTransaction.SETRANGE("Matched to Expense",FALSE);
                                 PAGE.RUN(6086332,BankTransaction);
                               END;
                                }
      { 1160040021;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1160040066;2 ;Action    ;
                      Name=<Action1160040055>;
                      CaptionML=ENU=Re&open;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 Expense2@1160040003 : Record 6086320;
                                 Question@1160040001 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 IF Expense.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ConfirmReopenSingle,1)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmReopenMultiple,Expense.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Expense.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     Expense2 := Expense;
                                     CODEUNIT.RUN(CODEUNIT::"Expense - Complete",Expense2);
                                   UNTIL Expense.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040060;2 ;Action    ;
                      Name=<Action1160040057>;
                      ShortCutKey=Shift+Ctrl+X;
                      CaptionML=ENU=Send to E&xpense User;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendTo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 Expense2@1160040004 : Record 6086320;
                                 EmOnlineMgt@1160040005 : Codeunit 6086305;
                                 NoOfExpSelected@1160040001 : Integer;
                                 NoOfExpSent@1160040003 : Integer;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 NoOfExpSelected := Expense.COUNT;
                                 IF Expense.COUNT > 1 THEN
                                   IF NOT CONFIRM(ConfirmSendToMultipleUsers,TRUE,Expense.COUNT) THEN
                                     EXIT;

                                 IF Expense.COUNT = 1 THEN BEGIN
                                   IF Status = Status::Open THEN
                                     IF IsSyncRequired THEN
                                       IF CONFIRM(SyncRequired,TRUE) THEN
                                         EmOnlineMgt.SetupCloud
                                       ELSE
                                         ERROR('');
                                   CODEUNIT.RUN(CODEUNIT::"Expense - Send to Expense User",Rec);
                                 END ELSE BEGIN
                                   Expense.FINDSET(TRUE,FALSE);
                                   REPEAT
                                     COMMIT;
                                     Expense2 := Expense;
                                     IF CODEUNIT.RUN(CODEUNIT::"Expense - Send to Expense User",Expense2) THEN
                                       NoOfExpSent += 1;
                                   UNTIL Expense.NEXT = 0;

                                   MESSAGE(NoOfExpSentToExpUserMsg,NoOfExpSent,NoOfExpSelected);
                                 END;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040057;2 ;Action    ;
                      Name=SendForApproval;
                      ShortCutKey=Ctrl+S;
                      CaptionML=ENU=Send for &Approval;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 EMApprovalsBridge.SendExpApprovalRequest(Expense);
                                 SetStatusFilter;
                               END;
                                }
      { 1160040055;2 ;Action    ;
                      Name=<Action1160040031>;
                      CaptionML=ENU=&Force Approval;
                      Promoted=Yes;
                      Image=Approval;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040003 : Record 6086320;
                                 Question@1160040002 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);

                                 IF Expense.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ContForceReleaselSingle)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmForceReleaseMultiple,Expense.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Expense.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     Expense.TESTFIELD(Status,Expense.Status::Open);
                                     EMApprovalsBridge.CancelApprovalRequest(DATABASE::Expense,FORMAT(Expense."Entry No."));
                                     EMApprovalsBridge.ForceApproval(DATABASE::Expense,FORMAT(Expense."Entry No."));
                                   UNTIL Expense.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040038;2 ;Separator  }
      { 1160040031;2 ;Action    ;
                      Name=ForwardApproval;
                      Ellipsis=Yes;
                      CaptionML=ENU=&Forward Approval;
                      Image=Delegate;
                      OnAction=BEGIN
                                 EMApprovalsBridge.Forward(DATABASE::Expense,FORMAT("Entry No."));
                                 SetStatusFilter;
                               END;
                                }
      { 1160040062;2 ;Separator  }
      { 1160040079;2 ;Action    ;
                      Name=<Action1160040079>;
                      CaptionML=ENU=Add to Settlement;
                      Image=Add;
                      OnAction=VAR
                                 Expense@1160040000 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 AttachExpenseToSettlement(Expense);
                               END;
                                }
      { 1160040078;2 ;Separator  }
      { 1160040043;2 ;Action    ;
                      Name=<Action1160040026>;
                      ShortCutKey=Shift+Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=ENU=Expense Split and Allocation;
                      Promoted=Yes;
                      Image=Split;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ExpAllocation@1160040001 : Record 6086321;
                                 ExpSplitAndAllocationPage@1160040000 : Page 6086320;
                               BEGIN
                                 ExpAllocation.SETRANGE("Expense Entry No.","Entry No.");
                                 ExpSplitAndAllocationPage.SETTABLEVIEW(ExpAllocation);
                                 ExpSplitAndAllocationPage.RUNMODAL;

                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040035;2 ;Action    ;
                      Name=<Action1160040035>;
                      CaptionML=ENU=Merge Expenses;
                      Promoted=Yes;
                      Image=GetSourceDoc;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Expense1@1160040000 : Record 6086320;
                                 Expense2@1160040001 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense1);
                                 IF Expense1.COUNT <> 2 THEN
                                   ERROR(Select2ExpToMergeErr);
                                 Expense1.FINDSET;
                                 Expense2.GET(Expense1."Entry No.");
                                 Expense1.NEXT;
                                 MergeExpenses(Expense1,Expense2);

                                 SetStatusFilter;
                               END;
                                }
      { 1160040063;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=ENU=Match Bank Transaction;
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      Image=SettleOpenTransactions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 MatchToBankTrans;

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 1160040067;2 ;Separator ;
                      CaptionML=ENU=Match Banktransactions }
      { 1160040068;2 ;Action    ;
                      Name=<Action3>;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Synchronize;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"EM Online Mgt.");

                                 CheckUnProcessedInbox;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040053;2 ;Separator  }
      { 1160040050;2 ;Action    ;
                      Name=<Action1160040050>;
                      CaptionML=ENU=Send Reminder &E-mail;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendConfirmation;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 ReminderEmail@1160040003 : Codeunit 6086314;
                                 OptionNo@1160040001 : Integer;
                               BEGIN
                                 OptionNo := STRMENU(Options,1,Instructions);

                                 IF OptionNo = 0 THEN
                                   EXIT;

                                 IF OptionNo = 2 THEN
                                   CurrPage.SETSELECTIONFILTER(Expense)
                                 ELSE
                                   Expense.RESET;
                                 ReminderEmail.SendExpNotificationEmails(Expense,OptionNo = 2);
                               END;
                                }
      { 1160040020;2 ;Action    ;
                      CaptionML=ENU=Move to another company;
                      Image=Intercompany;
                      OnAction=VAR
                                 MoveToCompany@1160040000 : Codeunit 6086359;
                                 RecRef@1160040002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 MoveToCompany.HandleMovement(RecRef);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 1160040058;1 ;ActionGroup;
                      Name=<Action73>;
                      CaptionML=ENU=P&osting }
      { 1160040059;2 ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=ENU=P&ost;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040000 : Record 6086320;
                               BEGIN
                                 Expense := Rec;
                                 CODEUNIT.RUN(CODEUNIT::"Expense-Post (Yes/No)",Expense);
                                 CurrPage.UPDATE(FALSE);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 1160040030;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Post &Batch;
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Expenses",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                ContainerType=ContentArea }

    { 1160040000;1;Group  ;
                GroupType=Repeater }

    { 1160040024;2;Field  ;
                SourceExpr="Entry No.";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040042;2;Field  ;
                CaptionML=ENU=Comment;
                SourceExpr=HasComments;
                Editable=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040003;2;Field  ;
                SourceExpr="Continia User ID";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           UserResp@1160040002 : Record 6086379;
                         BEGIN
                           EXIT(UserResp.LookupUser(Text));
                         END;
                          }

    { 1160040045;2;Field  ;
                SourceExpr="Continia User Name";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040011;2;Field  ;
                SourceExpr="Document Date";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040074;2;Field  ;
                SourceExpr="Settlement No.";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040034;2;Field  ;
                SourceExpr="Expense Type";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040072;2;Field  ;
                SourceExpr=Description;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040007;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040083;2;Field  ;
                SourceExpr="Business Description";
                Visible=false }

    { 1160040069;2;Field  ;
                SourceExpr=Status;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040037;2;Field  ;
                SourceExpr="On Hold";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040075;2;Field  ;
                CaptionML=ENU=Approval by;
                SourceExpr=EMApprovalMgt.GetNextApproverName(DATABASE::Expense,FORMAT("Entry No."));
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                            END;
                             }

    { 1160040015;2;Field  ;
                SourceExpr="Country/Region Code";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040017;2;Field  ;
                SourceExpr="Currency Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040013;2;Field  ;
                SourceExpr=Amount;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040005;2;Field  ;
                SourceExpr="Amount (LCY)";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040084;2;Field  ;
                SourceExpr="Allocated Amount (LCY)";
                Visible=False;
                OnDrillDown=VAR
                              ExpenseAllocation@1160040000 : Record 6086321;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;

                              ExpenseAllocation.SETCURRENTKEY("Expense Entry No.");
                              ExpenseAllocation.SETRANGE("Expense Entry No.","Entry No.");
                              PAGE.RUNMODAL(PAGE::"Expense Split and Allocation",ExpenseAllocation);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 1160040071;2;Field  ;
                SourceExpr="Bank-Currency Amount";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040026;2;Field  ;
                SourceExpr="Bank Currency Code";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040061;2;Field  ;
                SourceExpr="Cash/Private Card";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040048;2;Field  ;
                SourceExpr="Matched to Bank Transaction";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040040;2;Field  ;
                SourceExpr="No Refund";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040009;2;Field  ;
                Name=Attendees;
                CaptionML=ENU=Attendees;
                SourceExpr=GetAttendeesForDisplay;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE;
                            END;
                             }

    { 1160040054;2;Field  ;
                SourceExpr="No. of Attachments";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040039;2;Field  ;
                SourceExpr="Current Reminder Level";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040001;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040002;2;Field  ;
                SourceExpr="Global Dimension 2 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040064;2;Field  ;
                SourceExpr="Job No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040065;2;Field  ;
                SourceExpr="Job Task No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040076;2;Field  ;
                SourceExpr=Billable;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040077;2;Field  ;
                SourceExpr="Job Line Type";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040004;2;Field  ;
                Name=ShortcutFieldValues1;
                SourceExpr=ShortcutFieldValues[1];
                CaptionClass=GetShortcutFieldCaption(1);
                Visible=CustomfieldVisible1;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[1]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040006;2;Field  ;
                Name=ShortcutFieldValues2;
                SourceExpr=ShortcutFieldValues[2];
                CaptionClass=GetShortcutFieldCaption(2);
                Visible=CustomfieldVisible2;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[2]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040008;2;Field  ;
                Name=ShortcutFieldValues3;
                SourceExpr=ShortcutFieldValues[3];
                CaptionClass=GetShortcutFieldCaption(3);
                Visible=CustomfieldVisible3;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[3]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040010;2;Field  ;
                Name=ShortcutFieldValues4;
                SourceExpr=ShortcutFieldValues[4];
                CaptionClass=GetShortcutFieldCaption(4);
                Visible=CustomfieldVisible4;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[4]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040012;2;Field  ;
                Name=ShortcutFieldValues5;
                SourceExpr=ShortcutFieldValues[5];
                CaptionClass=GetShortcutFieldCaption(5);
                Visible=CustomfieldVisible5;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[5]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040014;2;Field  ;
                Name=ShortcutFieldValues6;
                SourceExpr=ShortcutFieldValues[6];
                CaptionClass=GetShortcutFieldCaption(6);
                Visible=CustomfieldVisible6;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[6]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040016;2;Field  ;
                Name=ShortcutFieldValues7;
                SourceExpr=ShortcutFieldValues[7];
                CaptionClass=GetShortcutFieldCaption(7);
                Visible=CustomfieldVisible7;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[7]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040018;2;Field  ;
                Name=ShortcutFieldValues8;
                SourceExpr=ShortcutFieldValues[8];
                CaptionClass=GetShortcutFieldCaption(8);
                Visible=CustomfieldVisible8;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[8]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040019;2;Field  ;
                Name=ShortcutFieldValues9;
                SourceExpr=ShortcutFieldValues[9];
                CaptionClass=GetShortcutFieldCaption(9);
                Visible=CustomfieldVisible9;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[9]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040023;2;Field  ;
                Name=ShortcutFieldValues10;
                SourceExpr=ShortcutFieldValues[10];
                CaptionClass=GetShortcutFieldCaption(10);
                Visible=CustomfieldVisible10;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[10]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",Text));
                         END;
                          }

    { 1160040085;2;Field  ;
                SourceExpr="Expense Account Type";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 12  ;2   ;Field     ;
                Lookup=Yes;
                SourceExpr="Expense Account";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnLookup=BEGIN
                           EXIT(LookupPostingAccount(Text));
                         END;
                          }

    { 1160040044;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040047;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040080;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 1160040081;2;Field  ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040082;2;Field  ;
                SourceExpr="Exp. Account Manually Changed";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040051;2;Field  ;
                CaptionML=ENU=Next Reminder;
                SourceExpr=NextReminderDate;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              ShowReminders;
                            END;
                             }

    { 1160040041;1;Part   ;
                Name=Expense Comment Subpage;
                SubPageLink=Doc. Ref. No.=FIELD(Entry No.),
                            Table ID=CONST(6086320);
                PagePartID=Page6086361;
                Editable=false;
                PartType=Page }

    { 2   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 1   ;1   ;Part      ;
                Name=CaptureUI;
                CaptionML=ENU=Attachments;
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page6086339;
                PartType=Page }

  }
  CODE
  {
    VAR
      ShortcutFieldFunctions@1160040010 : Codeunit 6086304;
      EMApprovalMgt@1160040000 : Codeunit 6086312;
      EMApprovalsBridge@1000 : Codeunit 6086369;
      CustomFieldNames@1160040006 : ARRAY [10] OF Text[50];
      ShortcutFieldCaptions@1160040001 : ARRAY [10] OF Text[250];
      ShortcutFieldValues@1160040002 : ARRAY [10] OF Text[250];
      StatusFilter@1160040003 : 'All,Open,PendingExpUser,PendingApproval,Released,ReadyToInvoice';
      CustomFieldVisible1@1160040005 : Boolean INDATASET;
      CustomFieldVisible10@1009 : Boolean INDATASET;
      CustomFieldVisible2@1001 : Boolean INDATASET;
      CustomFieldVisible3@1002 : Boolean INDATASET;
      CustomFieldVisible4@1003 : Boolean INDATASET;
      CustomFieldVisible5@1004 : Boolean INDATASET;
      CustomFieldVisible6@1005 : Boolean INDATASET;
      CustomFieldVisible7@1006 : Boolean INDATASET;
      CustomFieldVisible8@1007 : Boolean INDATASET;
      CustomFieldVisible9@1008 : Boolean INDATASET;
      HasComments@1160040019 : Boolean;
      ShowBankIntegration@1160040008 : Boolean INDATASET;
      ConfirmForceReleaseMultiple@1160040027 : TextConst 'ENU=This will force the approval of %1 expenses.\\Do you want to continue?';
      ContForceReleaselSingle@1160040024 : TextConst 'ENU=Do you want to force the approval of this expense?';
      ConfirmReopenMultiple@1160040025 : TextConst 'ENU=This will reopen %1 expenses.\\Do you want to continue?';
      ConfirmReopenSingle@1160040026 : TextConst 'ENU=Do you want to reopen this expense?';
      ConfirmSendToMultipleUsers@1160040023 : TextConst 'ENU=This will send %1 expenses to the expense user.\\Do you want to continue?';
      Instructions@1160040009 : TextConst 'ENU=Do you want to send a status e-mail to all the Users or only to the selected ones?';
      NoOfExpSentToExpUserMsg@1160040017 : TextConst 'ENU=%1 out of %2 sent to expense users.';
      Options@1160040015 : TextConst 'ENU=Send to All Users,Send to Selected Users only (forced)';
      Select2ExpToMergeErr@1160040007 : TextConst 'ENU=Please select two expenses to merge them.';
      SyncRequired@1160040012 : TextConst 'ENU=This expense contains values that have not been synchronized to Continia Online. This is required before this expense can be sent to the expense user.\\Would you like to synchronize values with Continia Online?';
      ConfirmDeleteMultiple@1160040018 : TextConst 'ENU=This will delete %1 expenses.\\Do you want to continue?';
      ConfirmDeleteSingle@1160040020 : TextConst 'ENU=Delete %1?';
      JobNoVisible@1160040004 : Boolean INDATASET;
      StyleFormat@1160040011 : Text[30] INDATASET;
      EnableActions@1010 : Boolean INDATASET;

    LOCAL PROCEDURE SetStatusFilter@5();
    VAR
      PrevEntryNo@1160040000 : Integer;
    BEGIN
      PrevEntryNo := "Entry No.";

      FILTERGROUP(2);

      SETRANGE(Posted,FALSE);

      CASE StatusFilter OF
        StatusFilter::All:
          SETRANGE(Status);
        StatusFilter::ReadyToInvoice:
          BEGIN
            SETRANGE(Status,Status::Released);
            SETRANGE(Posted,FALSE);
          END
        ELSE
          SETRANGE(Status,StatusFilter - 1);
      END;

      FILTERGROUP(0);

      SETRANGE("Entry No.",PrevEntryNo);
      IF FINDFIRST THEN;
      SETRANGE("Entry No.");

      IF ISEMPTY THEN
        CurrPage.CaptureUI.PAGE.ClearImage;

      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE EnableFields@1160040003();
    VAR
      EMSetup@1160040000 : Record 6086300;
    BEGIN
      EMSetup.GET;
      CustomFieldNames[1] := EMSetup."Shortcut Field 1 Code (Exp.)";
      CustomFieldNames[2] := EMSetup."Shortcut Field 2 Code (Exp.)";
      CustomFieldNames[3] := EMSetup."Shortcut Field 3 Code (Exp.)";
      CustomFieldNames[4] := EMSetup."Shortcut Field 4 Code (Exp.)";
      CustomFieldNames[5] := EMSetup."Shortcut Field 5 Code (Exp.)";
      CustomFieldNames[6] := EMSetup."Shortcut Field 6 Code (Exp.)";
      CustomFieldNames[7] := EMSetup."Shortcut Field 7 Code (Exp.)";
      CustomFieldNames[8] := EMSetup."Shortcut Field 8 Code (Exp.)";
      CustomFieldNames[9] := EMSetup."Shortcut Field 9 Code (Exp.)";
      CustomFieldNames[10] := EMSetup."Shortcut Field 10 Code (Exp.)";

      CustomFieldVisible1 := CustomFieldNames[1] <> '';
      CustomFieldVisible2 := CustomFieldNames[2] <> '';
      CustomFieldVisible3 := CustomFieldNames[3] <> '';
      CustomFieldVisible4 := CustomFieldNames[4] <> '';
      CustomFieldVisible5 := CustomFieldNames[5] <> '';
      CustomFieldVisible6 := CustomFieldNames[6] <> '';
      CustomFieldVisible7 := CustomFieldNames[7] <> '';
      CustomFieldVisible8 := CustomFieldNames[8] <> '';
      CustomFieldVisible9 := CustomFieldNames[9] <> '';
      CustomFieldVisible10 := CustomFieldNames[10] <> '';

      JobNoVisible := ShortcutFieldFunctions.JobNoVisible(DATABASE::Expense);
    END;

    LOCAL PROCEDURE GetShortcutFieldCaption@1160040001(ShortcutFieldNo@1160040000 : Integer) : Text[250];
    BEGIN
      IF ShortcutFieldCaptions[1] = '' THEN
        ShortcutFieldFunctions.GetShortcutFieldCaptionsArray(ShortcutFieldCaptions,DATABASE::Expense);

      EXIT(ShortcutFieldCaptions[ShortcutFieldNo]);
    END;

    PROCEDURE GetSelectionFilter@1160040004(VAR Expense@1160040000 : Record 6086320);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Expense);
    END;

    BEGIN
    END.
  }
}

