OBJECT Codeunit 6086100 Upgrade Management
{
  OBJECT-PROPERTIES
  {
    Date=04/23/18;
    Time=[ 1:00:00 AM];
    Version List=DCW13.70.00.5.00;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=VAR
            UpgradeManagementSI@6085579 : Codeunit 6086103;
          BEGIN
            IF NOT CONFIRM(DoYouWantToUpgradeQst,TRUE) THEN
              EXIT;

            UpgradeManagementSI.SetDCUpgraded(FALSE);
            UpgradeManagementSI.SetEMUpgraded(FALSE);

            CODEUNIT.RUN(CODEUNIT::"Upgrade Placeholder");

            DCUpgraded := UpgradeManagementSI.GetDCUpgraded;
            EMUpgraded := UpgradeManagementSI.GetEMUpgraded;

            CASE TRUE OF
              DCUpgraded AND EMUpgraded: MESSAGE(UpgradeCompleteMsg);
              DCUpgraded: MESSAGE(UpgradeDCCompleteMsg);
              EMUpgraded: MESSAGE(UpgradeEMCompleteMsg);
              ELSE
                MESSAGE(NothingUpgradedMsg);
            END;
          END;

  }
  CODE
  {
    VAR
      UpgradeDCCompleteMsg@6085574 : TextConst 'ENU=The Document Capture data has been upgraded successfully.';
      UpgradeEMCompleteMsg@6085575 : TextConst 'ENU=The Expense Management data has been upgraded successfully.';
      UpgradeCompleteMsg@6085573 : TextConst 'ENU=The Document Capture and Expense Management data has been upgraded successfully.';
      DCUpgraded@6085576 : Boolean;
      EMUpgraded@6085577 : Boolean;
      DoYouWantToUpgradeQst@6085578 : TextConst 'ENU=Do you want to start the data upgrade process?';
      NothingUpgradedMsg@6085579 : TextConst 'ENU=Nothing was upgraded.';

    BEGIN
    END.
  }
}

