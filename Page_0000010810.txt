OBJECT Page 10810 Generate EFT Files
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVNA13.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Generate EFT Files;
               ESM=Generar archivos EFT;
               FRC=G‚n‚rer des fichiers EFT;
               ENC=Generate EFT Files];
    ApplicationArea=#Basic,#Suite;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table10811;
    PageType=ListPlus;
    UsageCategory=Tasks;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Manage;
                                ESM=Nuevo,Procesar,Informar,Administrar;
                                FRC=Nouveau,Traiter,D‚clarer,G‚rer;
                                ENC=New,Process,Report,Manage];
    OnOpenPage=BEGIN
                 SettlementDate := TODAY;

                 IF (BankAccountNoFilter <> '') AND (BankAccountNoFilter <> BankAccountNo) THEN BEGIN
                   BankAccountNo := BankAccountNoFilter;
                   BankAccount.SETRANGE("No.",BankAccountNo);
                   IF BankAccount.FINDFIRST THEN
                     BankAccountDescription := BankAccount.Name;
                 END;

                 UpdateSubForm;
               END;

    ActionList=ACTIONS
    {
      { 1020011 ;    ;ActionContainer;
                      Name=Generate;
                      CaptionML=[ENU=Action;
                                 ESM=Acci¢n;
                                 FRC=Action;
                                 ENC=Action];
                      ActionContainerType=ActionItems }
      { 1020008 ;1   ;Action    ;
                      Name=Delete;
                      CaptionML=[ENU=Delete;
                                 ESM=Eliminar;
                                 FRC=Supprimer;
                                 ENC=Delete];
                      ToolTipML=[ENU=Delete the selected file.;
                                 ESM=Elimina el archivo seleccionado.;
                                 FRC=Supprimez le fichier s‚lectionn‚.;
                                 ENC=Delete the selected file.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delete;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 EFTExportWorkset@1020001 : Record 10811;
                                 EFTExport@1020000 : Record 10810;
                               BEGIN
                                 CurrPage.GenerateEFTFileLines.PAGE.GetColumns(EFTExportWorkset);
                                 WITH EFTExportWorkset DO BEGIN
                                   IF FIND('-') THEN BEGIN
                                     IF DIALOG.CONFIRM(DeleteQst) THEN
                                       REPEAT
                                         EFTExport.RESET;
                                         EFTExport.SETRANGE("Journal Template Name","Journal Template Name");
                                         EFTExport.SETRANGE("Journal Batch Name","Journal Batch Name");
                                         EFTExport.SETRANGE("Line No.","Line No.");
                                         EFTExport.SETRANGE("Sequence No.","Sequence No.");
                                         IF EFTExport.FINDFIRST THEN
                                           EFTExport.DELETE;
                                       UNTIL NEXT = 0;
                                     UpdateSubForm;
                                   END ELSE
                                     MESSAGE(NoLineMsg);
                                 END;
                               END;
                                }
      { 1020012 ;1   ;Action    ;
                      Name=GenerateEFTFile;
                      ShortCutKey=Ctrl+G;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Generate EFT Files;
                                 ESM=Generar archivos EFT;
                                 FRC=G‚n‚rer des fichiers EFT;
                                 ENC=Generate EFT Files];
                      ToolTipML=[ENU=Export payments on journal lines that are set to electronic payment to a file prior to transmitting the file to your bank.;
                                 ESM=Permite exportar a un archivo los pagos de las l¡neas del diario establecidas para pago electr¢nico, antes de transmitir el archivo al banco.;
                                 FRC=Exportez les paiements des lignes journal … effectuer ‚lectroniquement dans un fichier avant de transmettre ce fichier … votre banque.;
                                 ENC=Export payments on journal lines that are set to electronic payment to a file prior to transmitting the file to your bank.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportFile;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EFTExportWorkset@1020000 : Record 10811;
                                 GenerateEFT@1020001 : Codeunit 10098;
                               BEGIN
                                 CurrPage.GenerateEFTFileLines.PAGE.GetColumns(EFTExportWorkset);
                                 IF EFTExportWorkset.FINDFIRST THEN
                                   GenerateEFT.ProcessAndGenerateEFTFile(BankAccountNo,SettlementDate,EFTExportWorkset,EFTValues);
                                 UpdateSubForm;
                               END;
                                }
      { 1020006 ;1   ;Action    ;
                      Name=Mark All;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=Mark All;
                                 ESM=Marcar todo;
                                 FRC=Marquer tout;
                                 ENC=Mark All];
                      ToolTipML=[ENU=Select all lines to be generated.;
                                 ESM=Permite seleccionar todas las l¡neas que se van a generar.;
                                 FRC=S‚lectionnez toutes les lignes … g‚n‚rer.;
                                 ENC=Select all lines to be generated.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Apply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.GenerateEFTFileLines.PAGE.MarkUnmarkInclude(TRUE,BankAccountNo);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1020007 ;1   ;Action    ;
                      Name=Unmark All;
                      ShortCutKey=Ctrl+U;
                      CaptionML=[ENU=Unmark All;
                                 ESM=Desmarcar todo;
                                 FRC=Supprimer toutes les marques;
                                 ENC=Unmark All];
                      ToolTipML=[ENU=View a trial balance with amounts shown in separate columns for each time period.;
                                 ESM=Permite ver un balance de comprobaci¢n, donde los importes aparecen en columnas independientes para cada per¡odo.;
                                 FRC=Affichez une balance de v‚rification avec les montants affich‚s dans des colonnes distinctes pour chaque p‚riode.;
                                 ENC=View a trial balance with amounts shown in separate columns for each time period.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnApply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.GenerateEFTFileLines.PAGE.MarkUnmarkInclude(FALSE,BankAccountNo);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1020000; ;Container ;
                Name=General;
                ContainerType=ContentArea }

    { 1020003;1;Field     ;
                Name=Bank Account;
                CaptionML=[ENU=Bank Account;
                           ESM=Cuenta bancaria;
                           FRC=Compte bancaire;
                           ENC=Bank Account];
                ToolTipML=[ENU=Specifies the number of the bank account.;
                           ESM=Especifica el n£mero de cuenta bancaria.;
                           FRC=Sp‚cifie le num‚ro du compte bancaire.;
                           ENC=Specifies the number of the bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccountNo;
                TableRelation="Bank Account";
                OnValidate=BEGIN
                             BankAccount.SETRANGE("No.",BankAccountNo);
                             IF BankAccount.FINDFIRST THEN BEGIN
                               BankAccountDescription := BankAccount.Name;
                               IF (BankAccount."Export Format" = 0) OR (BankAccount."Export Format" = BankAccount."Export Format"::Other) THEN
                                 MESSAGE(NotSetupMsg);
                             END;
                             UpdateSubForm;
                           END;
                            }

    { 1020002;1;Field     ;
                Name=BankAccountDescription;
                CaptionML=[ENU=Description;
                           ESM=Descripci¢n;
                           FRC=Description;
                           ENC=Description];
                ToolTipML=[ENU=Specifies the name of the bank.;
                           ESM=Especifica el nombre del banco.;
                           FRC=Sp‚cifie le nom de la banque.;
                           ENC=Specifies the name of the bank.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccountDescription;
                Editable=FALSE }

    { 1020001;1;Field     ;
                Name=SettlementDate;
                CaptionML=[ENU=Settlement Date;
                           ESM=Fecha liquidaci¢n;
                           FRC=Date du rŠglement;
                           ENC=Settlement Date];
                ToolTipML=[ENU=Specifies the settlement date for the electronic funds transfer.;
                           ESM=Especifica la fecha de liquidaci¢n para la transferencia electr¢nica de fondos.;
                           FRC=Sp‚cifie la date de rŠglement pour le transfert de fonds ‚lectronique.;
                           ENC=Specifies the settlement date for the electronic funds transfer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=SettlementDate }

    { 1020004;1;Part      ;
                Name=GenerateEFTFileLines;
                CaptionML=[ENU=Lines;
                           ESM=L¡neas;
                           FRC=Lignes;
                           ENC=Lines];
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page10811;
                PartType=Page }

  }
  CODE
  {
    VAR
      BankAccount@1020008 : Record 270;
      EFTValues@1020007 : Codeunit 10340;
      BankAccountNo@1020006 : Code[20];
      BankAccountDescription@1020005 : Text[50];
      SettlementDate@1020002 : Date;
      BankAccountNoFilter@1020003 : Code[20];
      DeleteQst@1020000 : TextConst 'ENU=Deleting these marked payments will remove them from the EFT file, do you want to continue?;ESM=Si elimina estos pagos marcados, se quitar n del archivo EFT. ¨Desea continuar?;FRC=La suppression de ces paiements marqu‚s va les supprimer du fichier EFT, voulez-vous continuer?;ENC=Deleting these marked payments will remove them from the EFT file, do you want to continue?';
      NoLineMsg@1020001 : TextConst 'ENU=There are no lines selected to delete.;ESM=No hay ninguna l¡nea seleccionada para eliminarla.;FRC=Vous n''avez s‚lectionn‚ aucune ligne … supprimer.;ENC=There are no lines selected to delete.';
      NotSetupMsg@1020004 : TextConst 'ENU=This bank account is not setup for EFT payments.;ESM=Esta cuenta bancaria no est  configurada para pagos EFT.;FRC=Ce compte bancaire n''est pas configur‚ pour les paiements EFT.;ENC=This bank account is not setup for EFT payments.';

    LOCAL PROCEDURE UpdateSubForm@1();
    BEGIN
      CurrPage.GenerateEFTFileLines.PAGE.Set(BankAccountNo);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetBalanceAccount@1020003(BankAccountNumber@1020000 : Code[20]);
    BEGIN
      BankAccountNoFilter := BankAccountNumber;
    END;

    BEGIN
    END.
  }
}

