OBJECT Page 5099 Tasks
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Tasks;
               ESM=Tareas;
               FRC=TÉches;
               ENC=Tasks];
    ApplicationArea=#Basic,#Suite;
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5102;
    DataCaptionExpr=FORMAT(SELECTSTR(OutputOption + 1,Text001));
    PageType=Card;
    UsageCategory=Tasks;
    OnOpenPage=BEGIN
                 CurrSetLength := 32;
                 CreateCaptionSet(SetWanted::Initial);
               END;

    OnFindRecord=BEGIN
                   EXIT(TRUE);
                 END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 77      ;1   ;Action    ;
                      Name=ShowMatrix;
                      CaptionML=[ENU=&Show Matrix;
                                 ESM=&Mostrar matriz;
                                 FRC=&Afficher matrice;
                                 ENC=&Show Matrix];
                      ToolTipML=[ENU=Show tasks in a matrix.;
                                 ESM=Permite mostrar las tareas en una matriz.;
                                 FRC=Affichez les tÉches dans une matrice.;
                                 ENC=Show tasks in a matrix.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ShowMatrix;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MatrixForm@1124 : Page 9255;
                               BEGIN
                                 CLEAR(MatrixForm);
                                 MatrixForm.Load(MatrixColumnCaptions,MatrixRecords,TableOption,ColumnDateFilters,OutputOption,FilterSalesPerson,
                                   FilterTeam,FilterCampaign,FilterContact,StatusFilter,IncludeClosed,PriorityFilter);
                                 MatrixForm.RUNMODAL;
                               END;
                                }
      { 3       ;1   ;Action    ;
                      CaptionML=[ENU=Previous Set;
                                 ESM=Conjunto anterior;
                                 FRC=Jeu prÇcÇdent;
                                 ENC=Previous Set];
                      ToolTipML=[ENU=Go to the previous set of data.;
                                 ESM=Permite desplazarse al conjunto de datos anterior.;
                                 FRC=Allez Ö l'ensemble de donnÇes prÇcÇdent.;
                                 ENC=Go to the previous set of data.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateCaptionSet(SetWanted::Previous);
                               END;
                                }
      { 2       ;1   ;Action    ;
                      CaptionML=[ENU=Next Set;
                                 ESM=Conjunto siguiente;
                                 FRC=Jeu suivant;
                                 ENC=Next Set];
                      ToolTipML=[ENU=Go to the next set of data.;
                                 ESM=Permite desplazarse al conjunto de datos siguiente.;
                                 FRC=Allez Ö l'ensemble de donnÇes suivant.;
                                 ENC=Go to the next set of data.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateCaptionSet(SetWanted::Next);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 6   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=GÇnÇral;
                           ENC=General] }

    { 30  ;2   ;Field     ;
                CaptionML=[ENU=Show as Lines;
                           ESM=Muestra como l°neas;
                           FRC=Afficher lignes;
                           ENC=Show as Lines];
                ToolTipML=[ENU=Specifies which values you want to show as lines in the window. This allows you to see the same matrix window from various perspectives, especially when you use both the Show as Lines field and the Show as Columns field.;
                           ESM=Especifica los valores que desea mostrar como l°neas en la ventana. Esto le permite ver la misma ventana de la matriz desde distintas perspectivas, especialmente cuando usa el campo Muestra como l°neas y el campo Muestra como columnas.;
                           FRC=SpÇcifie les valeurs Ö afficher en tant que lignes dans la fenàtre. Cela vous permet d'afficher la màme fenàtre de matrice de diffÇrentes faáons, en particulier si vous utilisez Ö la fois le champ Afficher lignes et le champ Afficher colonnes.;
                           ENC=Specifies which values you want to show as lines in the window. This allows you to see the same matrix window from various perspectives, especially when you use both the Show as Lines field and the Show as Columns field.];
                OptionCaptionML=[ENU=Salesperson,Team,Campaign,Contact;
                                 ESM=Vendedor,Equipo,Campa§a,Contacto;
                                 FRC=Vendeur,êquipe,Promotion,Contact;
                                 ENC=Salesperson,Team,Campaign,Contact];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=TableOption }

    { 25  ;2   ;Field     ;
                CaptionML=[ENU=Show;
                           ESM=Muestra;
                           FRC=Afficher;
                           ENC=Show];
                ToolTipML=[ENU=Specifies if the selected value is shown in the window.;
                           ESM=Especifica si el valor seleccionado se muestra en la ventana.;
                           FRC=SpÇcifie si la valeur sÇlectionnÇe est affichÇe dans la fenàtre.;
                           ENC=Specifies if the selected value is shown in the window.];
                OptionCaptionML=[ENU=No. of Tasks,Contact No.;
                                 ESM=Nß de tareas,Nß contacto;
                                 FRC=Nbre de tÉches,N¯ contact;
                                 ENC=No. of Tasks,Contact No.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=OutputOption }

    { 1907524401;1;Group  ;
                CaptionML=[ENU=Filters;
                           ESM=Filtros;
                           FRC=Filtres;
                           ENC=Filters] }

    { 1   ;2   ;Field     ;
                CaptionML=[ENU=Salesperson Filter;
                           ESM=Filtro vendedor;
                           FRC=Filtre de reprÇsentant;
                           ENC=Salesperson Filter];
                ToolTipML=[ENU=Specifies which salespeople will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ vendedores se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les reprÇsentants Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies which salespeople will be included in the Tasks matrix view.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=FilterSalesPerson;
                TableRelation=Salesperson/Purchaser }

    { 29  ;2   ;Field     ;
                CaptionML=[ENU=Team Filter;
                           ESM=Filtro equipo;
                           FRC=Filtre Çquipe;
                           ENC=Team Filter];
                ToolTipML=[ENU=Specifies which teams will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ equipos se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les Çquipes Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies which teams will be included in the Tasks matrix view.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=FilterTeam;
                TableRelation=Team }

    { 20  ;2   ;Field     ;
                CaptionML=[ENU=Campaign Filter;
                           ESM=Filtro campa§a;
                           FRC=Filtre promotion;
                           ENC=Campaign Filter];
                ToolTipML=[ENU=Specifies which campaigns will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ campa§as se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les promotions Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies which campaigns will be included in the Tasks matrix view.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=FilterCampaign;
                TableRelation=Campaign }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Contact Company No. Filter;
                           ESM=Filtro nß empresa contacto;
                           FRC=Filtre n¯ compagnie contact;
                           ENC=Contact Company No. Filter];
                ToolTipML=[ENU=Specifies which contacts will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ contactos se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les contacts Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies which contacts will be included in the Tasks matrix view.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=FilterContact;
                TableRelation=Contact WHERE (Type=CONST(Company)) }

    { 7   ;2   ;Field     ;
                CaptionML=[ENU=Status Filter;
                           ESM=Filtro estado;
                           FRC=Filtre Çtat;
                           ENC=Status Filter];
                ToolTipML=[ENU=Specifies what tasks statuses will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ estados de tareas se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les Çtats de tÉches Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies what tasks statuses will be included in the Tasks matrix view.];
                OptionCaptionML=[ENU=" ,Not Started,In Progress,Completed,Waiting,Postponed";
                                 ESM=" ,No iniciado,En progreso,Completado,Esperando,Aplazado";
                                 FRC=" ,Non dÇmarrÇ,En cours,TerminÇ,En attente,ReportÇ";
                                 ENC=" ,Not Started,In Progress,Completed,Waiting,Postponed"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=StatusFilter }

    { 39  ;2   ;Field     ;
                CaptionML=[ENU=Include Closed Tasks;
                           ESM=Incluye tareas cerradas;
                           FRC=Inclure tÉches terminÇes;
                           ENC=Include Closed Tasks];
                ToolTipML=[ENU=Specifies if closed tasks will be included in the Tasks matrix view.;
                           ESM=Especifica si las tarea cerradas se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie si les tÉches terminÇes seront incluses dans la vue Matrice des tÉches.;
                           ENC=Specifies if closed tasks will be included in the Tasks matrix view.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=IncludeClosed }

    { 17  ;2   ;Field     ;
                CaptionML=[ENU=Priority Filter;
                           ESM=Filtro prioridad;
                           FRC=Filtre prioritÇ;
                           ENC=Priority Filter];
                ToolTipML=[ENU=Specifies which tasks priorities will be included in the Tasks matrix view.;
                           ESM=Especifica quÇ prioridades de tareas se incluir†n en la vista de matriz de tareas.;
                           FRC=SpÇcifie les prioritÇs de tÉches Ö inclure dans la vue Matrice des tÉches.;
                           ENC=Specifies which tasks priorities will be included in the Tasks matrix view.];
                OptionCaptionML=[ENU=" ,Low,Normal,High";
                                 ESM=" ,Baja,Normal,Alta";
                                 FRC=" ,Faible,Normal,Haut";
                                 ENC=" ,Low,Normal,High"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=PriorityFilter }

    { 1906098301;1;Group  ;
                CaptionML=[ENU=Matrix Options;
                           ESM=Opciones matriz;
                           FRC=Options de matrice;
                           ENC=Matrix Options] }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           ESM=Ver por;
                           FRC=Afficher par;
                           ENC=View by];
                ToolTipML=[ENU=Specifies by which period amounts are displayed.;
                           ESM=Especifica para quÇ periodos se muestran los importes.;
                           FRC=Indique selon quelle pÇriodicitÇ les montants sont affichÇs.;
                           ENC=Specifies by which period amounts are displayed.];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 ESM=D°a,Semana,Mes,Trimestre,A§o,Periodo contable;
                                 FRC=Jour,Semaine,Mois,Trimestre,AnnÇe,PÇriode comptable;
                                 ENC=Day,Week,Month,Quarter,Year,Accounting Period];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             CreateCaptionSet(SetWanted::Initial);
                           END;
                            }

    { 4   ;2   ;Field     ;
                CaptionML=[ENU=Column Set;
                           ESM=Conjunto de columnas;
                           FRC=Jeu de colonnes;
                           ENC=Column Set];
                ToolTipML=[ENU=Specifies the range of values that are displayed in the matrix window, for example, the total period. To change the contents of the field, choose Next Set or Previous Set.;
                           ESM=Especifica el rango de valores que se muestran en la ventana de la matriz, por ejemplo, el periodo total. Para modificar el contenido de este campo, elija la opci¢n Conjunto siguiente o Conjunto anterior.;
                           FRC=SpÇcifie la plage de valeurs affichÇe dans la fenàtre de matrice (par exemple, total de la pÇriode). Pour modifier le contenu de ce champ, choisissez Jeu prÇcÇdent ou Jeu suivant.;
                           ENC=Specifies the range of values that are displayed in the matrix window, for example, the total period. To change the contents of the field, choose Next Set or Previous Set.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=ColumnSet;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      MatrixRecords@1125 : ARRAY [32] OF Record 2000000007;
      MatrixMgt@1000 : Codeunit 9200;
      PeriodType@1006 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      OutputOption@1007 : 'No. of Tasks,Contact No.';
      TableOption@1008 : 'Salesperson,Team,Campaign,Contact';
      StatusFilter@1009 : ' ,Not Started,In Progress,Completed,Waiting,Postponed';
      PriorityFilter@1010 : ' ,Low,Normal,High';
      IncludeClosed@1011 : Boolean;
      FilterSalesPerson@1012 : Code[250];
      FilterTeam@1013 : Code[250];
      FilterCampaign@1014 : Code[250];
      FilterContact@1015 : Code[250];
      Text001@1016 : TextConst 'ENU=No. of Tasks,Contact No.;ESM=Nß de tareas,Nß contacto;FRC=Nbre de tÉches,N¯ contact;ENC=No. of Tasks,Contact No.';
      ColumnDateFilters@1026 : ARRAY [32] OF Text[50];
      MatrixColumnCaptions@1035 : ARRAY [32] OF Text[1024];
      ColumnSet@1034 : Text[1024];
      SetWanted@1033 : 'Initial,Previous,Same,Next';
      PKFirstRecInCurrSet@1032 : Text[100];
      CurrSetLength@1031 : Integer;

    LOCAL PROCEDURE CreateCaptionSet@16(SetWanted@1005 : 'Initial,Previous,Same,Next');
    BEGIN
      MatrixMgt.GeneratePeriodMatrixData(SetWanted,32,FALSE,PeriodType,'',
        PKFirstRecInCurrSet,MatrixColumnCaptions,ColumnSet,CurrSetLength,MatrixRecords);
    END;

    BEGIN
    END.
  }
}

