OBJECT Page 5050 Contact Card
{
  OBJECT-PROPERTIES
  {
    Date=11/27/18;
    Time=11:10:51 PM;
    Version List=;
  }
  PROPERTIES
  {
    CaptionML=ENU=Contact Card;
    SourceTable=Table5050;
    PageType=ListPlus;
    PromotedActionCategoriesML=ENU=New,Process,Report,Related Information;
    OnInit=BEGIN
             OrganizationalLevelCodeEnable := TRUE;
             CompanyNameEnable := TRUE;
             VATRegistrationNoEnable := TRUE;
             CurrencyCodeEnable := TRUE;
             ActionVisible := CURRENTCLIENTTYPE = CLIENTTYPE::Windows;
           END;

    OnOpenPage=VAR
                 OfficeManagement@1002 : Codeunit 1630;
               BEGIN
                 IsOfficeAddin := OfficeManagement.IsAvailable;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 SetNoFieldVisible;
                 SetParentalConsentReceivedEnable;
               END;

    OnNewRecord=VAR
                  Contact@1001 : Record 5050;
                BEGIN
                  IF GETFILTER("Company No.") <> '' THEN BEGIN
                    "Company No." := GETRANGEMAX("Company No.");
                    Type := Type::Person;
                    Contact.GET("Company No.");
                    InheritCompanyToPersonData(Contact);
                  END;
                END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1001 : Codeunit 5331;
                         BEGIN
                           IF CRMIntegrationEnabled THEN BEGIN
                             CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                             IF "No." <> xRec."No." THEN
                               CRMIntegrationManagement.SendResultNotification(Rec);
                           END;

                           xRec := Rec;
                           EnableFields;

                           IF Type = Type::Person THEN
                             IntegrationFindCustomerNo
                           ELSE
                             IntegrationCustomerNo := '';
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 76      ;1   ;ActionGroup;
                      CaptionML=ENU=C&ontact;
                      Image=ContactPerson }
      { 82      ;2   ;ActionGroup;
                      CaptionML=ENU=Comp&any;
                      Enabled=CompanyGroupEnabled;
                      Image=Company }
      { 85      ;3   ;Action    ;
                      CaptionML=ENU=Business Relations;
                      ToolTipML=ENU=View or edit the contact's business relations, such as customers, vendors, banks, lawyers, consultants, competitors, and so on.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=BusinessRelation;
                      OnAction=VAR
                                 ContactBusinessRelationRec@1000 : Record 5054;
                               BEGIN
                                 TESTFIELD(Type,Type::Company);
                                 ContactBusinessRelationRec.SETRANGE("Contact No.","Company No.");
                                 PAGE.RUN(PAGE::"Contact Business Relations",ContactBusinessRelationRec);
                               END;
                                }
      { 83      ;3   ;Action    ;
                      CaptionML=ENU=Industry Groups;
                      ToolTipML=ENU=View or edit the industry groups, such as Retail or Automobile, that the contact belongs to.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=IndustryGroups;
                      OnAction=VAR
                                 ContactIndustryGroupRec@1001 : Record 5058;
                               BEGIN
                                 TESTFIELD(Type,Type::Company);
                                 ContactIndustryGroupRec.SETRANGE("Contact No.","Company No.");
                                 PAGE.RUN(PAGE::"Contact Industry Groups",ContactIndustryGroupRec);
                               END;
                                }
      { 84      ;3   ;Action    ;
                      CaptionML=ENU=Web Sources;
                      ToolTipML=ENU=View a list of the web sites with information about the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=Web;
                      OnAction=VAR
                                 ContactWebSourceRec@1001 : Record 5060;
                               BEGIN
                                 TESTFIELD(Type,Type::Company);
                                 ContactWebSourceRec.SETRANGE("Contact No.","Company No.");
                                 PAGE.RUN(PAGE::"Contact Web Sources",ContactWebSourceRec);
                               END;
                                }
      { 80      ;2   ;ActionGroup;
                      CaptionML=ENU=P&erson;
                      Enabled=PersonGroupEnabled;
                      Image=User }
      { 81      ;3   ;Action    ;
                      CaptionML=ENU=Job Responsibilities;
                      ToolTipML=ENU=View or edit the contact's job responsibilities.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 87      ;2   ;Action    ;
                      CaptionML=ENU=Pro&files;
                      ToolTipML=ENU=Open the Profile Questionnaires window.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 89      ;2   ;Action    ;
                      CaptionML=ENU=&Picture;
                      ToolTipML=ENU=View or add a picture of the contact person or, for example, the company's logo.;
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      RunObject=Page 5104;
                      RunPageLink=No.=FIELD(No.);
                      Visible=ActionVisible;
                      Image=Picture }
      { 90      ;2   ;Action    ;
                      CaptionML=ENU=Co&mments;
                      ToolTipML=ENU=View or add comments for the record.;
                      ApplicationArea=#Comments;
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 91      ;2   ;ActionGroup;
                      CaptionML=ENU=Alternati&ve Address;
                      Image=Addresses }
      { 92      ;3   ;Action    ;
                      CaptionML=ENU=Card;
                      ToolTipML=ENU=View or change detailed information about the contact.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5057;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 93      ;3   ;Action    ;
                      CaptionML=ENU=Date Ranges;
                      ToolTipML=ENU=Specify date ranges that apply to the contact's alternate address.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5059;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DateRange }
      { 23      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=ENU=Dynamics 365 for Sales;
                      Visible=CRMIntegrationEnabled;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '') }
      { 21      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=ENU=Contact;
                      ToolTipML=ENU=Open the coupled Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=ENU=Synchronize;
                      ToolTipML=ENU=Send or get updated data to or from Dynamics 365 for Sales.;
                      ApplicationArea=#Suite;
                      Image=Refresh;
                      OnAction=VAR
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.UpdateOneNow(RECORDID);
                               END;
                                }
      { 27      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling];
                      ToolTipML=ENU=Create, change, or delete a coupling between the Business Central record and a Dynamics 365 for Sales record.;
                      Image=LinkAccount }
      { 25      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=ENU=Set Up Coupling;
                      ToolTipML=ENU=Create or modify the coupling to a Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=ENU=Delete Coupling;
                      ToolTipML=ENU=Delete the coupling to a Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Name=ShowLog;
                      CaptionML=ENU=Synchronization Log;
                      ToolTipML=ENU=View integration synchronization jobs for the contact table.;
                      ApplicationArea=#Suite;
                      Image=Log;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowLog(RECORDID);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=ENU=Related Information;
                      Image=Users }
      { 79      ;2   ;Action    ;
                      CaptionML=ENU=Relate&d Contacts;
                      ToolTipML=ENU=View a list of all contacts.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5052;
                      RunPageLink=Company No.=FIELD(Company No.);
                      Image=Users }
      { 100     ;2   ;Action    ;
                      CaptionML=ENU=Segmen&ts;
                      ToolTipML=ENU=View the segments that are related to the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5150;
                      RunPageView=SORTING(Contact No.,Segment No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 86      ;2   ;Action    ;
                      CaptionML=ENU=Mailing &Groups;
                      ToolTipML=ENU=View or edit the mailing groups that the contact is assigned to, for example, for sending price lists or Christmas cards.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5064;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DistributionGroup }
      { 99      ;2   ;Action    ;
                      CaptionML=ENU=C&ustomer/Vendor/Bank Acc.;
                      ToolTipML=ENU=View the related customer, vendor, or bank account that is associated with the current record.;
                      ApplicationArea=#Basic,#Suite;
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=ENU=Online Map;
                      ToolTipML=ENU=View the address on an online map.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Map;
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=Office Customer/Vendor;
                      CaptionML=ENU=Customer/Vendor;
                      ToolTipML=ENU=View the related customer, vendor, or bank account.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=IsOfficeAddin;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      CaptionML=ENU=Tasks;
                      Image=Task }
      { 96      ;2   ;Action    ;
                      CaptionML=ENU=T&asks;
                      ToolTipML=ENU=View all marketing tasks that involve the contact person.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5096;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee);
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      CaptionML=ENU=Oppo&rtunities;
                      ToolTipML=ENU=View the sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5123;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=OpportunityList }
      { 42      ;2   ;Action    ;
                      CaptionML=ENU=Postponed &Interactions;
                      ToolTipML=ENU=View postponed interactions for the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5082;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Visible=ActionVisible;
                      Image=PostponedInteractions }
      { 9       ;1   ;ActionGroup;
                      CaptionML=ENU=Documents;
                      Image=Documents }
      { 116     ;2   ;Action    ;
                      Name=SalesQuotes;
                      CaptionML=ENU=Sales &Quotes;
                      ToolTipML=ENU=View sales quotes that exist for the contact.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9300;
                      RunPageView=SORTING(Document Type,Sell-to Contact No.);
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 11      ;1   ;ActionGroup;
                      CaptionML=ENU=History;
                      Image=History }
      { 95      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Interaction Log E&ntries;
                      ToolTipML=ENU=View a list of the interactions that you have logged, for example, when you create an interaction, print a cover sheet, a sales order, and so on.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5076;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=InteractionLog }
      { 88      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      ToolTipML=ENU=View statistical information, such as the value of posted entries, for the record.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5053;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 75      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 102     ;2   ;Action    ;
                      CaptionML=ENU=Launch &Web Source;
                      ToolTipML=ENU=Search for information about the contact online.;
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ActionVisible;
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 103     ;2   ;Action    ;
                      CaptionML=ENU=Print Cover &Sheet;
                      ToolTipML=ENU=View cover sheets to send to your contact.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=PrintCover;
                      OnAction=VAR
                                 Cont@1001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 105     ;2   ;ActionGroup;
                      CaptionML=ENU=Create as;
                      Image=CustomerContact }
      { 106     ;3   ;Action    ;
                      Name=CreateCustomer;
                      CaptionML=ENU=Customer;
                      ToolTipML=ENU=Create the contact as a customer.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 107     ;3   ;Action    ;
                      Name=CreateVendor;
                      CaptionML=ENU=Vendor;
                      ToolTipML=ENU=Create the contact as a vendor.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      Name=CreateBank;
                      AccessByPermission=TableData 270=R;
                      CaptionML=ENU=Bank;
                      ToolTipML=ENU=Create the contact as a bank.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 109     ;2   ;ActionGroup;
                      CaptionML=ENU=Link with existing;
                      Visible=ActionVisible;
                      Image=Links }
      { 110     ;3   ;Action    ;
                      CaptionML=ENU=Customer;
                      ToolTipML=ENU=Link the contact to an existing customer.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 111     ;3   ;Action    ;
                      CaptionML=ENU=Vendor;
                      ToolTipML=ENU=Link the contact to an existing vendor.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 112     ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=ENU=Bank;
                      ToolTipML=ENU=Link the contact to an existing bank.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 153     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Apply Template;
                      ToolTipML=ENU=Select a defined template to quickly create a new record.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ConfigTemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 ConfigTemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=CreateAsCustomer;
                      CaptionML=ENU=Create as Customer;
                      ToolTipML=ENU=Create a new customer based on this contact.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=IsOfficeAddin;
                      Image=Customer;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=CreateAsVendor;
                      CaptionML=ENU=Create as Vendor;
                      ToolTipML=ENU=Create a new vendor based on this contact.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=IsOfficeAddin;
                      Image=Vendor;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 77      ;1   ;Action    ;
                      AccessByPermission=TableData 5062=R;
                      CaptionML=ENU=Create &Interaction;
                      ToolTipML=ENU=Create an interaction with a specified contact.;
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 6       ;1   ;Action    ;
                      CaptionML=ENU=Create Opportunity;
                      ToolTipML=ENU=Register a sales opportunity for the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5124;
                      RunPageLink=Contact No.=FIELD(No.),
                                  Contact Company No.=FIELD(Company No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewOpportunity;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      Name=ContactCoverSheet;
                      CaptionML=ENU=Contact Cover Sheet;
                      ToolTipML=ENU=Print or save cover sheets to send to one or more of your contacts.;
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 Contact@1001 : Record 5050;
                                 ContactCoverSheetReportID@1000 : Integer;
                               BEGIN
                                 Contact := Rec;
                                 Contact.SETRECFILTER;
                                 ContactCoverSheetReportID := REPORT::"Contact Cover Sheet";
                                 OnBeforePrintContactCoverSheet(ContactCoverSheetReportID);
                                 REPORT.RUN(ContactCoverSheetReportID,TRUE,FALSE,Contact);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=NoFieldVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 10  ;2   ;Field     ;
                AssistEdit=Yes;
                ToolTipML=ENU=Specifies the name of the contact. If the contact is a person, you can click the field to see the Name Details window.;
                ApplicationArea=#All;
                SourceExpr=Name;
                Importance=Promoted;
                OnAssistEdit=VAR
                               Contact@1000 : Record 5050;
                             BEGIN
                               IF "No." = '' THEN BEGIN
                                 INSERT(TRUE);
                                 COMMIT;
                               END;
                               Contact := Rec;
                               Contact.SETRECFILTER;
                               IF Contact.Type = Contact.Type::Person THEN BEGIN
                                 CLEAR(NameDetails);
                                 NameDetails.SETTABLEVIEW(Contact);
                                 NameDetails.SETRECORD(Contact);
                                 NameDetails.RUNMODAL;
                               END ELSE BEGIN
                                 CLEAR(CompanyDetails);
                                 CompanyDetails.SETTABLEVIEW(Contact);
                                 CompanyDetails.SETRECORD(Contact);
                                 CompanyDetails.RUNMODAL;
                               END;
                               Rec := Contact;
                               CurrPage.UPDATE(FALSE);
                             END;

                ShowMandatory=TRUE }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the type of contact, either company or person.;
                ApplicationArea=#All;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 44  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number for the contact's company.;
                ApplicationArea=#All;
                SourceExpr="Company No.";
                Importance=Additional }

    { 8   ;2   ;Field     ;
                AssistEdit=Yes;
                ToolTipML=ENU=Specifies the name of the company. If the contact is a person, Specifies the name of the company for which this contact works. This field is not editable.;
                ApplicationArea=#All;
                SourceExpr="Company Name";
                Importance=Promoted;
                Enabled=CompanyNameEnable;
                OnAssistEdit=BEGIN
                               LookupCompany;
                             END;
                              }

    { 125 ;2   ;Field     ;
                CaptionML=ENU=Integration Customer No.;
                ToolTipML=ENU=Specifies the number of a customer that is integrated through Dynamics 365 for Sales.;
                ApplicationArea=#All;
                SourceExpr=IntegrationCustomerNo;
                Visible=FALSE;
                OnValidate=VAR
                             Customer@1000 : Record 18;
                             ContactBusinessRelation@1001 : Record 5054;
                           BEGIN
                             IF NOT (IntegrationCustomerNo = '') THEN BEGIN
                               Customer.GET(IntegrationCustomerNo);
                               ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                               ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
                               ContactBusinessRelation.SETRANGE("No.",Customer."No.");
                               IF ContactBusinessRelation.FINDFIRST THEN
                                 VALIDATE("Company No.",ContactBusinessRelation."Contact No.");
                             END ELSE
                               VALIDATE("Company No.",'');
                           END;
                            }

    { 20  ;2   ;Field     ;
                ToolTipML=ENU=Specifies an alternate name that you can use to search for the record in question when you cannot remember the value in the Name field.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Search Name";
                Importance=Additional }

    { 24  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the code of the salesperson who normally handles this contact.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Salesperson Code";
                Importance=Additional }

    { 117 ;2   ;Field     ;
                ToolTipML=ENU=Specifies the salutation code that will be used when you interact with the contact. The salutation code is only used in Word documents. To see a list of the salutation codes already defined, click the field.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Salutation Code";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the organizational code for the contact, for example, top management. This field is valid for persons only.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Organizational Level Code";
                Importance=Additional;
                Enabled=OrganizationalLevelCodeEnable }

    { 26  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the date when the contact card was last modified. This field is not editable.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 28  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the date of the last interaction involving the contact, for example, a received or sent mail, e-mail, or phone call. This field is not editable.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Date of Last Interaction";
                Importance=Additional;
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                              IF InteractionLogEntry.FINDLAST THEN
                                PAGE.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 30  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the date when the contact was last contacted, for example, when you tried to call the contact, with or without success. This field is not editable.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Last Date Attempted";
                Importance=Additional;
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                              IF InteractionLogEntry.FINDLAST THEN
                                PAGE.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 32  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the date of the next task involving the contact.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Next Task Date";
                Importance=Additional }

    { 40  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the contact should be excluded from segments:;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Exclude from Segment";
                Importance=Additional }

    { 195 ;2   ;Field     ;
                ToolTipML=ENU=Specifies whether to limit access to data for the data subject during daily operations. This is useful, for example, when protecting data from changes while it is under privacy review.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Privacy Blocked";
                Importance=Additional }

    { 196 ;2   ;Field     ;
                ToolTipML=ENU=Specifies that the person's age is below the definition of adulthood as recognized by law. Data for minors is blocked until a parent or guardian of the minor provides parental consent. You unblock the data by choosing the Parental Consent Received check box.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Minor;
                Importance=Additional;
                OnValidate=BEGIN
                             SetParentalConsentReceivedEnable;
                           END;
                            }

    { 197 ;2   ;Field     ;
                ToolTipML=ENU=Specifies that a parent or guardian of the minor has provided their consent to allow the minor to use this service. When this check box is selected, data for the minor can be processed.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Parental Consent Received";
                Importance=Additional;
                Enabled=ParentalConsentReceivedEnable }

    { 1902768601;1;Group  ;
                CaptionML=ENU=Communication }

    { 37  ;2   ;Group     ;
                CaptionML=ENU=Address;
                GroupType=Group }

    { 34  ;3   ;Field     ;
                Name=Address;
                ToolTipML=ENU=Specifies the contact's address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Address }

    { 16  ;3   ;Field     ;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Address 2" }

    { 18  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the ZIP Code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 14  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the city where the contact is located.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=City }

    { 1480001;3;Field     ;
                CaptionML=ENU=State;
                ToolTipML=ENU=Specifies the state as a part of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=County }

    { 12  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the country/region of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code" }

    { 43  ;3   ;Field     ;
                Name=ShowMap;
                ToolTipML=ENU=Specifies the contact's address on your preferred map website.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShowMapLbl;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.UPDATE(TRUE);
                              DisplayMap;
                            END;

                ShowCaption=No }

    { 39  ;2   ;Group     ;
                Name=ContactDetails;
                CaptionML=ENU=Contact;
                GroupType=Group }

    { 35  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the contact's phone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No." }

    { 36  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the contact's mobile telephone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Mobile Phone No." }

    { 46  ;3   ;Field     ;
                ExtendedDatatype=E-Mail;
                ToolTipML=ENU=Specifies the email address of the contact.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 38  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the contact's fax number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Fax No.";
                Importance=Additional }

    { 48  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the contact's web site.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Home Page" }

    { 126 ;3   ;Field     ;
                ToolTipML=ENU=Specifies the preferred type of correspondence for the interaction. NOTE: If you use the Web client, you must not select the Hard Copy option because printing is not possible from the web client.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Correspondence Type";
                Importance=Additional }

    { 33  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the language that is used when translating specified text on documents to foreign business partner, such as an item description on an order confirmation.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=ENU=Foreign Trade }

    { 64  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the currency code for the contact.;
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Enabled=CurrencyCodeEnable }

    { 68  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the territory code for the contact.;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Territory Code";
                Importance=Additional }

    { 66  ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=ENU=Specifies the contact's tax registration number. This field is valid for companies only.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Registration No.";
                Importance=Additional;
                Enabled=VATRegistrationNoEnable;
                OnDrillDown=VAR
                              VATRegistrationLogMgt@1000 : Codeunit 249;
                            BEGIN
                            END;
                             }

    { 72  ;1   ;Part      ;
                CaptionML=ENU=Profile Questionnaire;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=Contact No.=FIELD(No.);
                PagePartID=Page5051;
                PartType=Page }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 41  ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page5104;
                Visible=NOT IsOfficeAddin;
                PartType=Page }

    { 31  ;1   ;Part      ;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=No.=FIELD(No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9130;
                PartType=Page }

    { 1900383207;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CRMIntegrationManagement@1011 : Codeunit 5330;
      CompanyDetails@1001 : Page 5054;
      NameDetails@1002 : Page 5055;
      IntegrationCustomerNo@1003 : Code[20];
      CurrencyCodeEnable@19025310 : Boolean INDATASET;
      VATRegistrationNoEnable@19054634 : Boolean INDATASET;
      CompanyNameEnable@19044404 : Boolean INDATASET;
      OrganizationalLevelCodeEnable@19070485 : Boolean INDATASET;
      CompanyGroupEnabled@1004 : Boolean;
      PersonGroupEnabled@1005 : Boolean;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1007 : Boolean;
      IsOfficeAddin@1008 : Boolean;
      ActionVisible@1009 : Boolean;
      ShowMapLbl@1010 : TextConst 'ENU=Show Map';
      NoFieldVisible@1012 : Boolean;
      ParentalConsentReceivedEnable@1013 : Boolean;

    LOCAL PROCEDURE EnableFields@1();
    BEGIN
      CompanyGroupEnabled := Type = Type::Company;
      PersonGroupEnabled := Type = Type::Person;
      CurrencyCodeEnable := Type = Type::Company;
      VATRegistrationNoEnable := Type = Type::Company;
      CompanyNameEnable := Type = Type::Person;
      OrganizationalLevelCodeEnable := Type = Type::Person;
    END;

    LOCAL PROCEDURE IntegrationFindCustomerNo@2();
    VAR
      ContactBusinessRelation@1000 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("Contact No.","Company No.");
      IF ContactBusinessRelation.FINDFIRST THEN BEGIN
        IntegrationCustomerNo := ContactBusinessRelation."No.";
      END ELSE
        IntegrationCustomerNo := '';
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE SetNoFieldVisible@13();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
    BEGIN
      NoFieldVisible := DocumentNoVisibility.ContactNoIsVisible;
    END;

    LOCAL PROCEDURE SetParentalConsentReceivedEnable@20();
    BEGIN
      IF Minor THEN
        ParentalConsentReceivedEnable := TRUE
      ELSE BEGIN
        "Parental Consent Received" := FALSE;
        ParentalConsentReceivedEnable := FALSE;
      END;
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforePrintContactCoverSheet@3(VAR ContactCoverSheetReportID@1000 : Integer);
    BEGIN
    END;

    BEGIN
    END.
  }
}

