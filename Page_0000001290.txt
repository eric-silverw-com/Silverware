OBJECT Page 1290 Payment Reconciliation Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Reconciliation Journal;
               ESM=Diario de conciliaci¢n de pagos;
               FRC=Journal rapprochement paiement;
               ENC=Payment Reconciliation Journal];
    LinksAllowed=No;
    SourceTable=Table274;
    DataCaptionExpr="Bank Account No.";
    DelayedInsert=Yes;
    SourceTableView=WHERE(Statement Type=CONST(Payment Application));
    PageType=Worksheet;
    AutoSplitKey=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Manual Application,Review,Details,View,Page;
                                ESM=Nuevo,Procesar,Informe,Liquidaci¢n manual,Revisar,Detalles,Ver,P gina;
                                FRC=Nouveau,Traiter,Rapport,Application manuelle,R‚vision,D‚tails,Afficher,Page;
                                ENC=New,Process,Report,Manual Application,Review,Details,View,Page];
    OnOpenPage=VAR
                 ServerConfigSettingHandler@1000 : Codeunit 6723;
               BEGIN
                 IsSaasExcelAddinEnabled := ServerConfigSettingHandler.GetIsSaasExcelAddinEnabled;
                 PageClosedByPosting := FALSE;
               END;

    OnAfterGetRecord=VAR
                       PaymentMatchingDetails@1000 : Record 1299;
                     BEGIN
                       MatchDetails := PaymentMatchingDetails.MergeMessages(Rec);

                       GetAppliedPmtData(AppliedPmtEntry,RemainingAmountAfterPosting,StatementToRemAmtDifference,PmtAppliedToTxt);
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine;
                  AppliedPmtEntry.INIT;
                  StatementToRemAmtDifference := 0;
                  RemainingAmountAfterPosting := 0;
                END;

    OnAfterGetCurrRecord=BEGIN
                           IF NOT IsBankAccReconInitialized THEN BEGIN
                             BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                             IsBankAccReconInitialized := TRUE;
                           END;

                           FinanceChargeMemoEnabled := "Account Type" = "Account Type"::Customer;
                           BankAccReconciliation.CALCFIELDS("Total Balance on Bank Account","Total Unposted Applied Amount","Total Transaction Amount",
                             "Total Applied Amount","Total Outstd Bank Transactions","Total Outstd Payments","Total Applied Amount Payments");

                           OutstandingTransactions := BankAccReconciliation."Total Outstd Bank Transactions" -
                             (BankAccReconciliation."Total Applied Amount" - BankAccReconciliation."Total Unposted Applied Amount") +
                             BankAccReconciliation."Total Applied Amount Payments";
                           OutstandingPayments := BankAccReconciliation."Total Outstd Payments" - BankAccReconciliation."Total Applied Amount Payments";

                           UpdateBalanceAfterPostingStyleExpr;

                           TestIfFiltershaveBeenRemovedWithRefreshAndClose;
                         END;

    ActionList=ACTIONS
    {
      { 45      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=Process;
                                 ESM=Procesar;
                                 FRC=Traitement;
                                 ENC=Process] }
      { 22      ;2   ;Action    ;
                      Name=ImportBankTransactions;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Import Bank Transactions;
                                 ESM=&Importar transacciones bancarias;
                                 FRC=&Importer les transactions bancaires;
                                 ENC=&Import Bank Transactions];
                      ToolTipML=[ENU=Import a file for transaction payments that was made from your bank account and apply the payments to the entry. The file name must end in .csv, .txt, asc, or .xml.;
                                 ESM=Permite importar un archivo con los pagos de transacciones que se realizaron desde la cuenta bancaria y liquidar esos pagos en el movimiento. El nombre de archivo debe terminar en .csv, .txt, .asc o .xml.;
                                 FRC=Importez un fichier pour les paiements de transaction r‚alis‚s … partir de votre compte bancaire et affectez les paiements … l'‚criture. Le nom du fichier doit se terminer par .csv, .txt, asc ou .xml.;
                                 ENC=Import a file for transaction payments that was made from your bank account and apply the payments to the entry. The file name must end in .csv, .txt, asc, or .xml.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SubscriberInvoked@1000 : Boolean;
                               BEGIN
                                 OnAfterImportBankTransactions(SubscriberInvoked);
                                 IF NOT SubscriberInvoked THEN BEGIN
                                   BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                   BankAccReconciliation.ImportBankStatement;
                                   IF BankAccReconciliation.FIND THEN;
                                 END;
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=ApplyAutomatically;
                      CaptionML=[ENU=Apply Automatically;
                                 ESM=Liquidar autom ticamente;
                                 FRC=Affecter automatiquement;
                                 ENC=Apply Automatically];
                      ToolTipML=[ENU=Apply payments to their related open entries based on data matches between bank transaction text and entry information.;
                                 ESM=Permite liquidar pagos en los movimientos pendientes relacionados con ellos en funci¢n de las coincidencias de datos entre el texto de las transacciones bancarias y la informaci¢n de los movimientos.;
                                 FRC=Affectez les paiements aux ‚critures ouvertes associ‚es sur la base des correspondances de donn‚es entre le texte de la transaction bancaire et les informations de l'‚criture.;
                                 ENC=Apply payments to their related open entries based on data matches between bank transaction text and entry information.];
                      ApplicationArea=#Basic,#Suite;
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MapAccounts;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 BankAccReconciliation@1000 : Record 273;
                                 AppliedPaymentEntry@1001 : Record 1294;
                                 SubscriberInvoked@1002 : Boolean;
                               BEGIN
                                 AppliedPaymentEntry.SETRANGE("Statement Type","Statement Type");
                                 AppliedPaymentEntry.SETRANGE("Bank Account No.","Bank Account No.");
                                 AppliedPaymentEntry.SETRANGE("Statement No.","Statement No.");

                                 IF AppliedPaymentEntry.COUNT > 0 THEN
                                   IF NOT CONFIRM(RemoveExistingApplicationsQst) THEN
                                     EXIT;

                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 OnAtActionApplyAutomatically(BankAccReconciliation,SubscriberInvoked);
                                 IF NOT SubscriberInvoked THEN
                                   CODEUNIT.RUN(CODEUNIT::"Match Bank Pmt. Appl.",BankAccReconciliation);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Post;
                                 ESM=Registrar;
                                 FRC=Reporter;
                                 ENC=Post];
                      Image=Post }
      { 72      ;3   ;Action    ;
                      Name=TestReport;
                      CaptionML=[ENU=&Test Report;
                                 ESM=&Informe prueba;
                                 FRC=&Tester le rapport;
                                 ENC=&Test Report];
                      ToolTipML=[ENU=Preview the resulting payment reconciliations to see the consequences before you perform the actual posting.;
                                 ESM=Permite obtener una vista previa de las conciliaciones de pagos resultantes para ver las consecuencias antes de proceder al registro real.;
                                 FRC=Affichez les rapprochements paiement r‚sultants pour voir les cons‚quences avant d'effectuer le report effectif.;
                                 ENC=Preview the resulting payment reconciliations to see the consequences before you perform the actual posting.];
                      ApplicationArea=#Basic,#Suite;
                      Image=TestReport;
                      OnAction=VAR
                                 TestReportPrint@1001 : Codeunit 228;
                               BEGIN
                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 TestReportPrint.PrintBankAccRecon(BankAccReconciliation);
                               END;
                                }
      { 35      ;3   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Payments and Reconcile Bank Account;
                                 ESM=Registrar pagos y conciliar banco;
                                 FRC=Reporter les paiements et rapprocher les comptes bancaires;
                                 ENC=Post Payments and Reconcile Bank Account];
                      ToolTipML=[ENU=Reconcile the bank account for payments that you post with the journal and close related ledger entries.;
                                 ESM=Permite conciliar la cuenta bancaria con los pagos que registr¢ mediante el diario y cerrar los movimientos relacionados.;
                                 FRC=Rapprochez le compte bancaire pour les paiements que vous reportez avec le journal et fermez les ‚critures associ‚es.;
                                 ENC=Reconcile the bank account for payments that you post with the journal and close related ledger entries.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostApplication;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 InvokePost(FALSE)
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=PostPaymentsOnly;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Payments Only;
                                 ESM=Registrar solamente pagos;
                                 FRC=Reporter les paiements uniquement;
                                 ENC=Post Payments Only];
                      ToolTipML=[ENU=Post payments but do not close related bank account ledger entries or reconcile the bank account.;
                                 ESM=Permite registrar pagos, pero no cerrar los movimientos de la cuenta bancaria relacionada o conciliar la cuenta bancaria.;
                                 FRC=Reportez les paiements, mais ne fermez pas les ‚critures compte bancaire associ‚es ou rapprochez le compte bancaire.;
                                 ENC=Post payments but do not close related bank account ledger entries or reconcile the bank account.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 InvokePost(TRUE)
                               END;
                                }
      { 42      ;1   ;ActionGroup;
                      CaptionML=[ENU=New Documents;
                                 ESM=Nuevos documentos;
                                 FRC=Nouveaux documents;
                                 ENC=New Documents] }
      { 20      ;2   ;Action    ;
                      Name=FinanceChargeMemo;
                      CaptionML=[ENU=New Finance Charge Memo;
                                 ESM=Nuevo documento inter‚s;
                                 FRC=Nouvelle note de frais financiers;
                                 ENC=New Finance Charge Memo];
                      ToolTipML=[ENU=Define a memo that includes information about the calculated interest on outstanding balances of an account. You can then send the memo in an email to the customer.;
                                 ESM=Permite definir una nota que incluya informaci¢n acerca del inter‚s calculado en funci¢n de los saldos pendientes de una cuenta. Dicha nota se puede enviar por correo electr¢nico al cliente.;
                                 FRC=D‚finissez une note de cr‚dit comprenant des informations concernant l'int‚rˆt calcul‚ sur les soldes ‚chus d'un compte. Vous pouvez ensuite envoyer la note de cr‚dit au client par courriel.;
                                 ENC=Define a memo that includes information about the calculated interest on outstanding balances of an account. You can then send the memo in an email to the customer.];
                      ApplicationArea=#Suite;
                      RunObject=Page 446;
                      RunPageLink=Customer No.=FIELD(Account No.);
                      Enabled=FinanceChargeMemoEnabled;
                      PromotedIsBig=Yes;
                      Image=FinChargeMemo;
                      RunPageMode=Create }
      { 41      ;2   ;Action    ;
                      Name=OpenGenJnl;
                      CaptionML=[ENU=General Journal;
                                 ESM=Diario general;
                                 FRC=Journal g‚n‚ral;
                                 ENC=General Journal];
                      ToolTipML=[ENU=Open the general journal, for example, to record or post a payment that has no related document.;
                                 ESM=Permite abrir el diario general, por ejemplo, para registrar un pago que no tiene documentos relacionados.;
                                 FRC=Ouvrez le journal g‚n‚ral, par exemple pour enregistrer ou reporter un paiement qui n'a aucun document associ‚.;
                                 ENC=Open the general journal, for example, to record or post a payment that has no related document.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 39;
                      PromotedIsBig=Yes;
                      Image=GLRegisters }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Payment Journal;
                                 ESM=Diario de pagos;
                                 FRC=Journal des paiements;
                                 ENC=Payment Journal];
                      ToolTipML=[ENU=View or edit the payment journal where you can register payments to vendors.;
                                 ESM=Permite ver o editar el diario de pagos en el que se pueden registrar los pagos a proveedores.;
                                 FRC=Affichez ou modifiez le journal paiement o— vous pouvez enregistrer les paiements aux fournisseurs.;
                                 ENC=View or edit the payment journal where you can register payments to vendors.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 256;
                      PromotedIsBig=Yes;
                      Image=PaymentJournal }
      { 63      ;1   ;ActionGroup;
                      CaptionML=[ENU=Manual Application;
                                 ESM=Liquidaci¢n manual;
                                 FRC=Application manuelle;
                                 ENC=Manual Application] }
      { 59      ;2   ;Action    ;
                      Name=TransferDiffToAccount;
                      CaptionML=[ENU=Transfer Difference to Account;
                                 ESM=Transferir diferencia a cuenta;
                                 FRC=Transf‚rer la diff‚rence vers un compte;
                                 ENC=Transfer Difference to Account];
                      ToolTipML=[ENU=Specify the balancing account to which you want a non-applicable payment amount on a payment reconciliation journal line to be posted when you post the journal.;
                                 ESM=Permite especificar la cuenta de contrapartida en la que quiere registrar un importe de pago no liquidable en una l¡nea del diario de conciliaci¢n de pagos en el momento de registrar ese diario.;
                                 FRC=Pr‚cisez le compte de contrepartie sur lequel vous souhaitez reporter le montant d'un paiement non affectable sur une ligne journal rapprochement paiement lorsque vous reportez le journal.;
                                 ENC=Specify the balancing account to which you want a non-applicable payment amount on a payment reconciliation journal line to be posted when you post the journal.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferToGeneralJournal;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 MatchBankPayments@1001 : Codeunit 1255;
                               BEGIN
                                 MatchBankPayments.TransferDiffToAccount(Rec,TempGenJournalLine)
                               END;
                                }
      { 30      ;2   ;Action    ;
                      Name=AddMappingRule;
                      CaptionML=[ENU=Map Text to Account;
                                 ESM=Asignar texto a cuenta;
                                 FRC=Mapper le texte avec le compte;
                                 ENC=Map Text to Account];
                      ToolTipML=[ENU=Associate text on payments with debit, credit, and balancing accounts, so payments are posted to the accounts when you post payments. The payments are not applied to invoices or credit memos, and are suited for recurring cash receipts or expenses.;
                                 ESM=Permite asociar el texto acerca de los pagos con las cuentas de d‚bito, cr‚dito y contrapartida, para que los pagos se registren en las cuentas en el momento de registrar pagos. Estos pagos no se aplican a facturas ni Notas de Cr‚dito y son perfectos para recepciones de cobro o gastos peri¢dicos.;
                                 FRC=Associez le texte des paiements aux comptes d‚biteur, cr‚diteur et de contrepartie, de telle sorte que les paiements soient report‚s sur les comptes lorsque vous reportez les paiements. Les paiements ne sont pas affect‚s … des factures ni des notes de cr‚dit. Ils sont adapt‚s aux d‚penses et aux encaissements r‚currents.;
                                 ENC=Associate text on payments with debit, credit, and balancing accounts, so payments are posted to the accounts when you post payments. The payments are not applied to invoices or credit memos, and are suited for recurring cash receipts or expenses.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Add;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 TextToAccMapping@1000 : Record 1251;
                                 MatchBankPayments@1001 : Codeunit 1255;
                               BEGIN
                                 TextToAccMapping.InsertRecFromBankAccReconciliationLine(Rec);
                                 MatchBankPayments.RerunTextMapper(Rec);
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=ApplyEntries;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Apply Manually;
                                 ESM=&Liquidar manualmente;
                                 FRC=&Affecter manuellement;
                                 ENC=&Apply Manually];
                      ToolTipML=[ENU=Review and apply payments that were applied automatically to wrong open entries or not applied at all.;
                                 ESM=Permite revisar y liquidar los pagos que se liquidaron de forma autom tica en movimientos pendientes err¢neos o que directamente no se liquidaron.;
                                 FRC=Passez en revue et affectez des paiements qui ont ‚t‚ affect‚s automatiquement … des ‚critures ouvertes incorrectes ou qui n'ont pas ‚t‚ affect‚s du tout.;
                                 ENC=Review and apply payments that were applied automatically to wrong open entries or not applied at all.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 DisplayApplication;
                                 GetAppliedPmtData(AppliedPmtEntry,RemainingAmountAfterPosting,StatementToRemAmtDifference,PmtAppliedToTxt);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=Review;
                                 ESM=Revisar;
                                 FRC=R‚vision;
                                 ENC=Review] }
      { 36      ;2   ;Action    ;
                      Name=Accept;
                      CaptionML=[ENU=Accept Applications;
                                 ESM=Aceptar liquidaciones;
                                 FRC=Accepter les affectations;
                                 ENC=Accept Applications];
                      ToolTipML=[ENU=Accept a payment application after reviewing it or manually applying it to entries. This closes the payment application and sets the Match Confidence to Accepted.;
                                 ESM=Permite aceptar una liquidaci¢n de pago despu‚s de revisarla o liquidarla manualmente en los movimientos. Esta acci¢n cierra la liquidaci¢n de pago y establece el valor de la opci¢n Confianza de la correspondencia en Aceptado.;
                                 FRC=Acceptez une affectation paiement aprŠs l'avoir pass‚e en revue ou affect‚e manuellement … des ‚critures. Cela ferme l'affectation paiement et d‚finit la Fiabilit‚ correspondance sur Accept‚e.;
                                 ENC=Accept a payment application after reviewing it or manually applying it to entries. This closes the payment application and sets the Match Confidence to Accepted.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankAccReconciliationLine@1000 : Record 274;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(BankAccReconciliationLine);
                                 BankAccReconciliationLine.AcceptAppliedPaymentEntriesSelectedLines;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Remove Applications;
                                 ESM=Eliminar liquidaciones;
                                 FRC=Supprimer les affectations;
                                 ENC=Remove Applications];
                      ToolTipML=[ENU=Remove a payment application from an entry. This unapplies the payment.;
                                 ESM=Permite quitar una liquidaci¢n de pago de un movimiento. Esto desliquidar  el pago.;
                                 FRC=Supprimez une affectation de paiement depuis une ‚criture. Cela annule l'affectation du paiement.;
                                 ENC=Remove a payment application from an entry. This unapplies the payment.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankAccReconciliationLine@1000 : Record 274;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(BankAccReconciliationLine);
                                 BankAccReconciliationLine.RejectAppliedPaymentEntriesSelectedLines;
                               END;
                                }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Custom Sorting;
                                 ESM=Ordenaci¢n personalizada;
                                 FRC=Tri personnalis‚;
                                 ENC=Custom Sorting] }
      { 56      ;2   ;Action    ;
                      Name=ShowNonAppliedLines;
                      CaptionML=[ENU=Show Non-Applied Lines;
                                 ESM=Mostrar l¡neas no liquidadas;
                                 FRC=Afficher les lignes non affect‚es;
                                 ENC=Show Non-Applied Lines];
                      ToolTipML=[ENU=Display only payments in the list that have not been applied.;
                                 ESM=Permite mostrar solamente los pagos de la lista que no se hayan liquidado.;
                                 FRC=Affichez uniquement les paiements de la liste n'ayant pas ‚t‚ affect‚s.;
                                 ENC=Display only payments in the list that have not been applied.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=FilterLines;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SETFILTER(Difference,'<>0');
                                 CurrPage.UPDATE;
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=ShowAllLines;
                      CaptionML=[ENU=Show All Lines;
                                 ESM=Mostrar todas las l¡neas;
                                 FRC=Afficher toutes les lignes;
                                 ENC=Show All Lines];
                      ToolTipML=[ENU=Show all payments in the list no matter what their status is.;
                                 ESM=Permite mostrar todos los pagos de la lista sin importar cu l es su estado.;
                                 FRC=Affichez tous les paiements de la liste, peu importe leur ‚tat.;
                                 ENC=Show all payments in the list no matter what their status is.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AllLines;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SETRANGE(Difference);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      Name=SortForReviewDescending;
                      CaptionML=[ENU=Sort for Review Descending;
                                 ESM=Ordenar descendente para revisi¢n;
                                 FRC=Tri d‚croissant pour r‚vision;
                                 ENC=Sort for Review Descending];
                      ToolTipML=[ENU=Sort the lines in ascending order.;
                                 ESM=Permite ordenar las l¡neas en orden ascendente.;
                                 FRC=Triez les lignes dans l'ordre croissant.;
                                 ENC=Sort the lines in ascending order.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MoveDown;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 UpdateSorting(FALSE);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      Name=SortForReviewAscending;
                      CaptionML=[ENU=Sort for Review Ascending;
                                 ESM=Ordenar ascendente para revisi¢n;
                                 FRC=Tri croissant pour r‚vision;
                                 ENC=Sort for Review Ascending];
                      ToolTipML=[ENU=Sort the lines in descending order.;
                                 ESM=Permite ordenar las l¡neas en orden descendente.;
                                 FRC=Triez les lignes dans l'ordre d‚croissant.;
                                 ENC=Sort the lines in descending order.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MoveUp;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 UpdateSorting(TRUE);
                               END;
                                }
      { 39      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 38      ;1   ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 ESM=Dimensiones;
                                 FRC=Dimensions;
                                 ENC=Dimensions];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 ESM=Permite ver o editar dimensiones, como el  rea, el proyecto o el departamento, que pueden asignarse a los documentos de venta y compra para distribuir costos y analizar el historial de transacciones.;
                                 FRC=Affichez ou modifiez les dimensions, telles que la zone, le projet ou le d‚partement que vous pouvez affecter aux documents vente et achat afin de distribuer les co–ts et analyser l'historique des transactions.;
                                 ENC=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyse transaction history.];
                      ApplicationArea=#Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 BankAccReconciliation.ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 6       ;1   ;Action    ;
                      Name=LineDimensions;
                      CaptionML=[ENU=Line Dimensions;
                                 ESM=Dimensiones l¡nea;
                                 FRC=Dimensions de la ligne;
                                 ENC=Line Dimensions];
                      ToolTipML=[ENU=View or edit the line dimensions sets that are set up for the current line.;
                                 ESM=Permite ver o editar los grupos de dimensiones de l¡nea configurados para la l¡nea actual.;
                                 FRC=Affichez ou modifiez les ensembles de dimensions de ligne param‚tr‚s pour la ligne actuelle.;
                                 ENC=View or edit the line dimensions sets that are set up for the current line.];
                      ApplicationArea=#Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 21      ;1   ;Action    ;
                      CaptionML=[ENU=Bank Account Card;
                                 ESM=Ficha banco;
                                 FRC=Fiche compte bancaire;
                                 ENC=Bank Account Card];
                      ToolTipML=[ENU=View or edit information about the bank account that is related to the payment reconciliation journal.;
                                 ESM=Permite ver o editar la informaci¢n acerca de la cuenta bancaria relacionada con el diario de conciliaci¢n de pagos.;
                                 FRC=Affichez ou modifiez les informations sur le compte bancaire associ‚ au journal rapprochement paiement.;
                                 ENC=View or edit information about the bank account that is related to the payment reconciliation journal.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1283;
                      RunPageLink=No.=FIELD(Bank Account No.);
                      Image=BankAccount }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Details;
                                 ESM=Detalles;
                                 FRC=D‚tails;
                                 ENC=Details] }
      { 27      ;2   ;Action    ;
                      Name=ShowBankTransactionDetails;
                      CaptionML=[ENU=Bank Transaction Details;
                                 ESM=Detalles de transacci¢n bancaria;
                                 FRC=D‚tails de transactions bancaires;
                                 ENC=Bank Transaction Details];
                      ToolTipML=[ENU=View the values that exist in an imported bank statement file for the selected line.;
                                 ESM=Permite ver o editar los valores que existen en un archivo de estado de cuenta de banco importado de la l¡nea seleccionada.;
                                 FRC=Affichez le valeurs qui existent dans un fichier de relev‚ bancaire import‚ pour la ligne s‚lectionn‚e.;
                                 ENC=View the values that exist in an imported bank statement file for the selected line.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1221;
                      RunPageLink=Data Exch. No.=FIELD(Data Exch. Entry No.),
                                  Line No.=FIELD(Data Exch. Line No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExternalDocument;
                      PromotedCategory=Category6 }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[ENU=Page;
                                 ESM=P gina;
                                 FRC=Page;
                                 ENC=Page] }
      { 73      ;2   ;Action    ;
                      Name=EditInExcel;
                      CaptionML=[ENU=Edit in Excel;
                                 ESM=Editar en Excel;
                                 FRC=Modifier dans Excel;
                                 ENC=Edit in Excel];
                      ToolTipML=[ENU=Send the data in the journal to an Excel file for analysis or editing.;
                                 ESM=Enviar los datos del diario a un archivo Excel para su edici¢n o el an lisis.;
                                 FRC=Envoyez les donn‚es du journal vers un fichier Excel … des fins d'analyse ou de modification.;
                                 ENC=Send the data in the journal to an Excel file for analysis or editing.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsSaasExcelAddinEnabled;
                      PromotedIsBig=Yes;
                      Image=Excel;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ODataUtility@1000 : Codeunit 6710;
                               BEGIN
                                 ODataUtility.EditWorksheetInExcel(CurrPage.CAPTION,CurrPage.OBJECTID(FALSE),'');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater;
                FreezeColumnID=Statement Amount }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quality of the automatic payment application on the journal line.;
                           ESM=Especifica la calidad de la liquidaci¢n de pagos autom tica en la l¡nea del diario.;
                           FRC=Sp‚cifie la qualit‚ de l'affectation de paiement automatique sur la ligne journal.;
                           ENC=Specifies the quality of the automatic payment application on the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Match Confidence";
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DisplayApplication;
                            END;
                             }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the payment represented by the journal line was recorded in the bank account.;
                           ESM=Especifica la fecha en la que se registr¢ el pago representado mediante la l¡nea del diario en la cuenta bancaria.;
                           FRC=Sp‚cifie la date … laquelle le paiement repr‚sent‚ par la ligne journal a ‚t‚ enregistr‚ dans le compte bancaire.;
                           ENC=Specifies the date when the payment represented by the journal line was recorded in the bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Date" }

    { 16  ;2   ;Field     ;
                Width=40;
                ToolTipML=[ENU=Specifies the text that the customer or vendor entered on that payment transaction that is represented by the journal line.;
                           ESM=Especifica el texto que escribi¢ el cliente o el proveedor acerca de la transacci¢n de pagos representada mediante la l¡nea del diario.;
                           FRC=Sp‚cifie le texte que le client ou le fournisseur a saisi sur cette transaction de paiement repr‚sent‚e par la ligne journal.;
                           ENC=Specifies the text that the customer or vendor entered on that payment transaction that is represented by the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Text" }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the imported bank transaction.;
                           ESM=Especifica el id. de la transacci¢n bancaria importada.;
                           FRC=Sp‚cifie l'lD de la transaction bancaire import‚e.;
                           ENC=Specifies the ID of the imported bank transaction.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction ID";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Transaction Amount;
                           ESM=Importe transacci¢n;
                           FRC=Montant de la transaction;
                           ENC=Transaction Amount];
                ToolTipML=[ENU=Specifies the amount that was paid into the bank account and then imported as a bank statement line represented by the journal line.;
                           ESM=Especifica el importe que se pag¢ en la cuenta bancaria y que se import¢ como una l¡nea de estado de cuenta de banco representada mediante la l¡nea del diario.;
                           FRC=Sp‚cifie le montant qui a ‚t‚ pay‚ sur le compte bancaire, puis import‚ comme ligne de relev‚ bancaire repr‚sent‚e par la ligne journal.;
                           ENC=Specifies the amount that was paid into the bank account and then imported as a bank statement line represented by the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Statement Amount";
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             CurrPage.UPDATE(FALSE)
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that has been applied to one or more open entries.;
                           ESM=Especifica el importe que se liquid¢ en uno o varios movimientos pendientes.;
                           FRC=Sp‚cifie le montant appliqu‚ … une ou plusieurs ‚critures ouvertes.;
                           ENC=Specifies the amount that has been applied to one or more open entries.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applied Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the amount in the Statement Amount field and the amount in the Applied Amount field.;
                           ESM=Especifica la diferencia de importes entre los campos Importe estado de cuenta e Importe liquidado.;
                           FRC=Sp‚cifie la diff‚rence entre le montant des champs Montant relev‚ et Montant affect‚.;
                           ENC=Specifies the difference between the amount in the Statement Amount field and the amount in the Applied Amount field.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Difference;
                Editable=FALSE;
                Style=Unfavorable }

    { 52  ;2   ;Field     ;
                Name=StatementToRemAmtDifference;
                CaptionML=[ENU=Difference from Remaining Amount;
                           ESM=Diferencia con importe pendiente;
                           FRC=Diff‚rence par rapport au montant ouvert;
                           ENC=Difference from Remaining Amount];
                ToolTipML=[ENU=Specifies the difference between the values in the Statement Amount and the Remaining Amount After Posting fields.;
                           ESM=Especifica la diferencia entre los valores de los campos Importe estado de cuenta e Importe pendiente despu‚s del registro.;
                           FRC=Sp‚cifie la diff‚rence entre les valeurs des champs Montant relev‚ et Solde ouvert aprŠs report.;
                           ENC=Specifies the difference between the values in the Statement Amount and the Remaining Amount After Posting fields.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=StatementToRemAmtDifference;
                Visible=FALSE;
                Enabled=FALSE }

    { 49  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           ESM=N§ documento;
                           FRC=Nø de document;
                           ENC=Document No.];
                ToolTipML=[ENU=Specifies the document number of the open entry that the payment is applied to.;
                           ESM=Especifica el n£mero de documento del movimiento pendiente en el que se liquida el pago.;
                           FRC=Sp‚cifie le num‚ro de document de l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the document number of the open entry that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAppliedToDocumentNo }

    { 47  ;2   ;Field     ;
                Name=DescAppliedEntry;
                CaptionML=[ENU=Description;
                           ESM=Descripci¢n;
                           FRC=Description;
                           ENC=Description];
                ToolTipML=[ENU=Specifies the description on the open entry that the payment is applied to.;
                           ESM=Especifica la descripci¢n del movimiento pendiente en el que se liquida el pago.;
                           FRC=Sp‚cifie la description de l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the description on the open entry that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry.Description;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                Name=DueDateAppliedEntry;
                CaptionML=[ENU=Due Date;
                           ESM=Fecha vencimiento;
                           FRC=Date d'‚ch‚ance;
                           ENC=Due Date];
                ToolTipML=[ENU=Specifies the due date on the open entry that the payment is applied to.;
                           ESM=Especifica la fecha de vencimiento del movimiento pendiente en el que se liquida el pago.;
                           FRC=Sp‚cifie la date d'‚ch‚ance de l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the due date on the open entry that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry."Due Date" }

    { 43  ;2   ;Field     ;
                Name=AccountName;
                CaptionML=[ENU=Account Name;
                           ESM=Nombre cuenta;
                           FRC=Nom du compte;
                           ENC=Account Name];
                ToolTipML=[ENU=Specifies the name of the customer or vendor that the payment is applied to.;
                           ESM=Especifica el nombre del cliente o el proveedor al que se liquida el pago.;
                           FRC=Sp‚cifie le nom du client ou du fournisseur auquel le paiement est affect‚.;
                           ENC=Specifies the name of the customer or vendor that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAppliedToName;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              AppliedToDrillDown;
                            END;
                             }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of account that the payment application will be posted to when you post the worksheet.;
                           ESM=Especifica el tipo de cuenta en el que se registrar  la liquidaci¢n de pago cuando registre la hoja de c lculo.;
                           FRC=Sp‚cifie le type de compte sur lequel l'affectation paiement est report‚e lorsque vous reportez la feuille de travail.;
                           ENC=Specifies the type of account that the payment application will be posted to when you post the worksheet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Type" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the account number that the payment application will be posted to when you post the worksheet.;
                           ESM=Especifica el n£mero de cuenta en el que se registrar  la liquidaci¢n de pago cuando registre la hoja de c lculo.;
                           FRC=Sp‚cifie le num‚ro de compte sur lequel l'affectation paiement est report‚e lorsque vous reportez la feuille de travail.;
                           ENC=Specifies the account number that the payment application will be posted to when you post the worksheet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             IF Difference > 0 THEN
                               TransferRemainingAmountToAccount;
                           END;
                            }

    { 46  ;2   ;Field     ;
                Name=PostingDateAppliedEntry;
                CaptionML=[ENU=Posting Date;
                           ESM=Fecha reg.;
                           FRC=Date de report;
                           ENC=Posting Date];
                ToolTipML=[ENU=Specifies the posting date on the open entry that the payment is applied to.;
                           ESM=Especifica la fecha registro del movimiento pendiente en el que se liquida el pago.;
                           FRC=Sp‚cifie la date de report de l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the posting date on the open entry that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry."Posting Date";
                Visible=FALSE;
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Entry Currency Code;
                           ESM=C¢d. divisa movimiento;
                           FRC=Code devise ‚criture;
                           ENC=Entry Currency Code];
                ToolTipML=[ENU=Specifies the currency code on the open entry that the payment is applied to.;
                           ESM=Especifica el c¢digo de divisa del movimiento pendiente en el que se liquida el pago.;
                           FRC=Sp‚cifie le code de devise de l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the currency code on the open entry that the payment is applied to.];
                ApplicationArea=#Suite;
                SourceExpr=AppliedPmtEntry."Currency Code";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                Name=Match Details;
                CaptionML=[ENU=Match Details;
                           ESM=Detalles de correspondencia;
                           FRC=D‚tails de correspondance;
                           ENC=Match Details];
                ToolTipML=[ENU=Specifies details about the payment application on the journal line.;
                           ESM=Especifica los detalles sobre la liquidaci¢n de pago de la l¡nea del diario.;
                           FRC=Sp‚cifie les d‚tails concernant l'affectation du paiement sur la ligne journal.;
                           ENC=Specifies details about the payment application on the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MatchDetails;
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DisplayApplication;
                            END;
                             }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies for a journal line where the payment has been applied, how many entries the payment has been applied to.;
                           ESM=Especifica, en el caso de una l¡nea del diario en la que se haya liquidado el pago, en cu ntos movimientos se liquid¢ el pago.;
                           FRC=Sp‚cifie, pour une ligne journal o— le paiement a ‚t‚ affect‚, le nombre d'‚critures auxquelles le paiement a ‚t‚ affect‚.;
                           ENC=Specifies for a journal line where the payment has been applied, how many entries the payment has been applied to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applied Entries";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                Name=RemainingAmount;
                CaptionML=[ENU=Remaining Amount After Posting;
                           ESM=Importe pendiente despu‚s del registro;
                           FRC=Montant ouvert aprŠs report;
                           ENC=Remaining Amount After Posting];
                ToolTipML=[ENU=Specifies the amount that remains to be paid on the open entry that the payment is applied to.;
                           ESM=Especifica el importe pendiente de pago en el movimiento pendiente que en el que se liquida el pago.;
                           FRC=Sp‚cifie le montant qui reste … payer sur l'‚criture ouverte … laquelle le paiement est affect‚.;
                           ENC=Specifies the amount that remains to be paid on the open entry that the payment is applied to.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=RemainingAmountAfterPosting;
                Visible=FALSE;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                Width=40;
                ToolTipML=[ENU=Specifies additional information on the bank statement line for the payment.;
                           ESM=Especifica informaci¢n adicional en la l¡nea de estado de cuenta de banco para el pago.;
                           FRC=Sp‚cifie des informations suppl‚mentaires sur la ligne de relev‚ bancaire pour le paiement.;
                           ENC=Specifies additional information on the bank statement line for the payment.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Additional Transaction Info";
                Visible=FALSE;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                Width=30;
                ToolTipML=[ENU=Specifies the address of the customer or vendor who made the payment that is represented by the journal line.;
                           ESM=Especifica la direcci¢n del cliente o el proveedor que realiz¢ el pago que se representa en la l¡nea del diario.;
                           FRC=Sp‚cifie l'adresse du client ou du fournisseur qui a effectu‚ le paiement qui est repr‚sent‚ par la ligne journal.;
                           ENC=Specifies the address of the customer or vendor who made the payment that is represented by the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Address";
                Visible=FALSE;
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                Width=20;
                ToolTipML=[ENU=Specifies the bank account number of the customer or vendor who made the payment.;
                           ESM=Especifica el n£mero de cuenta bancaria del cliente o el proveedor que realiz¢ el pago.;
                           FRC=Sp‚cifie le num‚ro de compte bancaire du client ou du fournisseur ayant effectu‚ le paiement.;
                           ENC=Specifies the bank account number of the customer or vendor who made the payment.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Bank Acc. No.";
                Visible=FALSE;
                Editable=FALSE }

    { 19  ;2   ;Field     ;
                Width=10;
                ToolTipML=[ENU=Specifies the city name of the customer or vendor.;
                           ESM=Especifica el nombre del Municipio/Ciudad del cliente o el proveedor.;
                           FRC=Sp‚cifie le nom de la ville du client ou du fournisseur.;
                           ENC=Specifies the city name of the customer or vendor.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party City";
                Visible=FALSE;
                Editable=FALSE }

    { 17  ;2   ;Field     ;
                Width=30;
                ToolTipML=[ENU=Specifies the name of the customer or vendor who made the payment that is represented by the journal line.;
                           ESM=Especifica el nombre del cliente o el proveedor que realiz¢ el pago que se representa en la l¡nea del diario.;
                           FRC=Sp‚cifie le nom du client ou du fournisseur qui a effectu‚ le paiement qui est repr‚sent‚ par la ligne journal.;
                           ENC=Specifies the name of the customer or vendor who made the payment that is represented by the journal line.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Name";
                Visible=FALSE;
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           ESM=Especifica el c¢digo de dimensi¢n del acceso directo 1, que es uno de los dos c¢digos de dimensi¢n globales que se configuran en la ventana Configuraci¢n de contabilidad.;
                           FRC=Sp‚cifie le code du raccourci dimensionÿ1 qui est l'un des codes de dimension principaux que vous configurez dans la fenˆtre configuration du grand livre.;
                           ENC=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           ESM=Especifica el c¢digo de dimensi¢n del acceso directo 2, que es uno de los dos c¢digos de dimensi¢n globales que se configuran en la ventana Configuraci¢n de contabilidad.;
                           FRC=Sp‚cifie le code du raccourci dimensionÿ2 qui est l'un des codes de dimension principaux que vous configurez dans la fenˆtre configuration du grand livre.;
                           ENC=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 67  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           ESM=Especifica el c¢digo del valor de dimensi¢n vinculado a la l¡nea del diario.;
                           FRC=Sp‚cifie le code valeur de dimension li‚ … la ligne journal.;
                           ENC=Specifies the dimension value code linked to the journal line.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 28  ;1   ;Group     ;
                GroupType=Group }

    { 33  ;2   ;Group     ;
                Editable=FALSE;
                GroupType=Group }

    { 25  ;3   ;Field     ;
                Name=BalanceOnBankAccount;
                CaptionML=[ENU=Balance on Bank Account;
                           ESM=Saldo en cuenta bancaria;
                           FRC=Solde sur compte bancaire;
                           ENC=Balance on Bank Account];
                ToolTipML=[ENU=Specifies the balance of the bank account per the last time you reconciled the bank account.;
                           ESM=Especifica el saldo de la cuenta bancaria seg£n la £ltima conciliaci¢n de dicha cuenta.;
                           FRC=Sp‚cifie le solde du compte bancaire lors de votre dernier rapprochement bancaire.;
                           ENC=Specifies the balance of the bank account per the last time you reconciled the bank account.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Balance on Bank Account";
                AutoFormatType=1;
                OnDrillDown=BEGIN
                              BankAccReconciliation.DrillDownOnBalanceOnBankAccount;
                            END;
                             }

    { 26  ;3   ;Field     ;
                Name=TotalTransactionAmount;
                CaptionML=[ENU=Total Transaction Amount;
                           ESM=Importe total de la transacci¢n;
                           FRC=Montant transaction total;
                           ENC=Total Transaction Amount];
                ToolTipML=[ENU=Specifies the sum of values in the Statement Amount field on all the lines in the Payment Reconciliation Journal window.;
                           ESM=Especifica la suma de los valores del campo Importe estado de cuenta en todas las l¡neas de la ventana Diario de conciliaci¢n de pagos.;
                           FRC=Sp‚cifie la somme des valeurs du champ Montant relev‚ sur toutes les lignes de la fenˆtre Journal rapprochement paiement.;
                           ENC=Specifies the sum of values in the Statement Amount field on all the lines in the Payment Reconciliation Journal window.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Transaction Amount";
                AutoFormatType=1 }

    { 24  ;3   ;Field     ;
                Name=BalanceOnBankAccountAfterPosting;
                CaptionML=[ENU=Balance on Bank Account After Posting;
                           ESM=Saldo en cuenta bancaria despu‚s del registro;
                           FRC=Solde sur compte bancaire aprŠs report;
                           ENC=Balance on Bank Account After Posting];
                ToolTipML=[ENU=Specifies the total amount that will exist on the bank account as a result of payment applications that you post in the Payment Reconciliation Journal window.;
                           ESM=Especifica el importe total que existir  en la cuenta bancaria como resultado de las liquidaciones de pago que se registren en la ventana Diario de conciliaci¢n de pagos.;
                           FRC=Sp‚cifie le montant total qui figurera sur le compte bancaire en cons‚quence des affectations de paiement que vous reportez dans la fenˆtre Journal rapprochement paiement.;
                           ENC=Specifies the total amount that will exist on the bank account as a result of payment applications that you post in the Payment Reconciliation Journal window.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Balance on Bank Account" + BankAccReconciliation."Total Unposted Applied Amount";
                AutoFormatType=1;
                StyleExpr=BalanceAfterPostingStyleExpr }

    { 3   ;2   ;Group     ;
                GroupType=Group }

    { 54  ;3   ;Field     ;
                Name=OutstandingTransactions;
                CaptionML=[ENU=Outstanding Transactions;
                           ESM=Transacciones pendientes;
                           FRC=Transactions restantes;
                           ENC=Outstanding Transactions];
                ToolTipML=[ENU=Specifies the outstanding bank transactions that have not been applied.;
                           ESM=Especifica las transacciones bancaria pendientes que no se han liquidado.;
                           FRC=Sp‚cifie les transactions bancaires restantes qui n'ont pas ‚t‚ appliqu‚es.;
                           ENC=Specifies the outstanding bank transactions that have not been applied.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OutstandingTransactions;
                Editable=FALSE;
                OnDrillDown=VAR
                              DummyOutstandingBankTransaction@1001 : Record 1284;
                            BEGIN
                              DummyOutstandingBankTransaction.DrillDown("Bank Account No.",
                                DummyOutstandingBankTransaction.Type::"Bank Account Ledger Entry","Statement Type","Statement No.");
                            END;
                             }

    { 61  ;3   ;Field     ;
                Name=OutstandingPayments;
                CaptionML=[ENU=Outstanding Payments;
                           ESM=Pagos pendientes;
                           FRC=Paiements restants;
                           ENC=Outstanding Payments];
                ToolTipML=[ENU=Specifies the outstanding check transactions that have not been applied.;
                           ESM=Especifica las transacciones de cheques pendientes que no se liquidaron.;
                           FRC=Sp‚cifie les transactions par chŠques restantes qui n'ont pas ‚t‚ appliqu‚es.;
                           ENC=Specifies the outstanding cheque transactions that have not been applied.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OutstandingPayments;
                Editable=FALSE;
                OnDrillDown=VAR
                              DummyOutstandingBankTransaction@1001 : Record 1284;
                            BEGIN
                              DummyOutstandingBankTransaction.DrillDown("Bank Account No.",
                                DummyOutstandingBankTransaction.Type::"Check Ledger Entry","Statement Type","Statement No.");
                            END;
                             }

    { 23  ;3   ;Field     ;
                Name=StatementEndingBalance;
                CaptionML=[ENU=Statement Ending Balance;
                           ESM=Saldo final estado de cuenta;
                           FRC=Solde final du relev‚;
                           ENC=Statement Ending Balance];
                ToolTipML=[ENU=Specifies the balance on your actual bank account after the bank has processed the payments that you have imported with the bank statement file.;
                           ESM=Especifica el saldo de la cuenta bancaria real despu‚s de que el banco haya procesado los pagos que se importaron con el archivo de estado de cuenta de banco.;
                           FRC=Sp‚cifie le solde de votre compte bancaire r‚el aprŠs le traitement par la banque des paiements import‚s avec le fichier de relev‚ bancaire.;
                           ENC=Specifies the balance on your actual bank account after the bank has processed the payments that you have imported with the bank statement file.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Statement Ending Balance";
                AutoFormatType=1;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      BankAccReconciliation@1000 : Record 273;
      AppliedPmtEntry@1007 : Record 1294;
      TempGenJournalLine@1009 : TEMPORARY Record 81;
      MatchDetails@1002 : Text;
      PmtAppliedToTxt@1003 : TextConst '@@@="%1=integer value for number of entries";ENU=The payment has been applied to %1 entries.;ESM=El pago se liquid¢ en %1 movimientos.;FRC=Le paiement a ‚t‚ affect‚ avec %1 ‚critures.;ENC=The payment has been applied to %1 entries.';
      IsBankAccReconInitialized@1004 : Boolean;
      StatementToRemAmtDifference@1005 : Decimal;
      FinanceChargeMemoEnabled@1001 : Boolean;
      RemainingAmountAfterPosting@1006 : Decimal;
      RemoveExistingApplicationsQst@1008 : TextConst 'ENU=When you run the Apply Automatically action, it will undo all previous applications.\\Do you want to continue?;ESM=Al ejecutar la acci¢n Liquidar autom ticamente, se deshar n todas las liquidaciones anteriores.\\¨Desea continuar?;FRC=Si vous ex‚cutez l''action Affecter automatiquement, toutes les affectations pr‚c‚dentes seront annul‚es.\\Voulez-vous continuer?;ENC=When you run the Apply Automatically action, it will undo all previous applications.\\Do you want to continue?';
      BalanceAfterPostingStyleExpr@1010 : Text;
      PageMustCloseMsg@1011 : TextConst 'ENU=The Payment Reconciliation Journal window has been closed because the connection was suspended.;ESM=La ventana Diarios de conciliaci¢n de pagos se cerr¢ porque se suspendi¢ la conexi¢n.;FRC=La fenˆtre Journal de rapprochement bancaire a ‚t‚ ferm‚e parce que la connexion a ‚t‚ suspendue.;ENC=The Payment Reconciliation Journal window has been closed because the connection was suspended.';
      PageClosedByPosting@1012 : Boolean;
      OutstandingTransactions@1015 : Decimal;
      OutstandingPayments@1014 : Decimal;
      ShortcutDimCode@1013 : ARRAY [8] OF Code[20];
      IsSaasExcelAddinEnabled@1016 : Boolean;

    LOCAL PROCEDURE UpdateSorting@4(IsAscending@1003 : Boolean);
    VAR
      BankAccReconciliationLine@1005 : Record 274;
      PaymentMatchingDetails@1000 : Record 1299;
      AppliedPaymentEntry2@1002 : Record 1294;
      AmountDifference@1001 : Decimal;
      ScoreRange@1004 : Integer;
      SubscriberInvoked@1006 : Boolean;
    BEGIN
      BankAccReconciliationLine.SETRANGE("Statement Type","Statement Type");
      BankAccReconciliationLine.SETRANGE("Bank Account No.","Bank Account No.");
      BankAccReconciliationLine.SETRANGE("Statement No.","Statement No.");
      BankAccReconciliationLine.SETAUTOCALCFIELDS("Match Confidence");

      IF BankAccReconciliationLine.FINDSET THEN BEGIN
        REPEAT
          ScoreRange := 10000;
          BankAccReconciliationLine."Sorting Order" := BankAccReconciliationLine."Match Confidence" * ScoreRange;

          // Update sorting for same match confidence based onother criteria
          GetAppliedPmtData(AppliedPaymentEntry2,RemainingAmountAfterPosting,AmountDifference,PmtAppliedToTxt);

          ScoreRange := ScoreRange / 10;
          IF AmountDifference <> 0 THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          ScoreRange := ScoreRange / 10;
          IF Difference <> 0 THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          ScoreRange := ScoreRange / 10;
          IF PaymentMatchingDetails.MergeMessages(Rec) <> '' THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          BankAccReconciliationLine.MODIFY;
        UNTIL BankAccReconciliationLine.NEXT = 0;

        OnUpdateSorting(BankAccReconciliation,SubscriberInvoked);
        IF NOT SubscriberInvoked THEN
          SETCURRENTKEY("Sorting Order");
        ASCENDING(IsAscending);

        CurrPage.UPDATE(FALSE);
        FINDFIRST;
      END;
    END;

    LOCAL PROCEDURE InvokePost@2(OnlyPayments@1000 : Boolean);
    VAR
      BankAccReconciliation@1001 : Record 273;
      BankAccReconPostYesNo@1002 : Codeunit 371;
    BEGIN
      BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
      BankAccReconciliation."Post Payments Only" := OnlyPayments;

      IF BankAccReconPostYesNo.BankAccReconPostYesNo(BankAccReconciliation) THEN BEGIN
        RESET;
        PageClosedByPosting := TRUE;
        CurrPage.CLOSE;
      END;
    END;

    LOCAL PROCEDURE UpdateBalanceAfterPostingStyleExpr@3();
    BEGIN
      WITH BankAccReconciliation DO
        IF "Total Balance on Bank Account" + "Total Unposted Applied Amount" <> "Statement Ending Balance" THEN
          BalanceAfterPostingStyleExpr := 'Unfavorable'
        ELSE
          BalanceAfterPostingStyleExpr := 'Favorable';
    END;

    LOCAL PROCEDURE TestIfFiltershaveBeenRemovedWithRefreshAndClose@5();
    BEGIN
      FILTERGROUP := 2;
      IF NOT PageClosedByPosting THEN
        IF GETFILTER("Bank Account No.") + GETFILTER("Statement Type") + GETFILTER("Statement No.") = '' THEN BEGIN
          MESSAGE(PageMustCloseMsg);
          CurrPage.CLOSE;
        END;
      FILTERGROUP := 0;
    END;

    [Integration]
    PROCEDURE OnAtActionApplyAutomatically@1(BankAccReconciliation@1000 : Record 273;VAR SubscriberInvoked@1001 : Boolean);
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnUpdateSorting@7(BankAccReconciliation@1001 : Record 273;VAR SubscriberInvoked@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnAfterImportBankTransactions@9(VAR SubscriberInvoked@1000 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

