OBJECT Page 5091 Segment
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00,NAVNA13.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Segment;
               ESM=Segmento;
               FRC=Segment;
               ENC=Segment];
    SourceTable=Table5076;
    PopulateAllFields=Yes;
    PageType=ListPlus;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
           BEGIN
             UnitDurationMinEnable := TRUE;
             UnitCostLCYEnable := TRUE;
             InitiatedByEnable := TRUE;
             InformationFlowEnable := TRUE;
             IgnoreContactCorresTypeEnable := TRUE;
             AttachmentEnable := TRUE;
             LanguageCodeDefaultEnable := TRUE;
             SubjectDefaultEnable := TRUE;
             CorrespondenceTypeDefaultEnabl := TRUE;
             CampaignResponseEnable := TRUE;
             CampaignTargetEnable := TRUE;
             ExportContactsVisible := PermissionManager.SoftwareAsAService;
           END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Attachment No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateEditable;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Segment;
                                 ESM=&Segmento;
                                 FRC=Seg&ment;
                                 ENC=&Segment];
                      Image=Segment }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Criteria;
                                 ESM=Criterio;
                                 FRC=CritŠre;
                                 ENC=Criteria];
                      ToolTipML=[ENU=View a list of the actions that you have performed (adding or removing contacts) in order to define the segment criteria.;
                                 ESM=Permite ver una lista de las acciones realizadas (como agregar o quitar contactos) para poder definir los criterios de segmento.;
                                 FRC=Affichez la liste des actions que vous avez ex‚cut‚es (ajout ou suppression de contacts) afin de d‚finir les critŠres segment.;
                                 ENC=View a list of the actions that you have performed (adding or removing contacts) in order to define the segment criteria.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5143;
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=Filter }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Oppo&rtunities;
                                 ESM=&Oportunidades;
                                 FRC=Oppo&rtunit‚s;
                                 ENC=Oppo&rtunities];
                      ToolTipML=[ENU=View the sales opportunities that are handled by salespeople for the segment. Opportunities must involve a contact and can be linked to campaigns.;
                                 ESM=Permite ver las oportunidades de venta que los vendedores gestionan para el segmento. Las oportunidades deben tener un contacto y pueden vincularse a campa¤as.;
                                 FRC=Affichez les opportunit‚s de vente g‚r‚es par les repr‚sentants pour le segment. Les opportunit‚s doivent impliquer un contact et peuvent ˆtre li‚es aux promotions.;
                                 ENC=View the sales opportunities that are handled by salespeople for the segment. Opportunities must involve a contact and can be linked to campaigns.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5123;
                      RunPageView=SORTING(Segment No.);
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=OpportunityList }
      { 3       ;2   ;Action    ;
                      Name=Create opportunity;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5124;
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=NewOpportunity;
                      RunPageMode=Create }
      { 5       ;2   ;Action    ;
                      Name=Create opportunities;
                      CaptionML=[ENU=Create opportunities;
                                 ESM=Crear oportunidades;
                                 FRC=Cr‚er des opportunit‚s;
                                 ENC=Create opportunities];
                      ToolTipML=[ENU=Create a new opportunity card related to the segment.;
                                 ESM=Permite crear una nueva ficha de oportunidad relacionada con el segmento.;
                                 FRC=Cr‚er une fiche opportunit‚ li‚e au segment.;
                                 ENC=Create a new opportunity card related to the segment.];
                      ApplicationArea=#RelationshipMgmt;
                      OnAction=BEGIN
                                 CreateOpportunitiesForAllContacts;
                               END;
                                }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=T&asks;
                                 ESM=T&areas;
                                 FRC=T&ƒches;
                                 ENC=T&asks];
                      ToolTipML=[ENU=View all marketing tasks that involve the segment.;
                                 ESM=Permite ver todas las tareas de marketing relacionadas con el segmento.;
                                 FRC=Afficher toutes les tƒches marketing impliquant le segment.;
                                 ENC=View all marketing tasks that involve the segment.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5096;
                      RunPageView=SORTING(Segment No.);
                      RunPageLink=Segment No.=FIELD(No.),
                                  System To-do Type=FILTER(Organizer|Salesperson Attendee);
                      Image=TaskList }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 25      ;1   ;Action    ;
                      Name=LogSegment;
                      CaptionML=[ENU=&Log;
                                 ESM=A&rchivar;
                                 FRC=&Journal;
                                 ENC=&Log];
                      ToolTipML=[ENU=Log segments and interactions that are assigned to your segments and delivery attachments that you have sent.;
                                 ESM=Permite registrar los segmentos y las interacciones que se asignan a los segmentos y los archivos adjuntos de entrega que usted ha enviado.;
                                 FRC=Journalisez les segments et les interactions qui leur sont affect‚es et fournissez les piŠces jointes que vous avez envoy‚es.;
                                 ENC=Log segments and interactions that are assigned to your segments and delivery attachments that you have sent.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 LogSegment@1001 : Report 5185;
                               BEGIN
                                 LogSegment.SetSegmentNo("No.");
                                 LogSegment.RUNMODAL;
                                 IF NOT GET("No.") THEN
                                   MESSAGE(Text011,"No.");
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions];
                      Image=Action }
      { 90      ;2   ;ActionGroup;
                      CaptionML=[ENU=Contacts;
                                 ESM=Contactos;
                                 FRC=Contacts;
                                 ENC=Contacts];
                      Image=CustomerContact }
      { 29      ;3   ;Action    ;
                      Name=AddContacts;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Add Contacts;
                                 ESM=A¤adir contactos;
                                 FRC=Ajouter contacts;
                                 ENC=Add Contacts];
                      ToolTipML=[ENU=Select which contacts to add to the segment.;
                                 ESM=Permite seleccionar los contactos que desea agregar al segmento.;
                                 FRC=S‚lectionnez les contacts … ajouter au segment.;
                                 ENC=Select which contacts to add to the segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=AddContacts;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1002 : Record 5076;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Add Contacts",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 30      ;3   ;Action    ;
                      Name=ReduceContacts;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reduce Contacts;
                                 ESM=Reducir contactos;
                                 FRC=R‚duire les contacts;
                                 ENC=Reduce Contacts];
                      ToolTipML=[ENU=Select which contacts to remove from your segment.;
                                 ESM=Permite seleccionar los contactos que desea quitar del segmento.;
                                 FRC=S‚lectionnez les contacts … supprimer du segment.;
                                 ENC=Select which contacts to remove from your segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=RemoveContacts;
                      OnAction=VAR
                                 SegHeader@1002 : Record 5076;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Remove Contacts - Reduce",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=RefineContacts;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&fine Contacts;
                                 ESM=Re&definir contactos;
                                 FRC=Red‚&finir les contacts;
                                 ENC=Re&fine Contacts];
                      ToolTipML=[ENU=Select which contacts to keep in your segment.;
                                 ESM=Permite seleccionar los contactos que desea conservar en el segmento.;
                                 FRC=S‚lectionnez les contacts … conserver dans le segment.;
                                 ENC=Select which contacts to keep in your segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ContactFilter;
                      OnAction=VAR
                                 SegHeader@1002 : Record 5076;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Remove Contacts - Refine",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 28      ;2   ;ActionGroup;
                      CaptionML=[ENU=S&egment;
                                 ESM=&Segmento;
                                 FRC=Seg&ment;
                                 ENC=S&egment];
                      Image=Segment }
      { 33      ;3   ;Action    ;
                      CaptionML=[ENU=Go Back;
                                 ESM=Ir atr s;
                                 FRC=Revenir en arriŠre;
                                 ENC=Go Back];
                      ToolTipML=[ENU=Go one step back, for example if you have added contacts to a segment by mistake.;
                                 ESM=D‚ un paso atr s, por ejemplo, si ha agregado contactos en un segmento por error.;
                                 FRC=Revenez … l'‚tape pr‚c‚dente, pour exemple si vous avez ajout‚ des contacts … un segment par erreur.;
                                 ENC=Go one step back, for example if you have added contacts to a segment by mistake.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Undo;
                      OnAction=VAR
                                 SegmentHistoryMgt@1001 : Codeunit 5061;
                               BEGIN
                                 CALCFIELDS("No. of Criteria Actions");
                                 IF "No. of Criteria Actions" > 0 THEN
                                   IF CONFIRM(Text012,FALSE) THEN
                                     SegmentHistoryMgt.GoBack("No.");
                               END;
                                }
      { 54      ;3   ;Separator ;
                      CaptionML=[ENU="";
                                 ESM="";
                                 FRC="";
                                 ENC=""] }
      { 56      ;3   ;Action    ;
                      Name=ReuseCriteria;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reuse Criteria;
                                 ESM=Reutilizar criterio;
                                 FRC=R‚utiliser les critŠres;
                                 ENC=Reuse Criteria];
                      ToolTipML=[ENU=Reuse a saved segment criteria.;
                                 ESM=Permite volver a usar un criterio de segmento guardado.;
                                 FRC=R‚utilisez un critŠre segment enregistr‚.;
                                 ENC=Reuse a saved segment criteria.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Reuse;
                      OnAction=BEGIN
                                 ReuseCriteria;
                               END;
                                }
      { 55      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reuse Segment;
                                 ESM=Reutilizar segmento;
                                 FRC=R‚utiliser le segment;
                                 ENC=Reuse Segment];
                      ToolTipML=[ENU=Reuse a logged segment.;
                                 ESM=Permite volver a usar un segmento registrado.;
                                 FRC=R‚utilisez un segment journalis‚.;
                                 ENC=Reuse a logged segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Reuse;
                      OnAction=BEGIN
                                 ReuseLogged(0);
                               END;
                                }
      { 50      ;3   ;Action    ;
                      Name=SaveCriteria;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Save Criteria;
                                 ESM=Guardar criterio;
                                 FRC=Enregistrer critŠre;
                                 ENC=Save Criteria];
                      ToolTipML=[ENU=Save a segment criteria.;
                                 ESM=Permite guardar un criterio de segmento.;
                                 FRC=Enregistrez un critŠre de segment.;
                                 ENC=Save a segment criteria.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Save;
                      OnAction=BEGIN
                                 SaveCriteria;
                               END;
                                }
      { 59      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 ESM="";
                                 FRC="";
                                 ENC=""] }
      { 60      ;2   ;ActionGroup;
                      CaptionML=[ENU=Attachment;
                                 ESM=Anexo;
                                 FRC=PiŠce jointe;
                                 ENC=Attachment];
                      Image=Attachments }
      { 61      ;3   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Open;
                                 ESM=Abrir;
                                 FRC=Ouvert;
                                 ENC=Open];
                      ToolTipML=[ENU=Open the card for the selected record.;
                                 ESM=Permite abrir la tarjeta del registro seleccionado.;
                                 FRC=Ouvrir la fiche pour l'enregistrement s‚lectionn‚.;
                                 ENC=Open the card for the selected record.];
                      Image=Edit;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 OpenAttachment;
                               END;
                                }
      { 62      ;3   ;Action    ;
                      CaptionML=[ENU=Create;
                                 ESM=Crear;
                                 FRC=Cr‚er;
                                 ENC=Create];
                      ToolTipML=[ENU=Create an attachment.;
                                 ESM=Permite crear un archivo adjunto.;
                                 FRC=Cr‚ez une piŠce jointe.;
                                 ENC=Create an attachment.];
                      Image=New;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 CreateAttachment;
                               END;
                                }
      { 63      ;3   ;Action    ;
                      CaptionML=[ENU=Import;
                                 ESM=Importar;
                                 FRC=Importer;
                                 ENC=Import];
                      ToolTipML=[ENU=Import an attachment.;
                                 ESM=Permite importar un archivo adjunto.;
                                 FRC=Importez une piŠce jointe.;
                                 ENC=Import an attachment.];
                      Image=Import;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 ImportAttachment;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[ENU=Export;
                                 ESM=Exportar;
                                 FRC=Exporter;
                                 ENC=Export];
                      ToolTipML=[ENU=Export an attachment.;
                                 ESM=Permite exportar un archivo adjunto.;
                                 FRC=Exportez une piŠce jointe.;
                                 ENC=Export an attachment.];
                      Image=Export;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 ExportAttachment;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      CaptionML=[ENU=Remove;
                                 ESM=Eliminar;
                                 FRC=Supprimer;
                                 ENC=Remove];
                      ToolTipML=[ENU=Remove an attachment.;
                                 ESM=Permite quitar un archivo adjunto.;
                                 FRC=Supprimez une piŠce jointe.;
                                 ENC=Remove an attachment.];
                      Image=Cancel;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 RemoveAttachment(FALSE);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      CaptionML=[ENU=E&xport Contacts;
                                 ESM=E&xportar contactos;
                                 FRC=E&xporter les contacts;
                                 ENC=E&xport Contacts];
                      ToolTipML=[ENU=Export the segment contact list as an Excel file.;
                                 ESM=Permite exportar la lista de contactos del segmento como un archivo de Excel.;
                                 FRC=Exportez la liste des segments de contact en tant que fichier Excel.;
                                 ENC=Export the segment contact list as an Excel file.];
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ExportContactsVisible;
                      Image=ExportFile;
                      OnAction=VAR
                                 SegLineLocal@1001 : Record 5077;
                               BEGIN
                                 SegLineLocal.SETRANGE("Segment No.","No.");
                                 SegLineLocal.ExportODataFields;
                               END;
                                }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=Apply &Mailing Group;
                                 ESM=Asignar gru&po correo;
                                 FRC=&Appliquer le groupe de distribution;
                                 ENC=Apply &Mailing Group];
                      ToolTipML=[ENU=Assign a mailing group to a segment.;
                                 ESM=Permite asignar un grupo de correo a un segmento.;
                                 FRC=Affectez un groupe distribution … un segment.;
                                 ENC=Assign a mailing group to a segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=DistributionGroup;
                      OnAction=VAR
                                 SegHeader@1001 : Record 5076;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Apply Mailing Group",TRUE,TRUE,SegHeader);
                               END;
                                }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 ESM=&Imprimir;
                                 FRC=&Imprimer;
                                 ENC=&Print];
                      Image=Print }
      { 37      ;2   ;Action    ;
                      Name=CoverSheet;
                      CaptionML=[ENU=Print Cover &Sheets;
                                 ESM=Imprimir &portadas;
                                 FRC=Imprimer &bordereau d'envoi;
                                 ENC=Print Cover &Sheets];
                      ToolTipML=[ENU=View cover sheets to send to your contact.;
                                 ESM=Permite ver portadas para enviarlas al contacto.;
                                 FRC=Affichez les bordereaux d'envoi … envoyer … votre contact.;
                                 ENC=View cover sheets to send to your contact.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=PrintCover;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1001 : Record 5076;
                                 ContactCoverSheet@1005 : Report 5085;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 ContactCoverSheet.SetRunFromSegment;
                                 ContactCoverSheet.SETTABLEVIEW(SegHeader);
                                 ContactCoverSheet.RUNMODAL;
                               END;
                                }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Print &Labels;
                                 ESM=Imprimir &etiquetas;
                                 FRC=Imprimer ‚&tiquettes;
                                 ENC=Print &Labels];
                      ToolTipML=[ENU=View mailing labels with names and addresses.;
                                 ESM=Permite ver etiquetas de correo con los nombres y las direcciones.;
                                 FRC=Affichez les ‚tiquettes de routage comportant des noms et des adresses.;
                                 ENC=View mailing labels with names and addresses.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Print;
                      OnAction=VAR
                                 SegHeader@1001 : Record 5076;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Segment - Labels",TRUE,FALSE,SegHeader);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=G‚n‚ral;
                           ENC=General] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           ESM=Especifica el n£mero de la entrada o el registro relacionado, seg£n la serie num‚rica especificada.;
                           FRC=Sp‚cifie le num‚ro de l'‚criture ou de l'enregistrement concern‚, en fonction de la s‚rie de num‚ros sp‚cifi‚e.;
                           ENC=Specifies the number of the involved entry or record, according to the specified number series.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the segment.;
                           ESM=Especifica la descripci¢n del segmento.;
                           FRC=Sp‚cifie la description du segment.;
                           ENC=Specifies the description of the segment.];
                ApplicationArea=#All;
                SourceExpr=Description;
                OnValidate=BEGIN
                             DescriptionOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the salesperson responsible for this segment and/or interaction.;
                           ESM=Especifica el c¢digo del vendedor responsable de ese segmento o interacci¢n.;
                           FRC=Sp‚cifie le code du repr‚sentant responsable de ce segment et/ou de cette interaction.;
                           ENC=Specifies the code of the salesperson responsible for this segment and/or interaction.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the segment was created.;
                           ESM=Especifica la fecha en que se cre¢ el segmento.;
                           FRC=Sp‚cifie la date de cr‚ation du segment.;
                           ENC=Specifies the date that the segment was created.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Date;
                OnValidate=BEGIN
                             DateOnAfterValidate;
                           END;
                            }

    { 39  ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=[ENU=Specifies the number of lines within the segment.;
                           ESM=Especifica el n£mero de l¡neas del segmento.;
                           FRC=Sp‚cifie le nombre de lignes du segment.;
                           ENC=Specifies the number of lines within the segment.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No. of Lines" }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of actions you have taken when modifying the segmentation criteria, that is, when adding contacts to the segment, refining, or reducing it.;
                           ESM=Especifica el n£mero de acciones realizadas al modificar los criterios de segmentaci¢n, es decir, al agregar contactos al segmento, redefinirlo o reducirlo.;
                           FRC=Sp‚cifie le nombre d'actions que vous avez effectu‚es en modifiant les critŠres de segmentation, c'est-…-dire lorsque vous avez ajout‚, r‚duit ou red‚fini les contacts du segment.;
                           ENC=Specifies the number of actions you have taken when modifying the segmentation criteria, that is, when adding contacts to the segment, refining, or reducing it.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No. of Criteria Actions" }

    { 21  ;1   ;Part      ;
                Name=SegLines;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=Segment No.=FIELD(No.);
                PagePartID=Page5092;
                PartType=Page }

    { 1907335101;1;Group  ;
                CaptionML=[ENU=Interaction;
                           ESM=Interacci¢n;
                           FRC=Interaction;
                           ENC=Interaction] }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the interaction template code of the interaction involving the segment.;
                           ESM=Especifica el c¢digo de la plantilla de interacci¢n correspondiente a la interacci¢n relacionada con el segmento.;
                           FRC=Sp‚cifie le code modŠle interaction de l'interaction impliquant le segment.;
                           ENC=Specifies the interaction template code of the interaction involving the segment.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Interaction Template Code";
                OnValidate=BEGIN
                             InteractionTemplateCodeOnAfter;
                           END;
                            }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the language code for the segment.;
                           ESM=Especifica el c¢digo de idioma del segmento.;
                           FRC=Sp‚cifie le code de langue pour le segment.;
                           ENC=Specifies the language code for the segment.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Language Code (Default)";
                Enabled=LanguageCodeDefaultEnable;
                OnValidate=BEGIN
                             LanguageCodeDefaultOnAfterVali;
                           END;
                            }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the subject of the segment. The text in the field is used as the subject in e-mails and in Word documents.;
                           ESM=Especifica el asunto del segmento. El texto de este campo se usa como asunto en los mensajes de correo electr¢nico y en los documentos de Word.;
                           FRC=Sp‚cifie l'objet du segment. Le texte du champ sert d'objet dans les courriels et les documents Word.;
                           ENC=Specifies the subject of the segment. The text in the field is used as the subject in e-mails and in Word documents.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Subject (Default)";
                Enabled=SubjectDefaultEnable;
                OnValidate=BEGIN
                             SubjectDefaultOnAfterValidate;
                           END;
                            }

    { 18  ;2   ;Field     ;
                Name=Attachment;
                AssistEdit=Yes;
                CaptionML=[ENU=Attachment;
                           ESM=Anexo;
                           FRC=PiŠce jointe;
                           ENC=Attachment];
                ToolTipML=[ENU=Specifies if the linked attachment is inherited or unique.;
                           ESM=Especifica si el archivo adjunto vinculado es heredado o £nico.;
                           FRC=Sp‚cifie si la piŠce jointe associ‚e est h‚rit‚e ou unique.;
                           ENC=Specifies if the linked attachment is inherited or unique.];
                ApplicationArea=#RelationshipMgmt;
                BlankZero=Yes;
                SourceExpr="Attachment No." > 0;
                Enabled=AttachmentEnable;
                OnAssistEdit=BEGIN
                               MaintainAttachment;
                               UpdateEditable;
                               CurrPage.SegLines.PAGE.UpdateForm;
                             END;
                              }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the correspondence type that you select in the Correspondence Type (Default) field should be used. If there is no check mark, the program uses the correspondence type selected on the Contact Card.;
                           ESM=Especifica que debe usarse el tipo de correspondencia que se selecciona en el campo Tipo correspondencia (Gen‚r.). Si la marca de verificaci¢n no est  activada, el programa usa el tipo de correspondencia seleccionado en Ficha contacto.;
                           FRC=Sp‚cifie le type de correspondance que vous s‚lectionnez dans le champ Type correspondance (par d‚faut). S'il est d‚sactiv‚, le programme utilise le type de correspondance s‚lectionn‚ sur la fiche contact.;
                           ENC=Specifies that the correspondence type that you select in the Correspondence Type (Default) field should be used. If there is no check mark, the program uses the correspondence type selected on the Contact Card.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ignore Contact Corres. Type";
                Enabled=IgnoreContactCorresTypeEnable;
                OnValidate=BEGIN
                             IgnoreContactCorresTypeOnAfter;
                           END;
                            }

    { 57  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the preferred type of correspondence for the interaction. NOTE: If you use the Web client, you must not select the Hard Copy option because printing is not possible from the web client.;
                           ESM=Especifica el tipo preferido de correspondencia para la interacci¢n. NOTA: Si usa el cliente Web, no debe seleccionar la opci¢n de impresi¢n porque no es posible imprimir desde el cliente web.;
                           FRC=Sp‚cifie le type de correspondance favori pour l'interaction. REMARQUEÿ: Si vous utilisez le client Web, vous ne devez pas s‚lectionner l'option Impression car il est impossible d'imprimer … partir du client Web.;
                           ENC=Specifies the preferred type of correspondence for the interaction. NOTE: If you use the Web client, you must not select the Hard Copy option because printing is not possible from the web client.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Correspondence Type (Default)";
                Enabled=CorrespondenceTypeDefaultEnabl;
                OnValidate=BEGIN
                             CorrespondenceTypeDefaultOnAft;
                           END;
                            }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direction of the information that is part of the interaction created for the segment. There are two options: Inbound and Outbound.;
                           ESM=Especifica la direcci¢n de la informaci¢n que forma parte de la interacci¢n creada para el segmento. Existen dos opciones: Entrada y Salida.;
                           FRC=Sp‚cifie la direction des informations faisant partie de l'interaction cr‚‚e pour le segment. Deux options sont disponiblesÿ: Entrant et Sortant.;
                           ENC=Specifies the direction of the information that is part of the interaction created for the segment. There are two options: Inbound and Outbound.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Information Flow";
                Enabled=InformationFlowEnable;
                OnValidate=BEGIN
                             InformationFlowOnAfterValidate;
                           END;
                            }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU="Specifies whether the interaction recorded for this segment was initiated by your company or by one of your contacts. The Us option indicates that your company was the initiator; the Them option indicates that a contact was the initiator.";
                           ESM="Especifica si su empresa (o uno de sus contactos) inici¢ la interacci¢n registrada para este segmento. La opci¢n Nosotros indica que la inicio su empresa; la opci¢n Ellos indica que la inici¢ un contacto.";
                           FRC="Sp‚cifie si l'interaction enregistr‚e pour ce segment a ‚t‚ initi‚e par votre compagnie ou par l'un de vos contacts. L'option Notre compagnie indique que votre compagnie a initi‚ l'interactionÿ; l'option Le contact indique qu'un contact a initi‚ l'interaction.";
                           ENC="Specifies whether the interaction recorded for this segment was initiated by your company or by one of your contacts. The Us option indicates that your company was the initiator; the Them option indicates that a contact was the initiator."];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Initiated By";
                Enabled=InitiatedByEnable;
                OnValidate=BEGIN
                             InitiatedByOnAfterValidate;
                           END;
                            }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cost, in $, of one unit of the item or resource on the line.;
                           ESM=Especifica el costo, en $, de una unidad del producto o del recurso en la l¡nea.;
                           FRC=Sp‚cifie le co–t, en $, d'une unit‚ de l'article ou de la ressource sur la ligne.;
                           ENC=Specifies the cost, in $, of one unit of the item or resource on the line.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Unit Cost (LCY)";
                Enabled=UnitCostLCYEnable;
                OnValidate=BEGIN
                             UnitCostLCYOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the duration of a single interaction created for this segment.;
                           ESM=Especifica la duraci¢n de una £nica interacci¢n creada para este segmento.;
                           FRC=Sp‚cifie la dur‚e d'une interaction cr‚‚e pour ce segment.;
                           ENC=Specifies the duration of a single interaction created for this segment.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Unit Duration (Min.)";
                Enabled=UnitDurationMinEnable;
                OnValidate=BEGIN
                             UnitDurationMinOnAfterValidate;
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the Microsoft Word document should be sent as an attachment in the e-mail message.;
                           ESM=Especifica que el documento de Microsoft Word se debe enviar como archivo adjunto en el mensaje de correo electr¢nico.;
                           FRC=Sp‚cifie que le document MicrosoftÿWord doit ˆtre envoy‚ comme piŠce jointe dans un courriel.;
                           ENC=Specifies that the Microsoft Word document should be sent as an attachment in the e-mail message.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Send Word Docs. as Attmt.";
                OnValidate=BEGIN
                             SendWordDocsasAttmtOnAfterVali;
                           END;
                            }

    { 1900598201;1;Group  ;
                CaptionML=[ENU=Campaign;
                           ESM=Campa¤a;
                           FRC=Promotion;
                           ENC=Campaign] }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign for which the segment has been created.;
                           ESM=Especifica el n£mero de la campa¤a para la que se cre¢ el segmento.;
                           FRC=Sp‚cifie le num‚ro de la promotion pour laquelle le segment a ‚t‚ cr‚‚.;
                           ENC=Specifies the number of the campaign for which the segment has been created.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign No.";
                OnValidate=BEGIN
                             CampaignNoOnAfterValidate;
                           END;
                            }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the campaign to which the segment is related. The description is copied from the campaign card.;
                           ESM=Especifica una descripci¢n de la campa¤a relacionada con el segmento. La descripci¢n se copia desde la ficha de campa¤a.;
                           FRC=Sp‚cifie une description de la promotion … laquelle le segment est associ‚. La description est copi‚e depuis la fiche promotion.;
                           ENC=Specifies a description of the campaign to which the segment is related. The description is copied from the campaign card.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Description";
                Editable=FALSE }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the segment is part of the target of the campaign to which it is linked.;
                           ESM=Especifica que el segmento forma parte del objetivo de la campa¤a a la que est  vinculado.;
                           FRC=Sp‚cifie que le segment fait partie de la cible de la promotion … laquelle il est li‚.;
                           ENC=Specifies that the segment is part of the target of the campaign to which it is linked.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Target";
                Enabled=CampaignTargetEnable;
                OnValidate=BEGIN
                             CampaignTargetOnAfterValidate;
                           END;
                            }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the interaction created for the segment is the response to a campaign.;
                           ESM=Especifica que la interacci¢n creada para el segmento es la respuesta a una campa¤a.;
                           FRC=Sp‚cifie que l'interaction cr‚‚e pour le segment est la r‚ponse … une promotion.;
                           ENC=Specifies that the interaction created for the segment is the response to a campaign.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Response";
                Enabled=CampaignResponseEnable;
                OnValidate=BEGIN
                             CampaignResponseOnAfterValidat;
                           END;
                            }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text011@1011 : TextConst 'ENU=Segment %1 has been logged.;ESM=Se ha registrado el segmento %1.;FRC=Le segment %1 a ‚t‚ enregistr‚.;ENC=Segment %1 has been logged.';
      Text012@1013 : TextConst 'ENU=This will undo the last criteria action.\Do you want to continue?;ESM=Esto deshar  la acci¢n del £ltimo criterio.\¨Desea continuar?;FRC=Cela va entraŒner la suppression de la derniŠre action du critŠre.\Voulez-vous continuer?;ENC=This will undo the last criteria action.\Do you want to continue?';
      CampaignTargetEnable@19064124 : Boolean INDATASET;
      CampaignResponseEnable@19042996 : Boolean INDATASET;
      CorrespondenceTypeDefaultEnabl@19017412 : Boolean INDATASET;
      SubjectDefaultEnable@19030726 : Boolean INDATASET;
      LanguageCodeDefaultEnable@19053468 : Boolean INDATASET;
      AttachmentEnable@19033701 : Boolean INDATASET;
      IgnoreContactCorresTypeEnable@19029068 : Boolean INDATASET;
      InformationFlowEnable@19076079 : Boolean INDATASET;
      InitiatedByEnable@19020183 : Boolean INDATASET;
      UnitCostLCYEnable@19056514 : Boolean INDATASET;
      UnitDurationMinEnable@19041420 : Boolean INDATASET;
      CreateOppQst@1000 : TextConst 'ENU=Do you want to create an opportunity for all contacts in segment?;ESM=¨Desea crear una oportunidad en todos los contactos del segmento?;FRC=Souhaitez-vous cr‚er une opportunit‚ pour tous les contacts du segmentÿ?;ENC=Do you want to create an opportunity for all contacts in segment?';
      ExportContactsVisible@1001 : Boolean;

    LOCAL PROCEDURE UpdateEditable@4();
    VAR
      SegInteractLanguage@1000 : Record 5104;
    BEGIN
      CampaignTargetEnable := "Campaign No." <> '';
      CampaignResponseEnable := "Campaign No." <> '';
      CorrespondenceTypeDefaultEnabl := "Ignore Contact Corres. Type" = TRUE;
      LanguageCodeDefaultEnable := "Interaction Template Code" <> '';
      SubjectDefaultEnable := SegInteractLanguage.GET("No.",0,"Language Code (Default)");
      AttachmentEnable := "Interaction Template Code" <> '';
      IgnoreContactCorresTypeEnable := "Interaction Template Code" <> '';
      InformationFlowEnable := "Interaction Template Code" <> '';
      InitiatedByEnable := "Interaction Template Code" <> '';
      UnitCostLCYEnable := "Interaction Template Code" <> '';
      UnitDurationMinEnable := "Interaction Template Code" <> '';
      LanguageCodeDefaultEnable := "Interaction Template Code" <> '';
    END;

    LOCAL PROCEDURE DateOnAfterValidate@19027017();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE DescriptionOnAfterValidate@19030973();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InteractionTemplateCodeOnAfter@19000597();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InformationFlowOnAfterValidate@19041099();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InitiatedByOnAfterValidate@19049832();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE UnitCostLCYOnAfterValidate@19001329();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE UnitDurationMinOnAfterValidate@19023271();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CorrespondenceTypeDefaultOnAft@19059490();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SendWordDocsasAttmtOnAfterVali@19026152();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE LanguageCodeDefaultOnAfterVali@19033064();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE IgnoreContactCorresTypeOnAfter@19053741();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SubjectDefaultOnAfterValidate@19032581();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignResponseOnAfterValidat@19031993();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignTargetOnAfterValidate@19073096();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignNoOnAfterValidate@19036822();
    BEGIN
      IF "Campaign No." = '' THEN BEGIN
        "Campaign Target" := FALSE;
        "Campaign Response" := FALSE;
      END;

      CALCFIELDS("Campaign Description");
      CampaignTargetEnable := "Campaign No." <> '';
      CampaignResponseEnable := "Campaign No." <> '';
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CreateOpportunitiesForAllContacts@1();
    BEGIN
      IF CONFIRM(CreateOppQst) THEN
        CreateOpportunities;
    END;

    BEGIN
    END.
  }
}

