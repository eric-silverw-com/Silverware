OBJECT Table 730 Standard Address
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00,NAVNA13.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF NOT ISTEMPORARY THEN
                 ERROR(DevMsgNotTemporaryErr);
             END;

    CaptionML=[ENU=Standard Address;
               ESM=Direcci¢n est ndar;
               FRC=Adresse standard;
               ENC=Standard Address];
  }
  FIELDS
  {
    { 1   ;   ;Related RecordID    ;RecordID      ;DataClassification=SystemMetadata;
                                                   CaptionML=[ENU=Related RecordID;
                                                              ESM=RecordID relacionado;
                                                              FRC=RecordID associ‚;
                                                              ENC=Related RecordID] }
    { 2   ;   ;Address Type        ;Option        ;CaptionML=[ENU=Address Type;
                                                              ESM=Tipo de direcci¢n;
                                                              FRC=Type d'adresse;
                                                              ENC=Address Type];
                                                   OptionCaptionML=[ENU=" ,Sell-to,Bill-to";
                                                                    ESM=" ,Vender-a,Facturar-a";
                                                                    FRC=" ,D‚biteur,Facturation";
                                                                    ENC=" ,Sell-to,Bill-to"];
                                                   OptionString=[ ,Sell-to,Bill-to] }
    { 3   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              ESM=Direcci¢n;
                                                              FRC=Adresse;
                                                              ENC=Address] }
    { 4   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              ESM=Colonia 2;
                                                              FRC=Adresseÿ2;
                                                              ENC=Address 2] }
    { 5   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=VAR
                                                                O365SalesInitialSetup@1020001 : Record 2110;
                                                                CountryRegionCode@1020000 : Code[10];
                                                              BEGIN
                                                                IF O365SalesInitialSetup.GET AND O365SalesInitialSetup."Is initialized" THEN BEGIN
                                                                  CountryRegionCode := "Country/Region Code";
                                                                  PostCode.ValidatePostCode(City,"Post Code",County,CountryRegionCode,(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                  EXIT;
                                                                END;

                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              ESM=Municipio/Ciudad;
                                                              FRC=Ville;
                                                              ENC=City] }
    { 6   ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ESM=C¢digo pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion;
                                                              ENC=Country/Region Code] }
    { 7   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=VAR
                                                                O365SalesInitialSetup@1020001 : Record 2110;
                                                                CountryRegionCode@1020000 : Code[10];
                                                              BEGIN
                                                                IF O365SalesInitialSetup.GET AND O365SalesInitialSetup."Is initialized" THEN BEGIN
                                                                  CountryRegionCode := "Country/Region Code";
                                                                  PostCode.ValidatePostCode(City,"Post Code",County,CountryRegionCode,(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                  EXIT;
                                                                END;

                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=ZIP Code;
                                                              ESM=C¢digo postal;
                                                              FRC=Code postal;
                                                              ENC=Postal/ZIP Code] }
    { 8   ;   ;County              ;Text30        ;CaptionML=[ENU=State;
                                                              ESM=Provincia;
                                                              FRC=Comt‚;
                                                              ENC=Province/State];
                                                   CaptionClass='5,1,' + "Country/Region Code" }
  }
  KEYS
  {
    {    ;Related RecordID                        ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PostCode@1000 : Record 225;
      DevMsgNotTemporaryErr@1001 : TextConst 'ENU=This function can only be used when the record is temporary.;ESM=Esta funci¢n solo se puede usar cuando el registro es temporal.;FRC=Cette fonction ne peut ˆtre utilis‚e que lorsque l''enregistrement est temporaire.;ENC=This function can only be used when the record is temporary.';
      FormatAddress@1002 : Codeunit 365;

    PROCEDURE ToString@5() FullAddress : Text;
    VAR
      AddressArray@1001 : ARRAY [8] OF Text[90];
      AddressPosition@1000 : Integer;
    BEGIN
      FormatAddress.FormatAddr(AddressArray,'','','',Address,"Address 2",City,"Post Code",County,"Country/Region Code");
      FOR AddressPosition := 1 TO 8 DO BEGIN
        AddressArray[AddressPosition] := DELCHR(AddressArray[AddressPosition],'<',', ');
        IF AddressArray[AddressPosition] <> '' THEN BEGIN
          IF FullAddress = '' THEN
            FullAddress := AddressArray[AddressPosition]
          ELSE
            FullAddress += ', ' + AddressArray[AddressPosition]
        END;
      END;
    END;

    PROCEDURE CopyFromCustomer@2(Customer@1000 : Record 18);
    BEGIN
      INIT;
      "Related RecordID" := Customer.RECORDID;
      Address := Customer.Address;
      "Address 2" := Customer."Address 2";
      City := Customer.City;
      "Country/Region Code" := Customer."Country/Region Code";
      "Post Code" := Customer."Post Code";
      County := Customer.County;
      INSERT(TRUE);
    END;

    PROCEDURE CopyFromCompanyInformation@6(CompanyInformation@1000 : Record 79);
    BEGIN
      INIT;
      "Related RecordID" := CompanyInformation.RECORDID;
      Address := CompanyInformation.Address;
      "Address 2" := CompanyInformation."Address 2";
      City := CompanyInformation.City;
      "Country/Region Code" := CompanyInformation."Country/Region Code";
      "Post Code" := CompanyInformation."Post Code";
      County := CompanyInformation.County;
      INSERT(TRUE);
    END;

    PROCEDURE CopyFromSalesHeaderSellTo@7(SalesHeader@1000 : Record 36);
    BEGIN
      INIT;
      "Address Type" := "Address Type"::"Sell-to";
      "Related RecordID" := SalesHeader.RECORDID;
      Address := SalesHeader."Sell-to Address";
      "Address 2" := SalesHeader."Sell-to Address 2";
      City := SalesHeader."Sell-to City";
      "Country/Region Code" := SalesHeader."Sell-to Country/Region Code";
      "Post Code" := SalesHeader."Sell-to Post Code";
      County := SalesHeader."Sell-to County";
      INSERT(TRUE);
    END;

    PROCEDURE CopyFromSalesInvoiceHeaderSellTo@11(SalesInvoiceHeader@1000 : Record 112);
    BEGIN
      INIT;
      "Address Type" := "Address Type"::"Sell-to";
      "Related RecordID" := SalesInvoiceHeader.RECORDID;
      Address := SalesInvoiceHeader."Sell-to Address";
      "Address 2" := SalesInvoiceHeader."Sell-to Address 2";
      City := SalesInvoiceHeader."Sell-to City";
      "Country/Region Code" := SalesInvoiceHeader."Sell-to Country/Region Code";
      "Post Code" := SalesInvoiceHeader."Sell-to Post Code";
      County := SalesInvoiceHeader."Sell-to County";
      INSERT(TRUE);
    END;

    PROCEDURE SaveToRecord@1();
    VAR
      RecID@1001 : RecordID;
    BEGIN
      RecID := "Related RecordID";
      CASE RecID.TABLENO OF
        DATABASE::Customer:
          SaveToCustomer;
        DATABASE::"Company Information":
          SaveToCompanyInformation;
        DATABASE::"Sales Header":
          CASE "Address Type" OF
            "Address Type"::"Sell-to":
              SaveToSalesHeaderSellTo;
          END;
      END;
    END;

    LOCAL PROCEDURE SaveToCustomer@3();
    VAR
      Customer@1000 : Record 18;
    BEGIN
      Customer.LOCKTABLE;
      Customer.GET("Related RecordID");
      Customer.VALIDATE(Address,Address);
      Customer.VALIDATE("Address 2","Address 2");
      Customer.VALIDATE(City,City);
      Customer.VALIDATE("Country/Region Code","Country/Region Code");
      Customer.VALIDATE("Post Code","Post Code");
      Customer.VALIDATE(County,County);
      Customer.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE SaveToCompanyInformation@4();
    VAR
      CompanyInformation@1001 : Record 79;
    BEGIN
      CompanyInformation.LOCKTABLE;
      CompanyInformation.GET("Related RecordID");
      CompanyInformation.VALIDATE(Address,Address);
      CompanyInformation.VALIDATE("Address 2","Address 2");
      CompanyInformation.VALIDATE(City,City);
      CompanyInformation.VALIDATE("Country/Region Code","Country/Region Code");
      CompanyInformation.VALIDATE("Post Code","Post Code");
      CompanyInformation.VALIDATE(County,County);
      CompanyInformation.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE SaveToSalesHeaderSellTo@8();
    VAR
      SalesHeader@1001 : Record 36;
    BEGIN
      SalesHeader.LOCKTABLE;
      SalesHeader.GET("Related RecordID");
      SalesHeader.VALIDATE("Sell-to Address",Address);
      SalesHeader.VALIDATE("Sell-to Address 2","Address 2");
      SalesHeader.VALIDATE("Sell-to City",City);
      SalesHeader.VALIDATE("Sell-to Country/Region Code","Country/Region Code");
      SalesHeader.VALIDATE("Sell-to Post Code","Post Code");
      SalesHeader.VALIDATE("Sell-to County",County);
      SalesHeader.MODIFY(TRUE);
    END;

    BEGIN
    END.
  }
}

