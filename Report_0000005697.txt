OBJECT Report 5697 Date Compress Insurance Ledger
{
  OBJECT-PROPERTIES
  {
    Date=09/19/18;
    Time=12:00:00 PM;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    Permissions=TableData 87=rimd,
                TableData 355=imd,
                TableData 5629=rimd,
                TableData 5636=rimd;
    CaptionML=[ENU=Date Compress Insurance Ledger;
               ESM=Compactar por fechas movs. seguro;
               FRC=Compr. date Çcritures assur.;
               ENC=Date Compress Insurance Ledger];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  DimSelectionBuf.CompareDimText(
                    3,REPORT::"Date Compress Insurance Ledger",'',RetainDimText,Text010);
                  InsCoverageLedgEntryFilter := COPYSTR("Ins. Coverage Ledger Entry".GETFILTERS,1,MAXSTRLEN(DateComprReg.Filter));
                END;

  }
  DATASET
  {
    { 8513;    ;DataItem;                    ;
               DataItemTable=Table5629;
               DataItemTableView=SORTING(FA No.,Insurance No.,Disposed FA);
               OnPreDataItem=VAR
                               GLSetup@1000 : Record 98;
                             BEGIN
                               IF NOT CONFIRM(Text000,FALSE) THEN
                                 CurrReport.BREAK;

                               IF EntrdDateComprReg."Ending Date" = 0D THEN
                                 ERROR(Text003,EntrdDateComprReg.FIELDCAPTION("Ending Date"));

                               Window.OPEN(
                                 Text004 +
                                 Text005 +
                                 Text006 +
                                 Text007 +
                                 Text008);

                               SourceCodeSetup.GET;
                               SourceCodeSetup.TESTFIELD("Compress Insurance Ledger");

                               SelectedDim.GetSelectedDim(
                                 USERID,3,REPORT::"Date Compress Insurance Ledger",'',TempSelectedDim);
                               GLSetup.GET;
                               Retain[2] :=
                                 TempSelectedDim.GET(
                                   USERID,3,REPORT::"Date Compress Insurance Ledger",'',GLSetup."Global Dimension 1 Code");
                               Retain[3] :=
                                 TempSelectedDim.GET(
                                   USERID,3,REPORT::"Date Compress Insurance Ledger",'',GLSetup."Global Dimension 2 Code");

                               NewInsCoverageLedgEntry.LOCKTABLE;
                               InsuranceReg.LOCKTABLE;
                               DateComprReg.LOCKTABLE;

                               IF InsCoverageLedgEntry2.FIND('+') THEN;
                               LastEntryNo := InsCoverageLedgEntry2."Entry No.";
                               SETRANGE("Entry No.",0,LastEntryNo);
                               SETRANGE("Posting Date",EntrdDateComprReg."Starting Date",EntrdDateComprReg."Ending Date");

                               InitRegisters;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF ("Insurance No." <> '') AND OnlyIndexEntries AND NOT "Index Entry" THEN
                                    CurrReport.SKIP;
                                  InsCoverageLedgEntry2 := "Ins. Coverage Ledger Entry";
                                  WITH InsCoverageLedgEntry2 DO BEGIN
                                    SETCURRENTKEY("FA No.","Insurance No.");
                                    COPYFILTERS("Ins. Coverage Ledger Entry");

                                    SETRANGE("Insurance No.","Insurance No.");
                                    SETRANGE("FA No.","FA No.");
                                    SETRANGE("Document Type","Document Type");
                                    SETRANGE("Index Entry","Index Entry");
                                    SETRANGE("Disposed FA","Disposed FA");
                                    SETFILTER("Posting Date",DateComprMgt.GetDateFilter("Posting Date",EntrdDateComprReg,TRUE));

                                    IF RetainNo(FIELDNO("Document No.")) THEN
                                      SETRANGE("Document No.","Document No.");
                                    IF RetainNo(FIELDNO("Global Dimension 1 Code")) THEN
                                      SETRANGE("Global Dimension 1 Code","Global Dimension 1 Code");
                                    IF RetainNo(FIELDNO("Global Dimension 2 Code")) THEN
                                      SETRANGE("Global Dimension 2 Code","Global Dimension 2 Code");

                                    InitNewEntry(NewInsCoverageLedgEntry);

                                    DimBufMgt.CollectDimEntryNo(
                                      TempSelectedDim,"Dimension Set ID","Entry No.",
                                      0,FALSE,DimEntryNo);
                                    ComprDimEntryNo := DimEntryNo;
                                    SummarizeEntry(NewInsCoverageLedgEntry,InsCoverageLedgEntry2);
                                    WHILE NEXT <> 0 DO BEGIN
                                      DimBufMgt.CollectDimEntryNo(
                                        TempSelectedDim,"Dimension Set ID","Entry No.",
                                        ComprDimEntryNo,TRUE,DimEntryNo);
                                      IF DimEntryNo = ComprDimEntryNo THEN
                                        SummarizeEntry(NewInsCoverageLedgEntry,InsCoverageLedgEntry2);
                                    END;

                                    InsertNewEntry(NewInsCoverageLedgEntry,ComprDimEntryNo);

                                    ComprCollectedEntries;
                                  END;

                                  IF DateComprReg."No. Records Deleted" >= NoOfDeleted + 10 THEN BEGIN
                                    NoOfDeleted := DateComprReg."No. Records Deleted";
                                    InsertRegisters(InsuranceReg,DateComprReg);
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                IF DateComprReg."No. Records Deleted" > NoOfDeleted THEN
                                  InsertRegisters(InsuranceReg,DateComprReg);
                              END;

               ReqFilterFields=Insurance No.,FA No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF EntrdDateComprReg."Ending Date" = 0D THEN
                     EntrdDateComprReg."Ending Date" := TODAY;
                   IF EntrdInsCoverageLedgEntry.Description = '' THEN
                     EntrdInsCoverageLedgEntry.Description := Text009;

                   WITH "Ins. Coverage Ledger Entry" DO BEGIN
                     InsertField(FIELDNO("Document No."),FIELDCAPTION("Document No."));
                     InsertField(FIELDNO("Global Dimension 1 Code"),FIELDCAPTION("Global Dimension 1 Code"));
                     InsertField(FIELDNO("Global Dimension 2 Code"),FIELDCAPTION("Global Dimension 2 Code"));
                   END;

                   RetainDimText := DimSelectionBuf.GetDimSelectionText(3,REPORT::"Date Compress Insurance Ledger",'');
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESM=Opciones;
                             FRC=Options;
                             ENC=Options] }

      { 1   ;2   ;Field     ;
                  Name=StartingDate;
                  CaptionML=[ENU=Starting Date;
                             ESM=Fecha inicial;
                             FRC=Date dÇbut;
                             ENC=Starting Date];
                  ToolTipML=[ENU=Specifies the date from which the report or batch job processes information.;
                             ESM=Especifica la fecha a partir de la cual el informe o el trabajo por lotes procesa la informaci¢n.;
                             FRC=SpÇcifie la date Ö partir de laquelle le rapport ou le traitement en lot traite les informations.;
                             ENC=Specifies the date from which the report or batch job processes information.];
                  ApplicationArea=#Suite;
                  SourceExpr=EntrdDateComprReg."Starting Date" }

      { 2   ;2   ;Field     ;
                  Name=EndingDate;
                  CaptionML=[ENU=Ending Date;
                             ESM=Fecha final;
                             FRC=Date fin;
                             ENC=Ending Date];
                  ToolTipML=[ENU=Specifies the date to which the report or batch job processes information.;
                             ESM=Especifica la fecha hasta la cual el informe o trabajo por lotes procesa la informaci¢n.;
                             FRC=SpÇcifie la date jusqu'Ö laquelle le rapport ou le traitement en lot traite les informations.;
                             ENC=Specifies the date to which the report or batch job processes information.];
                  ApplicationArea=#Suite;
                  SourceExpr=EntrdDateComprReg."Ending Date" }

      { 3   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=[ENU=Period Length;
                             ESM=Longitud periodo;
                             FRC=DurÇe de la pÇriode;
                             ENC=Period Length];
                  ToolTipML=[ENU=Specifies the period for which data is shown in the report. For example, enter "1M" for one month, "30D" for thirty days, "3Q" for three quarters, or "5Y" for five years.;
                             ESM=Especifica el per°odo para el que se muestran datos en el informe. Por ejemplo, indique "1M" para un mes, "30D" para 30 d°as, "3T" para tres trimestres o "5A" para cinco a§os.;
                             FRC=SpÇcifie la pÇriode pour laquelle les donnÇes sont affichÇes dans le rapport. Par exemple, saisissez Æˇ1MˇØ pour un mois, Æˇ30DˇØ pour trente jours, Æˇ3QˇØ pour trois trimestres ou Æˇ5YˇØ pour cinq annÇes.;
                             ENC=Specifies the period for which data is shown in the report. For example, enter "1M" for one month, "30D" for thirty days, "3Q" for three quarters, or "5Y" for five years.];
                  OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Period;
                                   ESM=D°a,Semana,Mes,Trimestre,A§o,Periodo;
                                   FRC=Jour,Semaine,Mois,Trimestre,AnnÇe,PÇriode;
                                   ENC=Day,Week,Month,Quarter,Year,Period];
                  ApplicationArea=#Suite;
                  SourceExpr=EntrdDateComprReg."Period Length" }

      { 4   ;2   ;Field     ;
                  Name=PostingDescription;
                  CaptionML=[ENU=Posting Description;
                             ESM=Texto de registro;
                             FRC=Description du report;
                             ENC=Posting Description];
                  ToolTipML=[ENU=Specifies the posting date to be used by the batch job as a filter.;
                             ESM=Especifica la fecha de registro que el proceso va a usar como filtro.;
                             FRC=SpÇcifie la date de report qui doit àtre utilisÇe par le traitement en lot comme filtre.;
                             ENC=Specifies the posting date to be used by the batch job as a filter.];
                  ApplicationArea=#FixedAssets;
                  SourceExpr=EntrdInsCoverageLedgEntry.Description }

      { 6   ;2   ;Field     ;
                  Name=OnlyIndexEntries;
                  CaptionML=[ENU=Only Index Entries;
                             ESM=S¢lo movs. valor ajuste;
                             FRC=êcritures indexÇes seulement;
                             ENC=Only Index Entries];
                  ToolTipML=[ENU=Specifies if only index entries are date compressed. With the Index Fixed Assets batch job, you can index fixed assets that are linked to a specific depreciation book. The batch job creates entries in a journal based on the conditions that you specify. You can then post the journal or adjust the entries before posting, if necessary.;
                             ESM=Especifica si solo se comprimen por fechas los movimientos de valor de ajuste. Con el proceso Ajustar valores activos fijos puede ajustar los valores de los activos vinculados a un libro de amortizaci¢n espec°fico. El proceso crea movimientos en un diario en funci¢n de las condiciones que especifique. DespuÇs, si es necesario, registre el diario o ajuste los movimientos.;
                             FRC=SpÇcifie si seules les Çcritures rÇÇvaluation sont compressÇes. Avec le traitement en lot Actualiser immobilisations, vous pouvez rÇÇvaluer les immobilisations liÇes Ö un registre amortissement spÇcifique. Le traitement en lot crÇe des Çcritures dans un journal en se basant sur les conditions que vous spÇcifiez. Vous pouvez alors reporter le journal ou ajuster les Çcritures avant le report, si nÇcessaire.;
                             ENC=Specifies if only index entries are date compressed. With the Index Fixed Assets batch job, you can index fixed assets that are linked to a specific depreciation book. The batch job creates entries in a journal based on the conditions that you specify. You can then post the journal or adjust the entries before posting, if necessary.];
                  ApplicationArea=#FixedAssets;
                  SourceExpr=OnlyIndexEntries }

      { 1907651001;2;Group  ;
                  CaptionML=[ENU=Retain Field Contents;
                             ESM=Guardar contenido campo;
                             FRC=Conserver champ;
                             ENC=Retain Field Contents] }

      { 5   ;3   ;Field     ;
                  Name=DocumentNo;
                  CaptionML=[ENU=Document No.;
                             ESM=Nß documento;
                             FRC=N¯ de document;
                             ENC=Document No.];
                  ToolTipML=[ENU=Specifies, if you leave the field empty, the next available number on the resulting journal line. If a number series is not set up, enter the document number that you want assigned to the resulting journal line.;
                             ESM=Especifica, si deja el campo vac°o, el siguiente n£mero disponible en la l°nea del diario resultante. Si no se configura una serie numÇrica, escriba el n£mero de documento que desea asignar a la l°nea del diario resultante.;
                             FRC=Indique, si vous laissez le champ vide, le numÇro suivant disponible sur la ligne journal rÇsultante. Si un numÇro de sÇrie n'est pas configurÇ, entrez le numÇro de document que vous souhaitez affecter Ö la ligne journal rÇsultante.;
                             ENC=Specifies, if you leave the field empty, the next available number on the resulting journal line. If a number series is not set up, enter the document number that you want assigned to the resulting journal line.];
                  ApplicationArea=#FixedAssets;
                  SourceExpr=Retain[1] }

      { 8   ;2   ;Field     ;
                  Name=RetainDimensions;
                  CaptionML=[ENU=Retain Dimensions;
                             ESM=Retener dimensiones;
                             FRC=Conserver les dimensions;
                             ENC=Retain Dimensions];
                  ToolTipML=[ENU=Specifies which dimension information you want to retain when the entries are compressed. The more dimension information that you choose to retain, the more detailed the compressed entries are.;
                             ESM=Especifica la informaci¢n de dimensi¢n que desea conservar cuando se compriman los movimientos. Cuanta m†s informaci¢n de dimensi¢n elija conservar, m†s detallados ser†n los movimientos comprimidos.;
                             FRC=SpÇcifie les informations analytiques Ö conserver une fois les Çcritures compressÇes. Plus vous choisissez de champs Ö conserver, plus les Çcritures compressÇes sont dÇtaillÇes.;
                             ENC=Specifies which dimension information you want to retain when the entries are compressed. The more dimension information that you choose to retain, the more detailed the compressed entries are.];
                  ApplicationArea=#Dimensions;
                  SourceExpr=RetainDimText;
                  Editable=FALSE;
                  OnAssistEdit=BEGIN
                                 DimSelectionBuf.SetDimSelectionMultiple(3,REPORT::"Date Compress Insurance Ledger",RetainDimText);
                               END;
                                }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=This batch job deletes entries. Therefore, it is important that you make a backup of the database before you run the batch job.\\Do you want to date compress the entries?;ESM=Este trabajo por lotes borra movimientos. Por tanto, es muy importante realizar una copia de seguridad de la base de datos antes de ejecutar el trabajo por lotes.\\®Desea eliminar las fechas de los movimientos?;FRC=Ce traitement en lot supprime des Çcritures. Par consÇquent, il est important d''effectuer une sauvegarde de la base de donnÇes avant d''exÇcuter le traitement en lot.\\Voulez-vous compresser les Çcrituresˇ?;ENC=This batch job deletes entries. Therefore, it is important that you make a backup of the database before you run the batch job.\\Do you want to date compress the entries?';
      Text003@1003 : TextConst 'ENU=%1 must be specified.;ESM=Se debe indicar %1.;FRC=%1 doit àtre spÇcifiÇ.;ENC=%1 must be specified.';
      Text004@1004 : TextConst 'ENU=Date compressing insurance ledger entries...\\;ESM=Compactando por fechas movs. seguro...\\;FRC=Compression par date des Çcritures assurances...\\;ENC=Date compressing insurance ledger entries...\\';
      Text005@1005 : TextConst 'ENU=Insurance No.        #1##########\;ESM=Nß seguro            #1##########\;FRC=N¯ assurance                #1##########\;ENC=Insurance No.        #1##########\';
      Text006@1006 : TextConst 'ENU=Date                 #2######\\;ESM=Fecha                #2######\\;FRC=Date                        #2######\\;ENC=Date                 #2######\\';
      Text007@1007 : TextConst 'ENU=No. of new entries   #3######\;ESM=Nuevo nß movs.       #3######\;FRC=Nbre nouvelles Çcritures    #3######\;ENC=No. of new entries   #3######\';
      Text008@1008 : TextConst 'ENU=No. of entries del.  #4######;ESM=Nß movs. borrados    #4######;FRC=Nbre d''Çcritures supprimÇes #4######;ENC=No. of entries del.  #4######';
      Text009@1009 : TextConst 'ENU=Date Compressed;ESM=Compactado por fechas;FRC=CompressÇ par date;ENC=Date Compressed';
      Text010@1010 : TextConst 'ENU=Retain Dimensions;ESM=Retener dimensiones;FRC=Conserver les dimensions;ENC=Retain Dimensions';
      SourceCodeSetup@1011 : Record 242;
      DateComprReg@1012 : Record 87;
      EntrdDateComprReg@1013 : Record 87;
      InsuranceReg@1014 : Record 5636;
      EntrdInsCoverageLedgEntry@1015 : Record 5629;
      NewInsCoverageLedgEntry@1016 : Record 5629;
      InsCoverageLedgEntry2@1017 : Record 5629;
      SelectedDim@1018 : Record 369;
      TempSelectedDim@1019 : TEMPORARY Record 369;
      DimSelectionBuf@1020 : Record 368;
      DateComprMgt@1021 : Codeunit 356;
      DimBufMgt@1022 : Codeunit 411;
      DimMgt@1023 : Codeunit 408;
      Window@1024 : Dialog;
      InsCoverageLedgEntryFilter@1025 : Text[250];
      NoOfFields@1026 : Integer;
      Retain@1027 : ARRAY [10] OF Boolean;
      FieldNumber@1028 : ARRAY [10] OF Integer;
      FieldNameArray@1029 : ARRAY [10] OF Text[100];
      LastEntryNo@1030 : Integer;
      NoOfDeleted@1031 : Integer;
      InsuranceRegExists@1032 : Boolean;
      OnlyIndexEntries@1033 : Boolean;
      i@1034 : Integer;
      ComprDimEntryNo@1035 : Integer;
      DimEntryNo@1036 : Integer;
      RetainDimText@1037 : Text[250];

    LOCAL PROCEDURE InitRegisters@4();
    VAR
      NextRegNo@1000 : Integer;
    BEGIN
      IF InsuranceReg.FIND('+') THEN;
      InsuranceReg.INIT;
      InsuranceReg."No." := InsuranceReg."No." + 1;
      InsuranceReg."Creation Date" := TODAY;
      InsuranceReg."Source Code" := SourceCodeSetup."Compress Insurance Ledger";
      InsuranceReg."User ID" := USERID;
      InsuranceReg."From Entry No." := LastEntryNo + 1;

      IF DateComprReg.FINDLAST THEN
        NextRegNo := DateComprReg."No." + 1;

      DateComprReg.InitRegister(
        DATABASE::"Ins. Coverage Ledger Entry",NextRegNo,
        EntrdDateComprReg."Starting Date",EntrdDateComprReg."Ending Date",EntrdDateComprReg."Period Length",
        InsCoverageLedgEntryFilter,InsuranceReg."No.",SourceCodeSetup."Compress Insurance Ledger");

      FOR i := 1 TO NoOfFields DO
        IF Retain[i] THEN
          DateComprReg."Retain Field Contents" :=
            COPYSTR(
              DateComprReg."Retain Field Contents" + ',' + FieldNameArray[i],1,
              MAXSTRLEN(DateComprReg."Retain Field Contents"));
      DateComprReg."Retain Field Contents" := COPYSTR(DateComprReg."Retain Field Contents",2);

      InsuranceRegExists := FALSE;
      NoOfDeleted := 0;
    END;

    LOCAL PROCEDURE InsertRegisters@1(VAR InsuranceReg@1000 : Record 5636;VAR DateComprReg@1001 : Record 87);
    BEGIN
      InsuranceReg."To Entry No." := NewInsCoverageLedgEntry."Entry No.";

      IF InsuranceRegExists THEN BEGIN
        InsuranceReg.MODIFY;
        DateComprReg.MODIFY;
      END ELSE BEGIN
        InsuranceReg.INSERT;
        DateComprReg.INSERT;
        InsuranceRegExists := TRUE;
      END;
      COMMIT;

      NewInsCoverageLedgEntry.LOCKTABLE;
      InsuranceReg.LOCKTABLE;
      DateComprReg.LOCKTABLE;

      InsCoverageLedgEntry2.RESET;
      IF InsCoverageLedgEntry2.FIND('+') THEN;
      IF LastEntryNo <> InsCoverageLedgEntry2."Entry No." THEN BEGIN
        LastEntryNo := InsCoverageLedgEntry2."Entry No.";
        InitRegisters;
      END;
    END;

    LOCAL PROCEDURE InsertField@2(Number@1000 : Integer;Name@1001 : Text[100]);
    BEGIN
      NoOfFields := NoOfFields + 1;
      FieldNumber[NoOfFields] := Number;
      FieldNameArray[NoOfFields] := Name;
    END;

    LOCAL PROCEDURE RetainNo@3(Number@1000 : Integer) : Boolean;
    BEGIN
      EXIT(Retain[Index(Number)]);
    END;

    LOCAL PROCEDURE Index@6(Number@1000 : Integer) : Integer;
    BEGIN
      FOR i := 1 TO NoOfFields DO
        IF Number = FieldNumber[i] THEN
          EXIT(i);
    END;

    LOCAL PROCEDURE SummarizeEntry@5(VAR NewInsCoverageLedgEntry@1000 : Record 5629;InsCoverageLedgEntry@1001 : Record 5629);
    BEGIN
      WITH InsCoverageLedgEntry DO BEGIN
        NewInsCoverageLedgEntry.Amount := NewInsCoverageLedgEntry.Amount + Amount;
        DELETE;
        DateComprReg."No. Records Deleted" := DateComprReg."No. Records Deleted" + 1;
        Window.UPDATE(4,DateComprReg."No. Records Deleted");
      END;
    END;

    LOCAL PROCEDURE ComprCollectedEntries@12();
    VAR
      InsCoverageLedgEntry@1000 : Record 5629;
      OldDimEntryNo@1001 : Integer;
      Found@1002 : Boolean;
      InsCoverageLedgEntryNo@1003 : Integer;
    BEGIN
      OldDimEntryNo := 0;
      IF DimBufMgt.FindFirstDimEntryNo(DimEntryNo,InsCoverageLedgEntryNo) THEN BEGIN
        InitNewEntry(NewInsCoverageLedgEntry);
        REPEAT
          InsCoverageLedgEntry.GET(InsCoverageLedgEntryNo);
          SummarizeEntry(NewInsCoverageLedgEntry,InsCoverageLedgEntry);
          OldDimEntryNo := DimEntryNo;
          Found := DimBufMgt.NextDimEntryNo(DimEntryNo,InsCoverageLedgEntryNo);
          IF (OldDimEntryNo <> DimEntryNo) OR NOT Found THEN BEGIN
            InsertNewEntry(NewInsCoverageLedgEntry,OldDimEntryNo);
            IF Found THEN
              InitNewEntry(NewInsCoverageLedgEntry);
          END;
          OldDimEntryNo := DimEntryNo;
        UNTIL NOT Found;
      END;
      DimBufMgt.DeleteAllDimEntryNo;
    END;

    PROCEDURE InitNewEntry@7(VAR NewInsCoverageLedgEntry@1000 : Record 5629);
    BEGIN
      LastEntryNo := LastEntryNo + 1;
      WITH InsCoverageLedgEntry2 DO BEGIN
        NewInsCoverageLedgEntry.INIT;
        NewInsCoverageLedgEntry."Entry No." := LastEntryNo;

        NewInsCoverageLedgEntry."Insurance No." := "Insurance No.";
        NewInsCoverageLedgEntry."FA No." := "FA No.";
        NewInsCoverageLedgEntry."Document Type" := "Document Type";
        NewInsCoverageLedgEntry."Index Entry" := "Index Entry";
        NewInsCoverageLedgEntry."Disposed FA" := "Disposed FA";

        NewInsCoverageLedgEntry."Posting Date" := GETRANGEMIN("Posting Date");
        NewInsCoverageLedgEntry.Description := EntrdInsCoverageLedgEntry.Description;
        NewInsCoverageLedgEntry."Source Code" := SourceCodeSetup."Compress Insurance Ledger";
        NewInsCoverageLedgEntry."User ID" := USERID;
        IF RetainNo(FIELDNO("Document No.")) THEN
          NewInsCoverageLedgEntry."Document No." := "Document No.";
        IF RetainNo(FIELDNO("Global Dimension 1 Code")) THEN
          NewInsCoverageLedgEntry."Global Dimension 1 Code" := "Global Dimension 1 Code";
        IF RetainNo(FIELDNO("Global Dimension 2 Code")) THEN
          NewInsCoverageLedgEntry."Global Dimension 2 Code" := "Global Dimension 2 Code";

        Window.UPDATE(1,NewInsCoverageLedgEntry."Insurance No.");
        Window.UPDATE(2,NewInsCoverageLedgEntry."Posting Date");
        DateComprReg."No. of New Records" := DateComprReg."No. of New Records" + 1;
        Window.UPDATE(3,DateComprReg."No. of New Records");
      END;
    END;

    LOCAL PROCEDURE InsertNewEntry@23(VAR NewInsCoverageLedgEntry@1000 : Record 5629;DimEntryNo@1001 : Integer);
    VAR
      TempDimBuf@1002 : TEMPORARY Record 360;
      TempDimSetEntry@1005 : TEMPORARY Record 480;
    BEGIN
      TempDimBuf.DELETEALL;
      DimBufMgt.GetDimensions(DimEntryNo,TempDimBuf);
      DimMgt.CopyDimBufToDimSetEntry(TempDimBuf,TempDimSetEntry);
      NewInsCoverageLedgEntry."Dimension Set ID" := DimMgt.GetDimensionSetID(TempDimSetEntry);
      NewInsCoverageLedgEntry.INSERT;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

