OBJECT Codeunit 2315 O365 Setup Mgmt
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ClientTypeManagement@1000 : Codeunit 4;
      IdentityManagement@1001 : Codeunit 9801;
      O365GettingStartedMgt@1002 : Codeunit 1309;

    PROCEDURE InvoicesExist@9() : Boolean;
    VAR
      SalesHeader@1001 : Record 36;
      SalesInvoiceHeader@1000 : Record 112;
    BEGIN
      IF SalesInvoiceHeader.FINDFIRST THEN
        EXIT(TRUE);

      SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Invoice);
      IF SalesHeader.FINDFIRST THEN
        EXIT(TRUE);
    END;

    PROCEDURE EstimatesExist@10() : Boolean;
    VAR
      SalesHeader@1001 : Record 36;
    BEGIN
      SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
      IF SalesHeader.FINDFIRST THEN
        EXIT(TRUE);
    END;

    PROCEDURE DocumentsExist@11() : Boolean;
    VAR
      SalesHeader@1001 : Record 36;
      SalesInvoiceHeader@1000 : Record 112;
    BEGIN
      IF SalesInvoiceHeader.FINDFIRST THEN
        EXIT(TRUE);

      SalesHeader.SETFILTER("Document Type",'%1|%2',SalesHeader."Document Type"::Invoice,SalesHeader."Document Type"::Quote);
      IF SalesHeader.FINDFIRST THEN
        EXIT(TRUE);
    END;

    PROCEDURE ShowCreateTestInvoice@14() : Boolean;
    BEGIN
      EXIT(DocumentsExist);
    END;

    PROCEDURE WizardShouldBeOpenedForInvoicing@23() : Boolean;
    VAR
      O365GettingStarted@1002 : Record 1309;
    BEGIN
      IF NOT GettingStartedSupportedForInvoicing THEN
        EXIT(FALSE);

      IF O365GettingStarted.GET(USERID,ClientTypeManagement.GetCurrentClientType) THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE GettingStartedSupportedForInvoicing@12() : Boolean;
    BEGIN
      IF NOT IdentityManagement.IsInvAppId THEN
        EXIT(FALSE);

      IF NOT (ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Web) THEN
        EXIT(FALSE);

      EXIT(O365GettingStartedMgt.UserHasPermissionsToRunGettingStarted);
    END;

    BEGIN
    END.
  }
}

